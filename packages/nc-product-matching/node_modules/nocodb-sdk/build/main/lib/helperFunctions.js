"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.integrationCategoryNeedDefault = exports.getTestDatabaseName = exports.getRenderAsTextFunForUiType = exports.getAvailableRollupForFormulaType = exports.getAvailableRollupForUiType = exports.getAvailableRollupForColumn = exports.stringifyRolesObj = exports.extractRolesObj = exports.isSelfReferencingTableColumn = exports.isSystemColumn = exports.getSystemColumns = exports.getSystemColumnsIds = exports.filterOutSystemColumns = void 0;
exports.populateUniqueFileName = populateUniqueFileName;
exports.roundUpToPrecision = roundUpToPrecision;
exports.parseProp = parseProp;
exports.stringifyProp = stringifyProp;
exports.parseHelper = parseHelper;
exports.stringifyHelper = stringifyHelper;
exports.toSafeInteger = toSafeInteger;
exports.isCrossBaseLink = isCrossBaseLink;
exports.lookupCanHaveRecursiveEvaluation = lookupCanHaveRecursiveEvaluation;
exports.formatBytes = formatBytes;
const UITypes_1 = __importStar(require("./UITypes"));
const globals_1 = require("./globals");
const enums_1 = require("./enums");
const Api_1 = require("./Api");
const formulaHelpers_1 = require("./formulaHelpers");
const is_1 = require("../lib/is");
// import {RelationTypes} from "./globals";
// const systemCols = ['created_at', 'updated_at']
const filterOutSystemColumns = (columns) => {
    return (columns && columns.filter((c) => !isSystemColumn(c))) || [];
};
exports.filterOutSystemColumns = filterOutSystemColumns;
const getSystemColumnsIds = (columns) => {
    return ((columns && columns.filter(isSystemColumn)) || []).map((c) => c.id);
};
exports.getSystemColumnsIds = getSystemColumnsIds;
const getSystemColumns = (columns) => columns.filter(isSystemColumn) || [];
exports.getSystemColumns = getSystemColumns;
const isSystemColumn = (col) => !!(col &&
    (col.uidt === UITypes_1.default.ForeignKey ||
        ((col.column_name === 'created_at' || col.column_name === 'updated_at') &&
            col.uidt === UITypes_1.default.DateTime) ||
        (col.pk && (col.ai || col.cdf)) ||
        (col.pk && col.meta && col.meta.ag) ||
        col.system));
exports.isSystemColumn = isSystemColumn;
const isSelfReferencingTableColumn = (col) => {
    var _a, _b, _c;
    return (col &&
        (col.uidt === UITypes_1.default.Links || col.uidt === UITypes_1.default.LinkToAnotherRecord) &&
        ((col === null || col === void 0 ? void 0 : col.fk_model_id) || ((_a = col === null || col === void 0 ? void 0 : col.colOptions) === null || _a === void 0 ? void 0 : _a.fk_model_id)) &&
        ((_b = col === null || col === void 0 ? void 0 : col.colOptions) === null || _b === void 0 ? void 0 : _b.fk_related_model_id) &&
        ((col === null || col === void 0 ? void 0 : col.fk_model_id) || ((_c = col === null || col === void 0 ? void 0 : col.colOptions) === null || _c === void 0 ? void 0 : _c.fk_model_id)) ===
            col.colOptions.fk_related_model_id);
};
exports.isSelfReferencingTableColumn = isSelfReferencingTableColumn;
const extractRolesObj = (roles) => {
    if (!roles)
        return null;
    if (typeof roles === 'object' && !Array.isArray(roles))
        return roles;
    if (typeof roles === 'string') {
        roles = roles.split(',');
    }
    if (roles.length === 0)
        return null;
    return roles.reduce((acc, role) => {
        acc[role] = true;
        return acc;
    }, {});
};
exports.extractRolesObj = extractRolesObj;
const stringifyRolesObj = (roles) => {
    if (!roles)
        return '';
    const rolesArr = Object.keys(roles).filter((r) => roles[r]);
    return rolesArr.join(',');
};
exports.stringifyRolesObj = stringifyRolesObj;
const getAvailableRollupForColumn = (column) => {
    var _a, _b;
    if ([UITypes_1.default.Formula].includes(column.uidt)) {
        return getAvailableRollupForFormulaType((_b = (_a = column.colOptions.parsed_tree) === null || _a === void 0 ? void 0 : _a.dataType) !== null && _b !== void 0 ? _b : formulaHelpers_1.FormulaDataTypes.UNKNOWN);
    }
    else {
        return getAvailableRollupForUiType(column.uidt);
    }
};
exports.getAvailableRollupForColumn = getAvailableRollupForColumn;
const getAvailableRollupForUiType = (type) => {
    if ([
        UITypes_1.default.Year,
        UITypes_1.default.Time,
        UITypes_1.default.Date,
        UITypes_1.default.DateTime,
        UITypes_1.default.CreatedTime,
        UITypes_1.default.LastModifiedTime,
    ].includes(type)) {
        return ['count', 'min', 'max', 'countDistinct'];
    }
    if ((0, UITypes_1.isNumericCol)(type)) {
        // Number, Currency, Percent, Duration, Rating, Decimal
        return [
            'sum',
            'count',
            'min',
            'max',
            'avg',
            'countDistinct',
            'sumDistinct',
            'avgDistinct',
        ];
    }
    if ([
        UITypes_1.default.SingleLineText,
        UITypes_1.default.LongText,
        UITypes_1.default.User,
        UITypes_1.default.Email,
        UITypes_1.default.PhoneNumber,
        UITypes_1.default.URL,
        UITypes_1.default.JSON,
    ].includes(type)) {
        return ['count', 'countDistinct'];
    }
    if ([UITypes_1.default.Checkbox].includes(type)) {
        return ['count', 'sum'];
    }
    if ([UITypes_1.default.Attachment].includes(type)) {
        return [];
    }
    if ([UITypes_1.default.SingleSelect, UITypes_1.default.MultiSelect].includes(type)) {
        return ['count', 'countDistinct'];
    }
    return [
        'sum',
        'count',
        'min',
        'max',
        'avg',
        'countDistinct',
        'sumDistinct',
        'avgDistinct',
    ];
};
exports.getAvailableRollupForUiType = getAvailableRollupForUiType;
const getAvailableRollupForFormulaType = (type) => {
    switch (type) {
        case formulaHelpers_1.FormulaDataTypes.DATE:
        case formulaHelpers_1.FormulaDataTypes.INTERVAL: {
            return ['count', 'min', 'max', 'countDistinct'];
        }
        case formulaHelpers_1.FormulaDataTypes.NUMERIC: {
            return [
                'sum',
                'count',
                'min',
                'max',
                'avg',
                'countDistinct',
                'sumDistinct',
                'avgDistinct',
            ];
        }
        case formulaHelpers_1.FormulaDataTypes.BOOLEAN: {
            return ['count', 'sum'];
        }
        case formulaHelpers_1.FormulaDataTypes.STRING: {
            return ['count', 'countDistinct'];
        }
        case formulaHelpers_1.FormulaDataTypes.UNKNOWN:
        default: {
            return ['count'];
        }
    }
};
exports.getAvailableRollupForFormulaType = getAvailableRollupForFormulaType;
const getRenderAsTextFunForUiType = (type) => {
    if ([
        UITypes_1.default.Year,
        UITypes_1.default.Time,
        UITypes_1.default.Date,
        UITypes_1.default.DateTime,
        UITypes_1.default.CreatedTime,
        UITypes_1.default.LastModifiedTime,
        UITypes_1.default.Currency,
        UITypes_1.default.Duration,
    ].includes(type)) {
        return ['count', 'countDistinct'];
    }
    return [
        'sum',
        'count',
        'avg',
        'min',
        'max',
        'countDistinct',
        'sumDistinct',
        'avgDistinct',
    ];
};
exports.getRenderAsTextFunForUiType = getRenderAsTextFunForUiType;
const getFileName = ({ name, count, ext }) => `${name}${count ? `(${count})` : ''}${ext ? `${ext}` : ''}`;
// add count before extension if duplicate name found
function populateUniqueFileName(fileName, attachments) {
    return fileName.replace(/^(.+?)(?:\((\d+)\))?(\.(?:tar|min)\.(?:\w{2,4})|\.\w+)$/, (fileName, name, count, ext) => {
        let genFileName = fileName;
        let c = count || 1;
        // iterate until a unique name
        while (attachments.some((fn) => fn === genFileName)) {
            genFileName = getFileName({
                name,
                ext,
                count: c++,
            });
        }
        return genFileName;
    });
}
function roundUpToPrecision(number, precision = 0) {
    precision =
        precision == null
            ? 0
            : precision >= 0
                ? Math.min(precision, 292)
                : Math.max(precision, -292);
    if (precision) {
        // Shift with exponential notation to avoid floating-point issues.
        // See [MDN](https://mdn.io/round#Examples) for more details.
        let pair = `${number}e`.split('e');
        const value = Math.round(Number(`${pair[0]}e${+pair[1] + precision}`));
        pair = `${value}e`.split('e');
        return (+`${pair[0]}e${+pair[1] - precision}`).toFixed(precision);
    }
    return Math.round(number).toFixed(precision);
}
const testDataBaseNames = {
    [enums_1.ClientType.MYSQL]: null,
    mysql: null,
    [enums_1.ClientType.PG]: 'postgres',
    oracledb: 'xe',
    [enums_1.ClientType.SQLITE]: 'a.sqlite',
};
const getTestDatabaseName = (db) => {
    var _a;
    if (db.client === enums_1.ClientType.PG || db.client === enums_1.ClientType.SNOWFLAKE)
        return (_a = db.connection) === null || _a === void 0 ? void 0 : _a.database;
    return testDataBaseNames[db.client];
};
exports.getTestDatabaseName = getTestDatabaseName;
const integrationCategoryNeedDefault = (category) => {
    return [Api_1.IntegrationsType.Ai].includes(category);
};
exports.integrationCategoryNeedDefault = integrationCategoryNeedDefault;
function parseProp(v) {
    var _a;
    if ((0, is_1.ncIsUndefined)(v) || (0, is_1.ncIsNull)(v))
        return {};
    try {
        return typeof v === 'string' ? (_a = JSON.parse(v)) !== null && _a !== void 0 ? _a : {} : v;
    }
    catch (_b) {
        return {};
    }
}
function stringifyProp(v) {
    var _a;
    if ((0, is_1.ncIsUndefined)(v) || (0, is_1.ncIsNull)(v))
        return '{}';
    try {
        return typeof v === 'string' ? v : (_a = JSON.stringify(v)) !== null && _a !== void 0 ? _a : '{}';
    }
    catch (_b) {
        return '{}';
    }
}
function parseHelper(v) {
    try {
        return typeof v === 'string' ? JSON.parse(v) : v;
    }
    catch (_a) {
        return v;
    }
}
function stringifyHelper(v) {
    try {
        return typeof v === 'string' ? v : JSON.stringify(v);
    }
    catch (_a) {
        return v;
    }
}
function toSafeInteger(value) {
    return Math.max(Number.MIN_SAFE_INTEGER, Math.min(value, Number.MAX_SAFE_INTEGER));
}
function isCrossBaseLink(col) {
    var _a, _b, _c;
    return (col &&
        (0, UITypes_1.isLinksOrLTAR)(col) &&
        ((_a = col.colOptions) === null || _a === void 0 ? void 0 : _a.fk_related_base_id) &&
        ((_b = col.colOptions) === null || _b === void 0 ? void 0 : _b.fk_related_base_id) !==
            ((_c = col.colOptions) === null || _c === void 0 ? void 0 : _c.base_id));
}
function lookupCanHaveRecursiveEvaluation(param) {
    const { isEeUI, dbClientType, relationType, relationCol } = param;
    return (isEeUI &&
        dbClientType === enums_1.ClientType.PG &&
        isSelfReferencingTableColumn(relationCol) &&
        [globals_1.RelationTypes.HAS_MANY, globals_1.RelationTypes.BELONGS_TO].includes(relationType));
}
function formatBytes(bytes, decimals = 2, base = 1000) {
    if (bytes === 0)
        return '0 Bytes';
    const k = base;
    const dm = Math.max(0, decimals);
    const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return `${(bytes / k ** i).toFixed(dm)} ${sizes[i]}`;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVscGVyRnVuY3Rpb25zLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2xpYi9oZWxwZXJGdW5jdGlvbnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBNFBFLHdEQUFzQjtBQUN0QixnREFBa0I7QUF3QnBCLDhCQU9DO0FBRUQsc0NBT0M7QUFFRCxrQ0FNQztBQUVELDBDQU1DO0FBRUQsc0NBS0M7QUFFRCwwQ0FRQztBQUVELDRFQWFDO0FBRUQsa0NBU0M7QUFoV0QscURBQWlFO0FBQ2pFLHVDQUErRDtBQUMvRCxtQ0FBcUM7QUFDckMsK0JBS2U7QUFDZixxREFBb0Q7QUFDcEQsaUNBQW1EO0FBRW5ELDJDQUEyQztBQUUzQyxrREFBa0Q7QUFDbEQsTUFBTSxzQkFBc0IsR0FBRyxDQUFDLE9BQU8sRUFBRSxFQUFFO0lBQ3pDLE9BQU8sQ0FBQyxPQUFPLElBQUksT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztBQUN0RSxDQUFDLENBQUM7QUFnT0Esd0RBQXNCO0FBL054QixNQUFNLG1CQUFtQixHQUFHLENBQUMsT0FBTyxFQUFFLEVBQUU7SUFDdEMsT0FBTyxDQUFDLENBQUMsT0FBTyxJQUFJLE9BQU8sQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUM5RSxDQUFDLENBQUM7QUE4TkEsa0RBQW1CO0FBNU5yQixNQUFNLGdCQUFnQixHQUFHLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztBQTZOekUsNENB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