const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BGi5yrxT.js","./DRA9KN5F.js","./entry.CNP42Mi6.css","./DRQcH1pm.js","./ghxJ1J6L.js","./0J_Jm9qQ.js","./-iDxnmJF.js","./BYKJ-MHf.js","./lL-0_K96.js","./phJnKPvr.js","./CkpISeXq.js","./QuickImport.WzY-_B2v.css","./C_uh0dMc.js","./mXY_vhPu.js","./QeWwuUYP.js","./index._6B72PDH.css","./Ce4xoeky.js","./DP83Cqnl.js","./CNwEZGnv.js","./DlXIlcns.js","./BVqTF1QK.js","./C_gbauhL.js","./BCBMEREK.js","./C2UaKEE0.js","./Item.GTPiKSkc.css","./C_VN1MCC.js","./index.CMurbi1o.css","./gByPF8bR.js","./Modal.CB1oWLel.css","./Dv0nYk-Y.js","./C6valJX6.js","./PageHeader.EISusUbk.css","./LhVKWcKT.js","./BhKW-HeQ.js","./ytmFgNfN.js","./Pagination.Cmvjwryu.css","./Table.Cfa4WPno.css","./HY0lXmUV.js","./B8gs0dG7.js","./C5HnjaiI.js","./CBhmoxRW.js","./DkDj6Z7Z.js","./C9dUxAef.js","./CtCRqrd3.js","./boyBAVNN.js","./Editor.C6FZ3q1a.css","./BMufqs0w.js","./Overlay.CpKx7Pnx.css","./CN7ac-4_.js","./G4Pt-Lbf.js","./BSgyuQBI.js","./D8vl_16c.js","./BMPzbwPk.js","./EditOrAdd.DzsdAUcq.css","./CHRPOXXy.js","./D7OHpRdS.js","./DvtLu3FC.js","./CwPFbl3n.js","./YbUkeyWR.js","./By5RWL3d.js","./InviteDlg.RvOFRUtI.css","./kEFUUbpd.js","./EditBase.DHFa1tcy.css","./WDYzPv8C.js","./Caszp1mx.js","./KAvfy7MV.js","./View.ChgPETCw.css","./CHPx98pw.js","./CJAyvGKH.js","./DcZDB0M_.js","./ag2dqf-6.js","./C_-gdvC5.js"])))=>i.map(i=>d[i]);
import{b as ms,_ as xn,a as Bs}from"./ghxJ1J6L.js";import{e as re,c3 as Kt,dB as Ot,dZ as vs,b as s,c2 as Le,eB as wn,eC as kn,ck as me,cp as As,eD as $n,c9 as Sn,eE as Cn,c5 as Ee,bf as Ms,c8 as In,c4 as Us,e4 as Dn,cr as Tn,eF as Mn,ea as On,c7 as Pn,n as X,dC as Nn,ee as jn,c6 as En,c as P,o as a,ag as ue,a as t,I as E,ao as is,K as A,d as G,t as m,_ as ke,f as Ae,a9 as ct,aR as Rs,a8 as ve,al as xt,J as wt,V as Qe,a7 as et,aa as qt,r as V,ai as Ye,bz as Bn,w as n,M as $e,L as e,N as Ke,X as _t,a0 as mt,aX as at,Q as ie,bD as fs,ad as Je,af as Gt,an as _e,b9 as gt,bo as jt,a3 as Et,bU as Ls,a4 as pe,a_ as ot,av as ut,T as Ge,eG as Yt,bm as Bt,eH as Pt,$ as it,ax as bt,as as rt,ac as Ht,aq as Be,ap as Ze,bt as An,eI as Un,ah as nt,es as bs,eJ as ys,eK as Os,b3 as Qt,ca as Rn,u as Jt,eL as Ln,G as At,eM as Fs,eh as zs,aP as Xe,g as We,eN as Tt,a5 as Fe,aG as Oe,Y as Fn,i as zn,k as Vn,aT as Gn,cW as gs,aw as hs,ar as vt,bO as Wn,bV as Kn,aO as zt,ei as qn,eO as Yn,eP as Hn,eQ as Vs,eR as Qn,eS as Gs,U as xs,eT as ws,eU as Ps,a6 as Jn,ch as we,cT as pt,eV as Zn,bR as Xn,eW as ea,eX as ta,bM as ht,P as Ut,eY as Zt,eZ as Xt,a1 as qe,bB as Ws,bC as sa,O as He,cf as Ks,e_ as ks,aS as qs,aA as es,e$ as na,f0 as aa,f1 as lt,da as Ys,db as $s,aH as Ss,f2 as ds,f3 as oa,f4 as la,f5 as ia,f6 as Wt,f7 as Hs,dk as ca,f8 as us,f9 as ra,at as Qs,fa as Js,fb as Zs,fc as Xs,fd as en,aj as Ce,cS as da,fe as ua,ff as pa,bL as _a,ae as ma,bJ as va,el as ps,j as fa,aM as ba,fg as ya,fh as ga,aF as ha,aE as xa,fi as wa,fj as ka}from"./DRA9KN5F.js";import{_ as $a}from"./C_uh0dMc.js";import{_ as Cs}from"./QeWwuUYP.js";import{S as Sa}from"./Ce4xoeky.js";import{S as Ca}from"./CNwEZGnv.js";import{_ as kt}from"./C_gbauhL.js";import{C as tn,_ as sn}from"./-iDxnmJF.js";import{_ as Ia}from"./BCBMEREK.js";import{_ as ts}from"./C2UaKEE0.js";import{_ as ss}from"./C_VN1MCC.js";import{_ as Da}from"./gByPF8bR.js";import{_ as nn}from"./Dv0nYk-Y.js";import{_ as Ta}from"./C6valJX6.js";import{_ as an}from"./LhVKWcKT.js";import{_ as on}from"./BhKW-HeQ.js";import{u as ln}from"./HY0lXmUV.js";import{u as ns}from"./B8gs0dG7.js";import{u as Rt,_ as Is,a as cn,b as Ma}from"./C5HnjaiI.js";import{_ as Oa,a as Pa,v as Na,u as ja,d as Ea,b as Ba}from"./C9dUxAef.js";import{_ as Aa}from"./BMufqs0w.js";import{g as Ns,a as cs}from"./CN7ac-4_.js";import{_ as Ua}from"./CBhmoxRW.js";import rn from"./CHRPOXXy.js";import{D as Ra}from"./D7OHpRdS.js";import{u as La}from"./DkDj6Z7Z.js";import{u as Fa}from"./CwPFbl3n.js";import{_ as za}from"./CkpISeXq.js";import{_ as Va,R as Ga}from"./YbUkeyWR.js";import Wa from"./CtCRqrd3.js";import{u as Ka}from"./mXY_vhPu.js";import{u as qa}from"./By5RWL3d.js";var Ya=["class","style"],Ha=function(){return{prefixCls:String,href:String,separator:me.any,overlay:me.any,onClick:Function}};const Nt=re({compatConfig:{MODE:3},name:"ABreadcrumbItem",inheritAttrs:!1,__ANT_BREADCRUMB_ITEM:!0,props:Ha(),slots:["separator","overlay"],setup:function(o,b){var y=b.slots,r=b.attrs,k=Kt("breadcrumb",o),D=k.prefixCls,$=function(w,N){var u=Ot(y,o,"overlay");return u?s(kn,{overlay:u,placement:"bottom"},{default:function(){return[s("span",{class:"".concat(N,"-overlay-link")},[w,s(wn,null,null)])]}}):w};return function(){var f,w=(f=Ot(y,o,"separator"))!==null&&f!==void 0?f:"/",N=Ot(y,o),u=r.class,i=r.style,d=vs(r,Ya),p;return o.href!==void 0?p=s("a",Le({class:"".concat(D.value,"-link"),onClick:o.onClick},d),[N]):p=s("span",Le({class:"".concat(D.value,"-link"),onClick:o.onClick},d),[N]),p=$(p,D.value),N?s("span",{class:u,style:i},[p,w&&s("span",{class:"".concat(D.value,"-separator")},[w])]):null}}});var Qa=function(){return{prefixCls:String,routes:{type:Array},params:me.any,separator:me.any,itemRender:{type:Function}}};function Ja(I,o){if(!I.breadcrumbName)return null;var b=Object.keys(o).join("|"),y=I.breadcrumbName.replace(new RegExp(":(".concat(b,")"),"g"),function(r,k){return o[k]||r});return y}function js(I){var o=I.route,b=I.params,y=I.routes,r=I.paths,k=y.indexOf(o)===y.length-1,D=Ja(o,b);return k?s("span",null,[D]):s("a",{href:"#/".concat(r.join("/"))},[D])}const yt=re({compatConfig:{MODE:3},name:"ABreadcrumb",props:Qa(),slots:["separator","itemRender"],setup:function(o,b){var y=b.slots,r=Kt("breadcrumb",o),k=r.prefixCls,D=r.direction,$=function(u,i){return u=(u||"").replace(/^\//,""),Object.keys(i).forEach(function(d){u=u.replace(":".concat(d),i[d])}),u},f=function(u,i,d){var p=In(u),l=$(i||"",d);return l&&p.push(l),p},w=function(u){var i=u.routes,d=i===void 0?[]:i,p=u.params,l=p===void 0?{}:p,M=u.separator,g=u.itemRender,v=g===void 0?js:g,B=[];return d.map(function(L){var h=$(L.path,l);h&&B.push(h);var j=[].concat(B),T=null;return L.children&&L.children.length&&(T=s(Ms,null,{default:function(){return[L.children.map(function(Y){return s(Ms.Item,{key:Y.path||Y.breadcrumbName},{default:function(){return[v({route:Y,params:l,routes:d,paths:f(j,Y.path,l)})]}})})]}})),s(Nt,{overlay:T,separator:M,key:h||L.breadcrumbName},{default:function(){return[v({route:L,params:l,routes:d,paths:j})]}})})};return function(){var N,u,i,d=o.routes,p=o.params,l=p===void 0?{}:p,M=As(Ot(y,o)),g=(N=Ot(y,o,"separator"))!==null&&N!==void 0?N:"/",v=o.itemRender||y.itemRender||js;d&&d.length>0?i=w({routes:d,params:l,separator:g,itemRender:v}):M.length&&(i=M.map(function(L,h){return $n(Sn(L.type)==="object"&&(L.type.__ANT_BREADCRUMB_ITEM||L.type.__ANT_BREADCRUMB_SEPARATOR),"Breadcrumb","Only accepts Breadcrumb.Item and Breadcrumb.Separator as it's children"),Cn(L,{separator:g,key:h})}));var B=(u={},Ee(u,k.value,!0),Ee(u,"".concat(k.value,"-rtl"),D.value==="rtl"),u);return s("div",{class:B},[i])}}});var Za=["separator","class"],Xa=function(){return{prefixCls:String}};const _s=re({compatConfig:{MODE:3},name:"ABreadcrumbSeparator",__ANT_BREADCRUMB_SEPARATOR:!0,inheritAttrs:!1,props:Xa(),setup:function(o,b){var y=b.slots,r=b.attrs,k=Kt("breadcrumb",o),D=k.prefixCls;return function(){var $;r.separator;var f=r.class,w=vs(r,Za),N=As(($=y.default)===null||$===void 0?void 0:$.call(y));return s("span",Le({class:["".concat(D.value,"-separator"),f]},w),[N.length>0?N:"/"])}}});yt.Item=Nt;yt.Separator=_s;yt.install=function(I){return I.component(yt.name,yt),I.component(Nt.name,Nt),I.component(_s.name,_s),I};var eo=["prefixCls"];const to=re({compatConfig:{MODE:3},name:"Steps",props:{type:me.string.def("default"),prefixCls:me.string.def("vc-steps"),iconPrefix:me.string.def("vc"),direction:me.string.def("horizontal"),labelPlacement:me.string.def("horizontal"),status:me.string.def("process"),size:me.string.def(""),progressDot:me.oneOfType([me.looseBool,me.func]).def(void 0),initial:me.number.def(0),current:me.number.def(0),icons:me.shape({finish:me.any,error:me.any}).loose,stepIcon:Function},slots:["stepIcon","progressDot"],emits:["change"],setup:function(o,b){var y=b.slots,r=b.emit,k=function($){var f=o.current;f!==$&&r("change",$)};return function(){var D,$,f=o.prefixCls,w=o.direction,N=o.type,u=o.labelPlacement,i=o.iconPrefix,d=o.status,p=o.size,l=o.current,M=o.progressDot,g=M===void 0?y.progressDot:M,v=o.initial,B=o.icons,L=o.stepIcon,h=L===void 0?y.stepIcon:L,j=N==="navigation",T=g?"vertical":u,S=Us(f,"".concat(f,"-").concat(w),(D={},Ee(D,"".concat(f,"-").concat(p),p),Ee(D,"".concat(f,"-label-").concat(T),w==="horizontal"),Ee(D,"".concat(f,"-dot"),!!g),Ee(D,"".concat(f,"-navigation"),j),D)),Y=Dn(($=y.default)===null||$===void 0?void 0:$.call(y));return s("div",{class:S},[Y.map(function(R,_){var K=R.props||{},te=K.prefixCls,C=te===void 0?f:te,oe=vs(K,eo),H=v+_,q=Le(Le({},oe),{},{stepNumber:H+1,stepIndex:H,key:H,prefixCls:C,iconPrefix:i,progressDot:g,icons:B,stepIcon:h,onStepClick:k});return d==="error"&&_===l-1&&(q.class="".concat(f,"-next-error")),oe.status||(H===l?q.status=d:H<l?q.status="finish":q.status="wait"),q.active=H===l,Tn(R,q)})])}}});function Es(I){return typeof I=="string"}function so(){}var dn=function(){return{prefixCls:String,wrapperStyle:{type:Object,default:void 0},itemWidth:String,active:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},status:String,iconPrefix:String,icon:me.any,adjustMarginRight:String,stepNumber:Number,stepIndex:Number,description:me.any,title:me.any,subTitle:me.any,progressDot:Mn(me.oneOfType([me.looseBool,me.func])),tailContent:me.any,icons:me.shape({finish:me.any,error:me.any}).loose,onClick:Function,onStepClick:Function,stepIcon:Function}};const no=re({compatConfig:{MODE:3},name:"Step",props:dn(),slots:["title","subTitle","description","tailContent","stepIcon","progressDot"],emits:["click","stepClick"],setup:function(o,b){var y=b.slots,r=b.emit,k=function(f){r("click",f),r("stepClick",o.stepIndex)},D=function(f){var w,N=f.icon,u=f.title,i=f.description,d=o.prefixCls,p=o.stepNumber,l=o.status,M=o.iconPrefix,g=o.icons,v=o.progressDot,B=v===void 0?y.progressDot:v,L=o.stepIcon,h=L===void 0?y.stepIcon:L,j,T=(w={},Ee(w,"".concat(d,"-icon"),!0),Ee(w,"".concat(M,"icon"),!0),Ee(w,"".concat(M,"icon-").concat(N),N&&Es(N)),Ee(w,"".concat(M,"icon-check"),!N&&l==="finish"&&g&&!g.finish),Ee(w,"".concat(M,"icon-close"),!N&&l==="error"&&g&&!g.error),w),S=s("span",{class:"".concat(d,"-icon-dot")},null);return B?typeof B=="function"?j=s("span",{class:"".concat(d,"-icon")},[B({iconDot:S,index:p-1,status:l,title:u,description:i,prefixCls:d})]):j=s("span",{class:"".concat(d,"-icon")},[S]):N&&!Es(N)?j=s("span",{class:"".concat(d,"-icon")},[N]):g&&g.finish&&l==="finish"?j=s("span",{class:"".concat(d,"-icon")},[g.finish]):g&&g.error&&l==="error"?j=s("span",{class:"".concat(d,"-icon")},[g.error]):N||l==="finish"||l==="error"?j=s("span",{class:T},null):j=s("span",{class:"".concat(d,"-icon")},[p]),h&&(j=h({index:p-1,status:l,title:u,description:i,node:j})),j};return function(){var $,f,w,N,u,i=o.prefixCls,d=o.itemWidth,p=o.active,l=o.status,M=l===void 0?"wait":l,g=o.tailContent,v=o.adjustMarginRight,B=o.disabled,L=o.title,h=L===void 0?($=y.title)===null||$===void 0?void 0:$.call(y):L,j=o.description,T=j===void 0?(f=y.description)===null||f===void 0?void 0:f.call(y):j,S=o.subTitle,Y=S===void 0?(w=y.subTitle)===null||w===void 0?void 0:w.call(y):S,R=o.icon,_=R===void 0?(N=y.icon)===null||N===void 0?void 0:N.call(y):R,K=o.onClick,te=o.onStepClick,C=(u={},Ee(u,"".concat(i,"-item"),!0),Ee(u,"".concat(i,"-item-").concat(M),!0),Ee(u,"".concat(i,"-item-custom"),_),Ee(u,"".concat(i,"-item-active"),p),Ee(u,"".concat(i,"-item-disabled"),B===!0),u),oe={class:C},H={};d&&(H.width=d),v&&(H.marginRight=v);var q={onClick:K||so};return te&&!B&&(q.role="button",q.tabindex=0,q.onClick=k),s("div",Le(Le({},oe),{},{style:H}),[s("div",Le(Le({},q),{},{class:"".concat(i,"-item-container")}),[s("div",{class:"".concat(i,"-item-tail")},[g]),s("div",{class:"".concat(i,"-item-icon")},[D({icon:_,title:h,description:T})]),s("div",{class:"".concat(i,"-item-content")},[s("div",{class:"".concat(i,"-item-title")},[h,Y&&s("div",{title:Y,class:"".concat(i,"-item-subtitle")},[Y])]),T&&s("div",{class:"".concat(i,"-item-description")},[T])])])])}}});var ao=function(){return{prefixCls:String,iconPrefix:String,current:Number,initial:Number,percent:Number,responsive:{type:Boolean,default:void 0},labelPlacement:String,status:String,size:String,direction:String,progressDot:{type:[Boolean,Function],default:void 0},type:String,onChange:Function,"onUpdate:current":Function}},rs=re({compatConfig:{MODE:3},name:"ASteps",inheritAttrs:!1,props:Pn(ao(),{current:0,responsive:!0,labelPlacement:"horizontal"}),slots:["progressDot"],setup:function(o,b){var y=b.attrs,r=b.slots,k=b.emit,D=Kt("steps",o),$=D.prefixCls,f=D.direction,w=D.configProvider,N=Fa(),u=X(function(){return o.responsive&&N.value.xs?"vertical":o.direction}),i=X(function(){return w.getPrefixCls("",o.iconPrefix)}),d=function(M){k("update:current",M),k("change",M)},p=function(M){var g=M.node,v=M.status;if(v==="process"&&o.percent!==void 0){var B=o.size==="small"?32:40,L=s("div",{class:"".concat($,"-progress-icon")},[s(za,{type:"circle",percent:o.percent,width:B,strokeWidth:4,format:function(){return null}},null),g]);return L}return g};return function(){var l,M=Us((l={},Ee(l,"".concat($.value,"-rtl"),f.value==="rtl"),Ee(l,"".concat($.value,"-with-progress"),o.percent!==void 0),l),y.class),g={finish:s(jn,{class:"".concat($,"-finish-icon")},null),error:s(Nn,{class:"".concat($,"-error-icon")},null)};return s(to,Le(Le({icons:g},En(o,["percent","responsive"])),{},{direction:u.value,prefixCls:$.value,iconPrefix:i.value,class:M,onChange:d}),Le(Le({},r),{},{stepIcon:p}))}}}),Vt=re(Le(Le({compatConfig:{MODE:3}},no),{},{name:"AStep",props:dn()}));const oo=On(rs,{Step:Vt,install:function(o){return o.component(rs.name,rs),o.component(Vt.name,Vt),o}}),lo={class:"icon-wrapper"},io={class:"flex flex-col gap-1"},co={class:"label"},ro={key:0,class:"subtext"},uo=re({__name:"Item",props:{disabled:{type:Boolean},label:{},subtext:{},isLoading:{type:Boolean}},setup(I){return(o,b)=>{const y=Sa,r=Ca;return a(),P("div",{role:"button",class:ue(["nc-base-view-all-table-btn",{disabled:o.disabled,"loading cursor-wait":o.isLoading,"cursor-pointer":!o.isLoading}])},[t("div",lo,[o.isLoading?(a(),E(y,{key:0,active:"",shape:"square",class:"!h-full !w-full !children:rounded-md !children:w-8 !children:h-8"})):is(o.$slots,"icon",{key:1},void 0,!0)]),t("div",io,[t("div",co,[o.isLoading?(a(),E(r,{key:0,active:"",title:!1,paragraph:{rows:1}})):is(o.$slots,"label",{key:1},()=>[G(m(o.label),1)],!0)]),o.$slots.subtext||o.subtext||o.isLoading?(a(),P("div",ro,[o.isLoading?(a(),E(r,{key:0,active:"",title:"",paragraph:!1})):is(o.$slots,"subtext",{key:1},()=>[G(m(o.subtext),1)],!0)])):A("",!0)])],2)}}}),po=Object.assign(ke(uo,[["__scopeId","data-v-d18e7680"]]),{__name:"ProjectActionItem"}),_o={};function mo(I,o){const b=kt;return a(),E(b)}const vo=Object.assign(ke(_o,[["render",mo]]),{__name:"ProjectActionCreateEmptyScript"}),fo={};function bo(I,o){const b=kt;return a(),E(b)}const yo=Object.assign(ke(fo,[["render",bo]]),{__name:"ProjectActionScriptsByNocoDB"}),go={};function ho(I,o){const b=kt;return a(),E(b)}const xo=Object.assign(ke(go,[["render",ho]]),{__name:"ProjectActionCreateEmptyDashboard"}),wo=at(()=>ot(()=>import("./BGi5yrxT.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(I=>I.default||I)),ko={class:"text-base font-weight-bold flex items-center gap-4 mb-6"},$o={key:0},So={key:1},Co={key:2},Io={key:3,href:"https://docs.nocodb.com/bases/import-base-from-nocodb#get-nocodb-credentials",class:"!text-gray-500 prose-sm ml-auto",target:"_blank",rel:"noopener"},Do={key:0},To={class:"mb-2"},Mo={class:"mt-2"},Oo={key:1},Po={class:"flex items-start gap-2"},No={class:"flex flex-row items-center gap-2 mb-2"},jo={class:"text-gray-500 text-[13px] leading-5 ml-6"},Eo={key:2,class:"flex items-start gap-3"},Bo={key:0,class:"text-right mt-4"},Ao={key:0,class:"flex justify-between mt-2"},Uo=re({__name:"NocoDbImport",props:{modelValue:{type:Boolean},baseId:{},transition:{},showBackBtn:{type:Boolean}},emits:["update:modelValue","back"],setup(I,{emit:o}){const b=o,{$api:y}=Ae(),{t:r}=ct(),{copy:k}=Rs(),{activeWorkspace:D}=ve(xt()),{appInfo:$}=wt(),{ncSiteUrl:f}=$.value,{$poller:w}=Ae(),N=Qe(),u=et(),{refreshCommandPalette:i}=qt(),d=V(!1),p=V(1),l=V(),M=V(),g=V(!1),v=V(null),B=V(!1),L=V(!1),h=V(0),j=X(()=>h.value>=2),T=V({baseId:I.baseId,workspaceMode:!1,newBase:!1,secretToken:null}),S=X(()=>T.value.secretToken?`${f}/?secret=${T.value.secretToken}`:""),Y=x=>{var O;(O=l.value)==null||O.pushProgress(x.message,"progress"),M.value={msg:x.message,status:"progress"}},R=async(x,O)=>{var ne,se,U,c;M.value={msg:O==null?void 0:O.message,status:x},x===Ye.COMPLETED?(d.value=!0,T.value.workspaceMode||T.value.newBase?await u.loadProjects():await N.loadProject(),(ne=l.value)==null||ne.pushProgress("Done!",x),i()):x===Ye.FAILED&&(T.value.workspaceMode||T.value.newBase?await u.loadProjects():await N.loadProject(),B.value=!0,(U=l.value)==null||U.pushProgress((se=O==null?void 0:O.error)==null?void 0:se.message,x),M.value={msg:(c=O==null?void 0:O.error)==null?void 0:c.message,status:x},i())},_=X({get:()=>I.modelValue,set:x=>b("update:modelValue",x)});async function K(){var x;if((x=D.value)!=null&&x.id){g.value=!0;try{const O=await y.internal.postOperation(D.value.id,I.baseId,{operation:"listenRemoteImport"},T.value);T.value.secretToken=O.secret,v.value=O.id,w.subscribe({id:v.value},ne=>{ne.status!=="close"?ne.status?R(ne.status,ne.data):(p.value=2,Y(ne.data)):L.value=!1}),await k(S.value),pe.info(r("msg.info.copiedToClipboard"))}catch(O){console.error(O),pe.error("Failed to start listening"),g.value=!1}}}async function te(){var x;(x=D.value)!=null&&x.id&&(T.value.secretToken&&await y.internal.postOperation(D.value.id,I.baseId,{operation:"abortRemoteImport"},{secret:T.value.secretToken}),v.value&&w.unsubscribe({id:v.value}),g.value=!1,L.value=!1,_.value=!1,b("back"))}async function C(){p.value=1,M.value=null,T.value.secretToken=null,g.value=!1}const oe=X(()=>{var x;return!M.value||![Ye.COMPLETED,Ye.FAILED].includes((x=M.value)==null?void 0:x.status)}),H=V(!1),q=V("");return Bn(()=>{v.value&&w.unsubscribe({id:v.value})}),(x,O)=>{const ne=$e,se=Ke,U=wo,c=mt,F=fs,J=sn,le=tn,xe=_t,Ie=ms,ze=Ia,Se=Ls;return a(),E(Se,{visible:e(_),"onUpdate:visible":O[8]||(O[8]=Ue=>ie(_)?_.value=Ue:null),class:ue(["!top-[25vh]",{active:e(_)}]),closable:!1,"transition-name":x.transition,keyboard:e(p)!==2,"mask-closable":e(p)!==2,width:"448px","wrap-class-name":"nc-modal-nocodb-import",hide:"",onKeydown:O[9]||(O[9]=Et(Ue=>_.value=!1,["esc"]))},{footer:n(()=>[e(p)===1?(a(),P("div",Ao,[e(g)?(a(),E(se,{key:"abort",type:"danger",size:"small",onClick:te},{default:n(()=>[G(m(x.$t("general.abort")),1)]),_:1})):(a(),E(se,{key:"back",type:"text",size:"small",onClick:O[7]||(O[7]=()=>{_.value=!1,b("back")})},{default:n(()=>[x.showBackBtn?(a(),E(ne,{key:0,icon:"chevronLeft",class:"mr-1"})):A("",!0),G(" "+m(x.showBackBtn?x.$t("general.back"):x.$t("general.cancel")),1)]),_:1})),e(g)?(a(),E(se,{key:2,type:"ghost",class:"nc-btn-nocodb-import",size:"small",loading:e(g),onClick:K},{default:n(()=>O[16]||(O[16]=[G(" Listening ")])),_:1,__:[16]},8,["loading"])):(a(),E(se,{key:3,type:"primary",class:"nc-btn-nocodb-import",size:"small",onClick:K},{default:n(()=>O[17]||(O[17]=[G(" Generate & Copy URL ")])),_:1,__:[17]}))])):A("",!0)]),default:n(()=>{var Ue,Pe,Re;return[t("div",ko,[s(ne,{icon:"nocodb1",class:"w-6 h-6",onDblclick:O[0]||(O[0]=ge=>h.value++)}),e(p)===1?(a(),P("span",$o,m(x.$t("title.quickImportNocoDB")),1)):e(oe)?(a(),P("span",So,m(`${x.$t("labels.importingFromNocoDB")}...`),1)):(a(),P("span",Co,m(x.$t("labels.nocoDBBaseImported")),1)),e(p)===1?(a(),P("a",Io," Docs ")):e(p)===2?(a(),E(se,{key:4,type:"text",size:"xs",class:"ml-auto",onClick:O[1]||(O[1]=ge=>H.value=!e(H))},{default:n(()=>[G(m(e(H)?"Hide":"Show")+" Details ",1),s(ne,{icon:"chevronDown",class:ue(["ml-2 transition-all transform",{"rotate-180":e(H)}])},null,8,["class"])]),_:1})):A("",!0)]),e(p)===1?(a(),P("div",Do,[O[12]||(O[12]=t("div",{class:"text-gray-600 text-sm px-2"},[t("p",{class:"mb-2"},"Easily migrate your base with the following steps:"),t("ol",{class:"list-decimal list-inside mt-2 pl-1"},[t("li",null,[G("Open "),t("strong",null,"settings"),G(" in your NocoDB base")]),t("li",null,[G("Navigate to "),t("strong",null,"Migrate"),G(" tab")]),t("li",null,[G("Paste the "),t("strong",null,"URL")]),t("li",null,[G("Click "),t("strong",null,"Migrate")])])],-1)),s(xe,{ref:"form",model:e(T),name:"quick-import-nocodb-form",layout:"horizontal",class:"!m-0 w-full"},{default:n(()=>[e(g)?(a(),E(c,{key:0,class:"!mt-0 !pb-2 !mb-0"},{default:n(()=>[s(U,{"model-value":e(S),class:"!rounded-lg !mt-2 nc-input-shared-base"},null,8,["model-value"])]),_:1})):A("",!0),e(j)&&!e(g)?(a(),E(se,{key:1,class:"!mt-2",type:"text",size:"small",onClick:O[2]||(O[2]=ge=>q.value=e(q)?"":"advanced-settings")},{default:n(()=>[G(m(x.$t("title.advancedSettings"))+" ",1),s(ne,{icon:"chevronDown",class:ue(["ml-2 !transition-all !transform",{"!rotate-180":e(q)==="advanced-settings"}])},null,8,["class"])]),_:1})):A("",!0),e(g)?A("",!0):(a(),E(le,{key:2,"active-key":e(q),"onUpdate:activeKey":O[5]||(O[5]=ge=>ie(q)?q.value=ge:null),ghost:"",class:"nc-import-collapse"},{default:n(()=>[s(J,{key:"advanced-settings"},{default:n(()=>[t("div",To,[s(F,{checked:e(T).newBase,"onUpdate:checked":O[3]||(O[3]=ge=>e(T).newBase=ge)},{default:n(()=>O[10]||(O[10]=[G(" New Base ")])),_:1,__:[10]},8,["checked"])]),t("div",Mo,[s(F,{checked:e(T).workspaceMode,"onUpdate:checked":O[4]||(O[4]=ge=>e(T).workspaceMode=ge)},{default:n(()=>O[11]||(O[11]=[G(" Workspace Mode ")])),_:1,__:[11]},8,["checked"])])]),_:1})]),_:1},8,["active-key"]))]),_:1},8,["model"])])):A("",!0),e(p)===2?(a(),P("div",Oo,[Je(s(Ie,{ref_key:"progressRef",ref:l,class:"w-full h-[200px]"},null,512),[[Gt,e(H)]]),Je(t("div",Po,[e(oe)?(a(),P(_e,{key:0},[(a(),E(gt(("iconMap"in x?x.iconMap:e(jt)).loading),{class:"text-primary animate-spin mt-1"})),t("span",null,m(((Ue=e(M))==null?void 0:Ue.msg)??"---"),1)],64)):((Pe=e(M))==null?void 0:Pe.status)===e(Ye).FAILED?(a(),E(ze,{key:1,class:"!rounded-lg !bg-transparent !border-gray-200 !p-3 !w-full"},{message:n(()=>[t("div",No,[s(ne,{icon:"ncAlertCircleFilled",class:"text-red-500 w-4 h-4"}),O[13]||(O[13]=t("span",{class:"font-weight-700 text-[14px]"},"Import error",-1))])]),description:n(()=>{var ge;return[t("div",jo,m(((ge=e(M))==null?void 0:ge.msg)??"---"),1)]}),default:n(()=>[O[14]||(O[14]=G(" > "))]),_:1,__:[14]})):(a(),P("div",Eo,[s(ne,{icon:"checkFill",class:"text-white w-4 h-4 mt-0.75"}),t("span",null,m(x.$t("msg.nocoDBImportSuccess")),1)]))],512),[[Gt,!e(H)]]),e(oe)?A("",!0):(a(),P("div",Bo,[((Re=e(M))==null?void 0:Re.status)===e(Ye).FAILED?(a(),E(se,{key:0,size:"small",onClick:C},{default:n(()=>O[15]||(O[15]=[G(" Retry import ")])),_:1,__:[15]})):(a(),E(se,{key:1,size:"small",onClick:O[6]||(O[6]=ge=>_.value=!1)},{default:n(()=>[G(m(e(T).workspaceMode||e(T).newBase?"Go To Dashboard":"Go To Base"),1)]),_:1}))]))])):A("",!0)]}),_:1},8,["visible","class","transition-name","keyboard","mask-closable"])}}}),Ro=Object.assign(ke(Uo,[["__scopeId","data-v-1c311989"]]),{__name:"DlgNocoDbImport"}),Lo={class:"flex flex-col px-6 pt-6 pb-9"},Fo={class:"flex items-center gap-3 mb-6"},zo={class:"text-base font-weight-700"},Vo={class:"ml-1 text-[13px] font-weight-700"},Go={class:"ml-1 text-[13px] font-weight-700"},Wo={class:"ml-1 text-[13px] font-weight-700"},Ko={class:"ml-1 text-[13px] font-weight-700"},qo={class:"ml-1 text-[13px] font-weight-700"},Yo=re({__name:"ImportModal",props:{visible:{type:Boolean},source:{}},emits:["update:visible"],setup(I,{emit:o}){const b=I,y=o,r=ut(b,"source"),k=Ge(b,"visible",y),{$e:D}=Ae(),{isFeatureEnabled:$}=Yt(),{showRecordPlanLimitExceededModal:f}=Bt();async function w(d,p){if(!d||!p)return;D("a:actions:import-airtable");const l=V(!0);await it(),k.value=!1;const{close:M}=bt(xn,{modelValue:l,baseId:d,sourceId:p,"onUpdate:modelValue":g,showBackBtn:!0,onBack:()=>{k.value=!0}});function g(){l.value=!1,M(1e3)}}async function N(d){if(!d)return;const p=V(!0);await it(),k.value=!1;const{close:l}=bt(Ro,{modelValue:p,baseId:d,"onUpdate:modelValue":M,showBackBtn:!0,onBack:()=>{k.value=!0}});function M(){p.value=!1,l(1e3)}}async function u(d){if(!r.value.id||!r.value.base_id)return;D(`a:actions:import-${d}`);const p=V(!0);await it(),k.value=!1;const{close:l}=bt(Bs,{modelValue:p,importType:d,baseId:r.value.base_id,sourceId:r.value.id,"onUpdate:modelValue":M,showBackBtn:!0,onBack:()=>{k.value=!0}});function M(){p.value=!1,l(1e3)}}const i=d=>{f()||(d==="airtable"?w(r.value.base_id,r.value.id):d==="nocodb"?N(r.value.base_id):u(d))};return(d,p)=>{const l=$e,M=ts,g=ss,v=Da;return a(),E(v,{visible:e(k),"onUpdate:visible":p[5]||(p[5]=B=>ie(k)?k.value=B:null),width:"448px",class:"!top-[25vh]"},{default:n(()=>[t("div",Lo,[t("div",Fo,[t("div",zo,m(d.$t("labels.importDataFrom")),1)]),s(g,{class:"border-1 divide-y-1 nc-import-items-menu overflow-clip"},{default:n(()=>[s(M,{onClick:p[0]||(p[0]=B=>i("airtable"))},{default:n(()=>[s(l,{icon:"importAirtable",class:"w-5 h-5"}),t("span",Vo,m(d.$t("labels.airtable")),1),s(l,{icon:"chevronRight",class:"ml-auto text-lg"})]),_:1}),s(M,{onClick:p[1]||(p[1]=B=>i("csv"))},{default:n(()=>[s(l,{icon:"importCsv",class:"w-5 h-5"}),t("span",Go,m(d.$t("labels.csv")),1),s(l,{icon:"chevronRight",class:"ml-auto text-lg"})]),_:1}),s(M,{onClick:p[2]||(p[2]=B=>i("json"))},{default:n(()=>[s(l,{icon:"importJson",class:"w-5 h-5"}),t("span",Wo,m(d.$t("labels.jsonCapitalized")),1),s(l,{icon:"chevronRight",class:"ml-auto text-lg"})]),_:1}),s(M,{onClick:p[3]||(p[3]=B=>i("excel"))},{default:n(()=>[s(l,{icon:"importExcel",class:"w-5 h-5"}),t("span",Ko,m(d.$t("labels.excel")),1),s(l,{icon:"chevronRight",class:"ml-auto text-lg"})]),_:1}),e($)(("FEATURE_FLAG"in d?d.FEATURE_FLAG:e(Pt)).IMPORT_FROM_NOCODB)?(a(),E(M,{key:0,onClick:p[4]||(p[4]=B=>i("nocodb"))},{default:n(()=>[s(l,{icon:"nocodb1",class:"w-5 h-5"}),t("span",qo,m(d.$t("objects.syncData.nocodb")),1),s(l,{icon:"chevronRight",class:"ml-auto text-lg"})]),_:1})):A("",!0)]),_:1})])]),_:1},8,["visible"])}}}),Ho=Object.assign(ke(Yo,[["__scopeId","data-v-84abb2af"]]),{__name:"ProjectImportModal"}),Qo=at(()=>ot(()=>Promise.resolve().then(()=>di),void 0,import.meta.url).then(I=>I.default||I)),Jo=at(()=>ot(()=>Promise.resolve().then(()=>Br),void 0,import.meta.url).then(I=>I.default||I)),Zo={class:"nc-all-tables-view p-6 nc-scrollbar-thin",style:{height:"calc(100vh - var(--topbar-height) - 44px)"}},Xo={class:"text-subHeading2 text-nc-content-gray mb-5"},el=re({__name:"Overview",setup(I){const{openedProject:o,isDataSourceLimitReached:b}=ve(et()),y=Qe(),{base:r}=ve(y),{isFeatureEnabled:k}=Yt(),D=V(!1),$=V(!1),{isUIAllowed:f}=rt(),{$e:w}=Ae(),{showExternalSourcePlanLimitExceededModal:N}=Bt(),u=V(!1),i=X(()=>{var M,g;return(g=(M=o.value)==null?void 0:M.sources)==null?void 0:g[0]});function d(M){var h,j;w("c:table:create:navdraw");const g=V(!0);let v=(h=o.value.sources)==null?void 0:h[0].id;if(!v||!((j=o.value)!=null&&j.id))return;const{close:B}=bt(An,{modelValue:g,sourceId:v,baseId:o.value.id,onCreate:L,"onUpdate:modelValue":()=>L()});function L(T){g.value=!1,T&&(setTimeout(()=>{const S=document.querySelector(`[data-table-id="${T.id}"]`);S&&(S==null||S.scrollIntoView({behavior:"smooth",block:"nearest"}))},1e3),B(1e3))}}const p=()=>{N()||b.value||(D.value=!0)},l=()=>{$.value=!0};return(M,g)=>{var K,te,C,oe,H,q,x,O,ne,se;const v=po,B=$e,L=Ze,h=vo,j=yo,T=xo,S=Ho,Y=Qo,R=Jo,_=Ht("e");return a(),P("div",Zo,[t("div",Xo,m(M.$t("labels.actions")),1),t("div",{class:ue(["flex flex-row gap-6 flex-wrap max-w-[1000px]",{"pointer-events-none":(K=e(r))==null?void 0:K.isLoading}])},[(te=e(r))!=null&&te.isLoading?(a(),P(_e,{key:0},Be(7,U=>s(v,{key:U,"is-loading":"",label:"loading"})),64)):(a(),P(_e,{key:1},[e(f)("tableCreate",{source:(oe=(C=e(r))==null?void 0:C.sources)==null?void 0:oe[0]})?(a(),E(v,{key:0,label:M.$t("dashboards.create_new_table"),subtext:M.$t("msg.subText.startFromScratch"),"data-testid":"proj-view-btn__add-new-table",onClick:g[0]||(g[0]=U=>d())},{icon:n(()=>[s(B,{icon:"addOutlineBox",class:"!h-8 !w-8 !text-nc-content-brand"})]),_:1},8,["label","subtext"])):A("",!0),e(f)("tableCreate",{source:(q=(H=e(r))==null?void 0:H.sources)==null?void 0:q[0]})?Je((a(),E(v,{key:1,"data-testid":"proj-view-btn__import-data",label:`${M.$t("activity.import")} ${M.$t("general.data")}`,subtext:M.$t("msg.subText.importData"),onClick:g[1]||(g[1]=U=>u.value=!0)},{icon:n(()=>[s(B,{icon:"download",class:"!h-7.5 !w-7.5 !text-nc-content-orange-dark"})]),_:1},8,["label","subtext"])),[[_,["c:table:import"]]]):A("",!0),e(f)("sourceCreate")?(a(),E(L,{key:2,placement:"bottom",disabled:!e(b),class:"flex-none flex"},{title:n(()=>[G(m(M.$t("tooltip.reachedSourceLimit")),1)]),default:n(()=>[Je((a(),E(v,{"data-testid":"proj-view-btn__create-source",disabled:e(b),label:M.$t("labels.connectDataSource"),subtext:M.$t("msg.subText.connectExternalData"),onClick:p},{icon:n(()=>[s(B,{icon:"server1",class:"!h-7 !w-7 !text-nc-content-green-dark"})]),_:1},8,["disabled","label","subtext"])),[[_,["c:table:create-source"]]])]),_:1},8,["disabled"])):A("",!0),e(k)(("FEATURE_FLAG"in M?M.FEATURE_FLAG:e(Pt)).SYNC)&&e(f)("tableCreate",{source:(O=(x=e(r))==null?void 0:x.sources)==null?void 0:O[0]})?Je((a(),E(v,{key:3,"data-testid":"proj-view-btn__create-sync",label:M.$t("labels.syncData"),subtext:M.$t("msg.subText.syncData"),onClick:l},{icon:n(()=>[s(B,{icon:"ncZap",class:"!h-7 !w-7 !text-nc-content-green-dark"})]),_:1},8,["label","subtext"])),[[_,["c:table:create-sync"]]]):A("",!0),s(h),s(j),s(T)],64))],2),e(i)?(a(),E(S,{key:0,visible:e(u),"onUpdate:visible":g[2]||(g[2]=U=>ie(u)?u.value=U:null),source:e(i)},null,8,["visible","source"])):A("",!0),e(D)?(a(),E(Y,{key:1,open:e(D),"onUpdate:open":g[3]||(g[3]=U=>ie(D)?D.value=U:null),"is-modal":""},null,8,["open"])):A("",!0),e($)&&((ne=e(r))!=null&&ne.id)?(a(),E(R,{key:2,open:e($),"onUpdate:open":g[4]||(g[4]=U=>ie($)?$.value=U:null),"base-id":(se=e(r))==null?void 0:se.id},null,8,["open","base-id"])):A("",!0)])}}}),tl=Object.assign(el,{__name:"ProjectOverview"}),sl={};function nl(I,o){const b=kt;return a(),E(b)}const al=Object.assign(ke(sl,[["render",nl]]),{__name:"ProjectPrivateOverlay"}),ol={class:"flex items-center justify-between"},ll={key:0,class:"text-gray-500 text-xs"},il={class:"flex items-center justify-between"},cl={key:0,class:"text-gray-500 text-xs"},rl=re({__name:"Selector",props:{role:{},roles:{},disabledRoles:{},onRoleChange:{},border:{type:Boolean,default:!0},description:{type:Boolean,default:!0},inherit:{},size:{default:"sm"},showInherit:{type:Boolean,default:!1}},setup(I){const o=I,b=ut(o,"role"),y=ut(o,"inherit"),r=ut(o,"showInherit"),k=ut(o,"description"),D=V(!1),$=V(null),f=ut(o,"size"),w=V(null);async function N(i){w.value=i,await o.onRoleChange(i),w.value=null,D.value=!1}Un($,i=>{var d;(d=i.target)!=null&&d.closest(".nc-role-selector-dropdown")||(D.value=!1)});const u=i=>{w.value||i!==b.value||(D.value=!1)};return(i,d)=>{const p=an,l=Ze,M=$e,g=ys,v=Qt,B=bs,L=Ht("e");return a(),P("div",{ref_key:"dropdownRef",ref:$,size:"lg",class:"nc-roles-selector relative flex items-center gap-3",onClick:d[0]||(d[0]=h=>D.value=!e(D))},[s(p,{border:!1,inherit:e(y)===i.role,role:e(b),size:e(f),clickable:"","data-testid":"roles",class:"flex-none"},null,8,["inherit","role","size"]),e(r)&&("isEeUI"in i?i.isEeUI:e(nt))&&e(y)===i.role?(a(),E(l,{key:0,class:"uppercase text-[10px] leading-4 text-gray-500",placement:"bottom"},{title:n(()=>[G(m(i.$t("tooltip.roleInheritedFromWorkspace")),1)]),default:n(()=>[G(" "+m(i.$t("objects.workspace")),1)]),_:1})):A("",!0),s(B,{value:e(b),open:e(D),"dropdown-match-select-width":!1,"dropdown-class-name":"!rounded-lg !h-fit max-w-[350px] nc-role-selector-dropdown",class:"py-1 !absolute top-0 left-0 w-20 h-full z-10 text-xs opacity-0",onChange:N},{default:n(()=>[(a(!0),P(_e,null,Be(o.disabledRoles||[],h=>(a(),E(g,{key:h,value:h,disabled:""},{default:n(()=>[t("div",{class:ue([{"w-full":e(k),"w-[200px]":!e(k)},"flex flex-col nc-role-select-dropdown gap-1"])},[t("div",ol,[s(p,{disabled:"",border:!1,inherit:e(y)===h,role:h},null,8,["inherit","role"]),!e(w)&&h===e(b)?(a(),E(M,{key:0,icon:"check",class:"text-primary"})):A("",!0)]),e(k)?(a(),P("div",ll,m(e(Os)[h]),1)):A("",!0)],2)]),_:2},1032,["value"]))),128)),(a(!0),P(_e,null,Be(o.roles,h=>Je((a(),E(g,{key:h,value:h,disabled:!!e(w),onClick:j=>u(h)},{default:n(()=>[t("div",{class:ue([{"w-full":e(k),"w-[200px]":!e(k)},"flex flex-col nc-role-select-dropdown gap-1"])},[t("div",il,[s(p,{border:!1,class:ue(`nc-role-select-${h}`),inherit:e(y)===h,role:h},null,8,["class","inherit","role"]),h===e(w)?(a(),E(v,{key:0,size:"medium"})):!e(w)&&h===e(b)?(a(),E(M,{key:1,icon:"check",class:"text-primary"})):A("",!0)]),e(k)?(a(),P("div",cl,m(e(Os)[h]),1)):A("",!0)],2)]),_:2},1032,["value","disabled","onClick"])),[[L,["c:workspace:settings:user-role-change"]]])),128))]),_:1},8,["value","open"])],512)}}}),dl=Object.assign(rl,{__name:"RolesSelector"}),ul=Rn("orgStore",()=>{const I=V(),o=V(null);return{org:I,orgId:o,updateOrg:async r=>{},loadOrg:async()=>{}}}),pl=at(()=>ot(()=>import("./DRQcH1pm.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60]),import.meta.url).then(I=>I.default||I)),_l={key:0},ml={class:"nc-breadcrumb px-2"},vl={class:"nc-breadcrumb-item"},fl={class:"nc-breadcrumb-item"},bl={class:"nc-breadcrumb-item active truncate capitalize"},yl={class:"nc-page-header-icon flex justify-center items-center h-5 w-5"},gl={"data-rec":"true",class:"capitalize"},hl={class:"nc-content-max-w h-full flex flex-col items-center gap-6 px-6 pt-6"},xl={key:1,class:"w-full flex justify-between items-center max-w-full gap-3"},wl={class:"flex items-center gap-1"},kl={key:1,class:"w-full flex gap-3 items-center users-email-grid"},$l={class:"flex flex-col flex-1 max-w-[calc(100%_-_44px)]"},Sl={class:"flex gap-3"},Cl={key:2},Il={key:3},Dl=re({__name:"AccessSettings",props:{baseId:{}},setup(I){const o=I,b=Jt(),{isPrivateBase:y,base:r}=ve(Qe()),k=et(),{getBaseUsers:D,createProjectUser:$,updateProjectUser:f,removeProjectUser:w}=k,{activeProjectId:N,bases:u,basesUser:i}=ve(k),{orgRoles:d,baseRoles:p,loadRoles:l,isUIAllowed:M}=rt(),{sorts:g,sortDirection:v,loadSorts:B,handleGetSortedData:L,saveOrUpdate:h}=ln("Project"),j=X(()=>{var Q;return(Q=d.value)==null?void 0:Q[Ln.SUPER_ADMIN]}),T=ul(),{orgId:S,org:Y}=ve(T),R=At(Fs,V(!1)),{$api:_,$eventBus:K}=Ae(),{t:te}=ct(),{projectPageTab:C}=ve(ns()),{isPaymentEnabled:oe,showUserPlanLimitExceededModal:H}=Bt(),q=zs(async()=>{let Q;return o.baseId?(await l(o.baseId),Q=u.value.get(o.baseId),Q||(Q=await _.base.read(o.baseId))):Q=u.value.get(N.value),Q}),x=V(!1),O=V([]),ne=V(0),se=V(""),U=V(!1),c=V([]),F=X(()=>O.value.filter(Q=>{var ae,de;return((de=(ae=Q.display_name)==null?void 0:ae.toLowerCase())==null?void 0:de.includes(se.value.toLowerCase()))||Q.email.toLowerCase().includes(se.value.toLowerCase())})),J=X(()=>L(F.value,g.value)),le=async()=>{try{if(!q.value)return;const{users:Q,totalRows:ae}=await D({baseId:q.value.id,...se.value?{searchText:se.value}:{},force:!0});ne.value=ae,O.value=[...Q.filter(de=>!(de!=null&&de.deleted)).map(de=>({...de,base_roles:de.roles,roles:de.roles??(de.workspace_roles?zt[de.workspace_roles]??Xe.NO_ACCESS:Xe.NO_ACCESS)}))]}catch(Q){pe.error(await Fe(Q))}},xe=X(()=>{var Q,ae;return((Q=p.value)==null?void 0:Q[Xe.OWNER])||((ae=p.value)==null?void 0:ae[Xe.CREATOR])}),Ie=async(Q,ae)=>{const de=O.value.find(be=>be.id===Q.id);try{!ae||ae===Xe.NO_ACCESS&&!nt?(await w(q.value.id,de),de.workspace_roles&&zt[de.workspace_roles]===ae&&nt||(de.roles=Xe.NO_ACCESS),de.base_roles=null):de.base_roles?(de.roles=ae,await f(q.value.id,de)):(de.roles=ae,de.base_roles=ae,await $(q.value.id,de));let be=i.value.get(q.value.id);be!=null&&be.length&&(be=be.map(W=>(W.id===de.id&&(W.roles=de.roles),W)),i.value.set(q.value.id,be))}catch(be){const W=await Vs(be);if(oe.value&&W.error===Qn.PLAN_LIMIT_EXCEEDED){const z=W.details;H({details:z,role:ae})}else pe.error(W.message)}finally{le()}},ze=X(()=>{var Q,ae;return((Q=r.value)==null?void 0:Q.default_role)&&!((ae=p.value)!=null&&ae[Xe.OWNER])});We(async()=>{if(!ze.value){U.value=!0;try{await le();const Q=Tt.findIndex(ae=>p.value&&Object.keys(p.value).includes(ae));j.value?c.value=Tt.slice(0):Q!==-1&&(c.value=Tt.slice(Q)),B()}catch(Q){pe.error(await Fe(Q))}finally{U.value=!1}}}),Oe(p,Q=>{const ae=Tt.findIndex(de=>Q&&Object.keys(Q).includes(de));c.value=Tt.slice(ae)});const Se=Fn({}),Ue=Q=>{F.value.forEach(ae=>{Se[ae.id]=Q})},Pe=X({get:()=>Object.values(Se).every(Q=>Q)&&Object.keys(Se).length>0&&Object.values(Se).length===F.value.length,set:Q=>{Ue(Q)}});Oe(x,()=>{x.value||le()}),Oe(q,()=>{le()});const Re=X({get:()=>v.value,set:Q=>{if(Object.keys(Q).length===0){h({});return}const[ae,de]=Object.entries(Q)[0];h({field:ae,direction:de})}}),ge=[{key:"select",title:"",width:70,minWidth:70},{key:"email",title:te("objects.users"),minWidth:220,dataIndex:"email",showOrderBy:!0},{key:"role",title:te("general.role"),basis:"30%",minWidth:272,dataIndex:"roles",showOrderBy:!0},{key:"created_at",title:te("title.dateJoined"),basis:"25%",minWidth:200}],Ve=Q=>({class:`${Se[Q.id]?"selected":""} user-row`}),ye=X(()=>{var Q;return((Q=O.value)==null?void 0:Q.filter(ae=>ae.roles===Xe.OWNER).length)===1}),ft=Q=>!(ye.value&&Q.roles===Xe.OWNER),tt=()=>{b.push({query:{...b.currentRoute.value.query,page:"base-settings",tab:"baseType"}})};Oe(C,()=>{se.value&&(se.value="")});const st=(Q,ae)=>{var be;const{baseId:de}=ae;de===((be=q.value)==null?void 0:be.id)&&le()};return We(()=>{B(),K.realtimeEventBus.on(st)}),zn(()=>{K.realtimeEventBus.off(st)}),(Q,ae)=>{var Lt,Ft;const de=al,be=$e,W=nn,z=Gn,ce=Ta,fe=Ke,Z=gs,Ne=vt,je=Hn,De=Wn,Te=Kn,St=Ze,Ct=dl,as=an,It=on,os=pl,ls=Vn("x");return a(),P("div",{class:ue(["nc-collaborator-table-container nc-access-settings-view flex flex-col relative",{"h-[calc(100vh_-_100px)]":!e(R)}])},[e(ze)?(a(),E(de,{key:0})):(a(),P(_e,{key:1},[e(R)?(a(),P("div",_l,[t("div",ml,[t("div",vl,m(e(Y).title),1),s(be,{icon:"ncSlash1",class:"nc-breadcrumb-divider"}),s(W,{href:`/admin/${e(S)}/bases`,class:"!hover:text-gray-800 !hover:underline-gray-600 flex items-center !text-gray-700 !underline-transparent max-w-1/4"},{default:n(()=>[t("div",fl,m(Q.$t("objects.projects")),1)]),_:1},8,["href"]),s(be,{icon:"ncSlash1",class:"nc-breadcrumb-divider"}),t("div",bl,m((Lt=e(q))==null?void 0:Lt.title),1)]),s(ce,null,{icon:n(()=>[t("div",yl,[s(z,{readonly:""})])]),title:n(()=>{var Me;return[t("span",gl,m((Me=e(q))==null?void 0:Me.title),1)]}),_:1})])):A("",!0),t("div",hl,[("isEeUI"in Q?Q.isEeUI:e(nt))&&e(y)?(a(),E(Z,{key:0,type:"info",message:Q.$t("title.privateBase"),class:"bg-nc-bg-gray-extralight"},hs({icon:n(()=>[s(be,{icon:"ncUser",class:"w-6 h-6 text-nc-content-gray-subtle"})]),description:n(()=>[G(m(Q.$t("title.privateBaseAlertDescription")),1)]),_:2},[e(M)("manageBaseType")?{name:"action",fn:n(()=>[s(fe,{type:"secondary",size:"small",class:"!mt-[-4px]","inner-class":"!gap-1.5","icon-position":"right",onClick:tt},{icon:n(()=>[s(be,{icon:"ncArrowUpRight",class:"w-4 h-4"})]),default:n(()=>[G(" "+m(Q.$t("activity.goToBaseSettings")),1)]),_:1})]),key:"0"}:void 0]),1032,["message"])):A("",!0),e(R)?A("",!0):(a(),P("div",xl,[s(Ne,{value:e(se),"onUpdate:value":ae[0]||(ae[0]=Me=>ie(se)?se.value=Me:null),placeholder:Q.$t("title.searchMembers"),disabled:e(U),"allow-clear":"",class:"nc-input-border-on-value !max-w-90 !h-8 !px-3 !py-1 !rounded-lg"},{prefix:n(()=>[s(be,{icon:"search",class:"mr-2 h-4 w-4 text-gray-500 group-hover:text-black"})]),_:1},8,["value","placeholder","disabled"]),s(fe,{disabled:e(U),size:"small",onClick:ae[1]||(ae[1]=Me=>x.value=!0)},{default:n(()=>[t("div",wl,[(a(),E(gt(("iconMap"in Q?Q.iconMap:e(jt)).plus),{class:"w-4 h-4"})),G(" "+m(Q.$t("activity.addMembers")),1)])]),_:1},8,["disabled"])])),s(It,{"order-by":e(Re),"onUpdate:orderBy":ae[3]||(ae[3]=Me=>ie(Re)?Re.value=Me:null),"is-data-loading":e(U),columns:ge,data:e(J),bordered:!1,"custom-row":Ve,class:"flex-1 nc-collaborators-list max-w-full","body-row-class-name":"!cursor-default",pagination:!0,"pagination-offset":25},{emptyText:n(()=>[s(je,{description:Q.$t("title.noMembersFound")},null,8,["description"])]),headerCell:n(({column:Me})=>[Me.key==="select"?(a(),E(De,{key:0,checked:e(Pe),"onUpdate:checked":ae[2]||(ae[2]=he=>ie(Pe)?Pe.value=he:null),disabled:!e(J).length},null,8,["checked","disabled"])):(a(),P(_e,{key:1},[G(m(Me.title),1)],64))]),bodyCell:n(({column:Me,record:he})=>[Me.key==="select"?(a(),E(De,{key:0,checked:e(Se)[he.id],"onUpdate:checked":Dt=>e(Se)[he.id]=Dt},null,8,["checked","onUpdate:checked"])):A("",!0),Me.key==="email"?(a(),P("div",kl,[s(Te,{size:"base",user:he,class:"flex-none"},null,8,["user"]),t("div",$l,[t("div",Sl,[s(St,{class:"truncate max-w-full text-gray-800 capitalize font-semibold","show-on-truncate-only":""},{title:n(()=>[G(m(he.display_name||he.email.slice(0,he.email.indexOf("@"))),1)]),default:n(()=>[G(" "+m(he.display_name||he.email.slice(0,he.email.indexOf("@"))),1)]),_:2},1024)]),s(St,{class:"truncate max-w-full text-xs text-gray-600","show-on-truncate-only":""},{title:n(()=>[G(m(he.email),1)]),default:n(()=>[G(" "+m(he.email),1)]),_:2},1024)])])):A("",!0),Me.key==="role"?(a(),P("div",Cl,[ft(he)&&e(xe)&&e(c).includes(he.roles)?(a(),E(Ct,{key:0,role:he.roles,roles:e(c),inherit:("isEeUI"in Q?Q.isEeUI:e(nt))&&he.workspace_roles&&e(zt)[he.workspace_roles]?e(zt)[he.workspace_roles]:null,"show-inherit":"",description:!1,"on-role-change":Dt=>Ie(he,Dt)},null,8,["role","roles","inherit","on-role-change"])):(a(),E(as,{key:1,border:!1,role:he.roles},null,8,["role"]))])):A("",!0),Me.key==="created_at"?(a(),P("div",Il,[s(St,{class:"max-w-full"},{title:n(()=>[G(m(("parseStringDateTime"in Q?Q.parseStringDateTime:e(Yn))(he.created_at)),1)]),default:n(()=>[t("span",null,m(("timeAgo"in Q?Q.timeAgo:e(qn))(he.created_at)),1)]),_:2},1024)])):A("",!0)]),_:1},8,["order-by","is-data-loading","data"])]),s(os,{"model-value":e(x),"onUpdate:modelValue":ae[4]||(ae[4]=Me=>ie(x)?x.value=Me:null),"base-id":(Ft=e(q))==null?void 0:Ft.id,users:e(O),type:"base"},null,8,["model-value","base-id","users"])],64)),s(ls)],2)}}}),Tl=Object.assign(ke(Dl,[["__scopeId","data-v-34d3bfca"]]),{__name:"ProjectAccessSettings"}),Ml=re({__name:"Permissions",props:{state:{},baseId:{},reload:{type:Boolean}},emits:["update:state","update:reload"],setup(I){return(o,b)=>{const y=kt;return a(),E(y)}}}),Ol=Object.assign(Ml,{__name:"DashboardSettingsPermissions"}),Pl={class:"flex flex-col gap-1"},Nl={class:"flex items-center gap-3"},jl={class:"ml-10 text-small leading-[18px] text-gray-500"},El={class:"flex flex-col gap-1"},Bl={class:"flex items-center gap-3"},Al=re({__name:"SourceRestrictions",props:{allowMetaWrite:{type:Boolean},allowDataWrite:{type:Boolean}},emits:["update:allowMetaWrite","update:allowDataWrite"],setup(I,{emit:o}){const b=I,y=o,r=Ge(b,"allowDataWrite",y),k=Ge(b,"allowMetaWrite",y);return(D,$)=>{const f=Gs,w=Ze,N=mt;return a(),P(_e,null,[s(N,{class:"nc-source-restictions-card"},{default:n(()=>[t("div",Pl,[t("div",Nl,[s(w,{disabled:!e(k),placement:"topLeft",class:"flex"},{title:n(()=>[G(m(D.$t("tooltip.dataWriteOptionDisabled")),1)]),default:n(()=>[s(f,{checked:e(r),"onUpdate:checked":$[0]||($[0]=u=>ie(r)?r.value=u:null),disabled:e(k),"data-testid":"nc-allow-data-write",size:"small"},null,8,["checked","disabled"])]),_:1},8,["disabled"]),t("span",{class:"cursor-pointer",onClick:$[1]||($[1]=u=>e(k)?void 0:r.value=!e(r))},m(D.$t("labels.allowDataWrite")),1)]),t("div",jl,m(D.$t("tooltip.allowDataWrite")),1)])]),_:1}),s(N,{class:"nc-source-restictions-card"},{default:n(()=>[t("div",El,[t("div",Bl,[s(f,{checked:e(k),"onUpdate:checked":$[2]||($[2]=u=>ie(k)?k.value=u:null),"data-testid":"nc-allow-meta-write",class:"nc-allow-meta-write",size:"small"},null,8,["checked"]),t("span",{class:"cursor-pointer",onClick:$[3]||($[3]=u=>k.value=!e(k))},m(D.$t("labels.allowMetaWrite")),1)]),t("div",{class:ue(["ml-10 text-small leading-[18px] text-gray-500",{"nc-allow-meta-write-help":e(k)}])},m(D.$t("labels.notRecommended"))+": "+m(D.$t("tooltip.allowMetaWrite")),3)])]),_:1})],64)}}}),Ul=Object.assign(ke(Al,[["__scopeId","data-v-b77d1107"]]),{__name:"DashboardSettingsDataSourcesSourceRestrictions"}),Rl={class:"w-full flex flex-col gap-3"},Ll={class:"h-7 w-7 flex items-center justify-center"},Fl=["href"],zl=re({__name:"SupportedDocs",setup(I){const o=[{title:"Integrations",href:"https://nocodb.com/docs/product-docs/integrations"},{title:"Create new connection",href:"https://nocodb.com/docs/product-docs/integrations/create-connection"},{title:"Add new Data source",href:"https://nocodb.com/docs/product-docs/data-sources/connect-to-data-source"}];return(b,y)=>{const r=$e;return a(),P("div",Rl,[y[0]||(y[0]=t("div",{class:"text-sm text-gray-800 font-semibold"},"Relevant documentation",-1)),t("div",null,[(a(),P(_e,null,Be(o,(k,D)=>t("div",{key:D,class:"flex items-center gap-1"},[t("div",Ll,[s(r,{icon:"bookOpen",class:"flex-none w-4 h-4 text-gray-500"})]),t("a",{href:k.href,target:"_blank",rel:"noopener noreferrer",class:"!text-gray-600 text-sm !no-underline !hover:underline"},m(k.title),9,Fl)])),64))])])}}}),Vl=Object.assign(zl,{__name:"DashboardSettingsDataSourcesSupportedDocs"}),Gl={class:"flex-1 flex flex-col max-h-full"},Wl={class:"px-4 py-3 w-full flex items-center gap-3 border-b-1 border-gray-200"},Kl={class:"h-6 self-start flex items-center"},ql={class:"flex items-center gap-3"},Yl={class:"h-[calc(100%_-_58px)] flex"},Hl={class:"nc-add-source-left-panel nc-scrollbar-thin relative"},Ql={class:"create-source bg-white relative flex flex-col gap-2 w-full max-w-[768px]"},Jl={class:"nc-form-section"},Zl={class:"nc-form-section-body"},Xl=["data-testid"],ei={class:"w-full flex items-center gap-2 px-2 py-2 rounded-md hover:bg-gray-100"},ti={class:"nc-form-section"},si={class:"nc-form-section-body"},ni={class:"nc-form-section"},ai={class:"nc-form-section-body"},oi={class:"flex flex-col gap-4"},li={class:"flex flex-col gap-4"},ii={class:"flex items-center justify-center h-full w-full !bg-white !bg-opacity-85 z-1000"},ci={class:"nc-add-source-right-panel"},ri=re({__name:"CreateBase",props:{open:{type:Boolean},connectionType:{}},emits:["update:open","sourceCreated"],setup(I,{emit:o}){const b=I,y=o,r=Ge(b,"open",y),{loadIntegrations:k,integrations:D,eventBus:$,pageMode:f,IntegrationsPageMode:w}=Rt(),N=Qe(),{loadProject:u}=et(),{base:i}=ve(N),{loadProjectTables:d}=xs(),{refreshCommandPalette:p}=qt(),l=At(ws,void 0),M=X(()=>{var W;return(l==null?void 0:l.value)??((W=i.value)==null?void 0:W.id)}),g=X(()=>D.value.filter(W=>W.sub_type!==Ps.NOCODB)),v=_t.useForm,B=V(!1),L=V(!1),h=V(),{api:j}=Jn(),{$e:T}=Ae(),{t:S}=ct(),{isUIAllowed:Y}=rt(),R=V(!1),_=V([]),K=V(!1),C=V(((W=we.MYSQL)=>({title:"",dataSource:{...Ns(W)},inflection:{inflectionColumn:"none",inflectionTable:"none"},sslUse:na.No,extraParameters:[],is_schema_readonly:!0,is_data_readonly:!1}))()),oe=V(!1),H=V(0),q=()=>{H.value+=1,H.value>=2&&(oe.value=!0)},x=X(()=>C.value.fk_integration_id&&D.value.find(W=>W.id===C.value.fk_integration_id)),O=X(()=>{var W,z,ce;return(ce=(z=(W=x.value)==null?void 0:W.config)==null?void 0:z.connection)==null?void 0:ce.database}),ne=X(()=>{var W,z,ce;return(ce=(z=(W=x.value)==null?void 0:W.config)==null?void 0:z.searchPath)==null?void 0:ce[0]}),se=W=>O.value,U=X(()=>{let W={"dataSource.connection.database":x.value&&se()?[]:[pt()]};switch(C.value.dataSource.client){case we.SQLITE:W={};break;case we.SNOWFLAKE:W={"dataSource.connection.database":[pt()],"dataSource.connection.schema":[pt()]};break;case we.PG:W["dataSource.searchPath.0"]=x.value?[]:[pt()];break}return{title:[{required:!0,message:S("labels.sourceNameRequired")},Xn()],fk_integration_id:[{required:!0,message:"Connection is required"}],extraParameters:[Zn],...W}}),{validate:c,validateInfos:F,clearValidate:J}=v(C.value,U),le=()=>{C.value.dataSource={...Ns(C.value.dataSource.client)}},xe=["camelize","none"];function Ie(){const W=Object.fromEntries(new Map(C.value.extraParameters.filter(ce=>{var fe;return(fe=ce.key)==null?void 0:fe.trim()}).map(ce=>[ce.key,ce.value]))),z={...C.value.dataSource.connection,...W};return z.ssl=Na(z,C.value.sslUse,C.value.dataSource.client),z}const ze=()=>{var W,z,ce,fe,Z;(Z=(fe=(ce=(z=(W=h.value)==null?void 0:W.$el.querySelector(".ant-form-item-explain-error"))==null?void 0:z.parentNode)==null?void 0:ce.parentNode)==null?void 0:fe.querySelector("input"))==null||Z.focus()},{$poller:Se}=Ae(),Ue=async()=>{var W,z;try{await c()}catch{ze();return}try{if(!M.value)return;R.value=!0;const ce=Ie(),fe={...C.value.dataSource,connection:ce};x.value&&(((W=fe.connection)==null?void 0:W.database)===""&&(fe.connection.database=void 0),((z=fe.searchPath)==null?void 0:z[0])===""&&(fe.searchPath=void 0));const Z=await j.source.create(M.value,{fk_integration_id:C.value.fk_integration_id,alias:C.value.title,type:C.value.dataSource.client,config:fe,inflection_column:C.value.inflection.inflectionColumn,inflection_table:C.value.inflection.inflectionTable,is_schema_readonly:C.value.is_schema_readonly,is_data_readonly:C.value.is_data_readonly});Se.subscribe({id:Z.id},async Ne=>{var je,De;Ne.status!=="close"&&(Ne.status===Ye.COMPLETED?(T("a:base:create:extdb"),M.value&&(await u(M.value,!0),await d(M.value,!0)),y("sourceCreated"),r.value=!1,R.value=!1):Ne.status===Ye.FAILED&&(pe.error(((De=(je=Ne==null?void 0:Ne.data)==null?void 0:je.error)==null?void 0:De.message)||"Failed to create base"),R.value=!1))})}catch(ce){pe.error(await Fe(ce)),R.value=!1}finally{p()}},Pe=V(),Re=async()=>{try{await c()}catch{ze();return}T("a:source:create:extdb:test-connection",[]);try{if(L.value=!0,C.value.dataSource.client===we.SQLITE)B.value=!0;else{const W=Ie();W.database=aa(C.value.dataSource);let z=C.value.dataSource.searchPath;x.value&&(z==null?void 0:z[0])===""&&(z=void 0);const ce={...C.value.dataSource,connection:W,searchPath:z,fk_integration_id:C.value.fk_integration_id},fe=await j.utils.testConnection(ce);fe.code===0?B.value=!0:(B.value=!1,pe.error(`${S("msg.error.dbConnectionFailed")} ${fe.message}`))}}catch(W){B.value=!1,Pe.value=await Fe(W)}L.value=!1};Oe(()=>C.value.dataSource,()=>{B.value=!1,Pe.value=null},{deep:!0}),We(async()=>{var W;K.value=!0,D.value.length||await k(!0,(W=i.value)==null?void 0:W.id),C.value.title=await ea(),it(()=>{setTimeout(()=>{var ce,fe;const z=(fe=(ce=h.value)==null?void 0:ce.$el)==null?void 0:fe.querySelector("input[type=text]");z==null||z.setSelectionRange(0,C.value.title.length),z==null||z.focus()},500)}),K.value=!1});const ge=X({get:()=>!C.value.is_schema_readonly,set:W=>{C.value.is_schema_readonly=!W,W&&(C.value.is_data_readonly=!1),T("c:source:schema-write-toggle",{allowed:!W,edit:!0})}}),Ve=X({get:()=>!C.value.is_data_readonly,set:W=>{C.value.is_data_readonly=!W,T("c:source:data-write-toggle",{allowed:!W})}}),ye=(W=!1)=>{var z;C.value.fk_integration_id&&x.value?C.value.dataSource={client:x.value.sub_type,connection:{database:O.value},searchPath:(z=x.value.config)==null?void 0:z.searchPath}:le(),J(),W&&setTimeout(()=>{Re()},300)},ft=()=>{f.value=w.LIST};$.on((W,z)=>{W===ta.INTEGRATION_ADD&&(z!=null&&z.id)&&(C.value.fk_integration_id=z.id,ht(()=>{var ce;return((ce=x.value)==null?void 0:ce.id)===z.id}).toBeTruthy().then(()=>{ye(!0)}))});const tt=W=>{W?(_.value=["1"],Q(!0,"nc-source-advanced-options")):_.value=[]};let st;function Q(W,z){st&&clearTimeout(st),it(()=>{const ce=document.querySelector(`.create-source .${z}`);ce&&(st=setTimeout(()=>{ce.scrollIntoView({block:"center",behavior:"smooth"})},400))})}const ae=W=>[ks.DATABASE].includes(W.value),de=W=>W.sub_type!==Ps.NOCODB&&W.isAvailable,be=(W={})=>{switch(W.sub_type){case we.SQLITE:return{isDisabled:(W==null?void 0:W.source_count)&&W.source_count>0,msg:"Sqlite support only 1 database per connection"};default:return{isDisabled:!1,msg:""}}};return(W,z)=>{const ce=$e,fe=Ke,Z=Ze,Ne=vt,je=mt,De=Xt,Te=Zt,St=Is,Ct=ys,as=sa,It=Ws,os=Ul,ls=sn,Lt=tn,Ft=_t,Me=Oa,he=Pa,Dt=qs,bn=Aa,yn=Vl,gn=es,hn=Ut;return a(),E(hn,{visible:e(r),"onUpdate:visible":z[18]||(z[18]=ee=>ie(r)?r.value=ee:null),closable:!1,"mask-closable":!e(R),keyboard:!e(R),centered:"",size:"large","wrap-class-name":"nc-modal-create-source",onKeydown:z[19]||(z[19]=Et(ee=>r.value=!1,["esc"]))},{default:n(()=>[t("div",Gl,[t("div",Wl,[t("div",Kl,[s(ce,{icon:"server1",class:"!text-green-700 !h-4 !w-4"})]),z[21]||(z[21]=t("div",{class:"flex-1 text-base font-weight-700"},"Add Data Source",-1)),t("div",ql,[t("div",{class:"w-[15px] h-[15px] cursor-pointer",onDblclick:q},null,32),s(Z,{disabled:!e(Pe)},{title:n(()=>[G(m(e(Pe)),1)]),default:n(()=>[s(fe,{type:"secondary",size:"small",class:ue(["nc-extdb-btn-test-connection",{"pointer-events-none":e(B)}]),disabled:!e(x)||e(K),loading:e(L),"icon-position":"right",onClick:z[0]||(z[0]=ee=>Re())},{icon:n(()=>[e(B)?(a(),E(ce,{key:0,icon:"circleCheckSolid",class:"!text-green-700 w-4 h-4"})):e(Pe)?(a(),E(ce,{key:1,icon:"alertTriangleSolid",class:"!text-red-700 w-4 h-4"})):A("",!0)]),default:n(()=>[t("span",null,m(e(B)?"Test successful":"Test connection"),1)]),_:1},8,["class","disabled","loading"])]),_:1},8,["disabled"]),s(fe,{size:"small",type:"primary",disabled:!e(B)||!e(x)||e(K),loading:e(R),class:"nc-extdb-btn-submit",onClick:Ue},{default:n(()=>z[20]||(z[20]=[G(" Add Source ")])),_:1,__:[20]},8,["disabled","loading"]),s(fe,{disabled:e(R),size:"small",type:"text",onClick:z[1]||(z[1]=ee=>r.value=!1)},{default:n(()=>[s(ce,{icon:"close",class:"text-gray-600"})]),_:1},8,["disabled"])])]),t("div",Yl,[t("div",Hl,[t("div",Ql,[s(Ft,{ref_key:"form",ref:h,model:e(C),"hide-required-mark":"",name:"external-base-create-form",layout:"vertical","no-style":"",class:"flex flex-col gap-5.5"},{default:n(()=>[t("div",Jl,[t("div",Zl,[s(Te,{gutter:24},{default:n(()=>[s(De,{span:12},{default:n(()=>[s(je,qe({label:"Data Source Name"},e(F).title),{default:n(()=>[s(Ne,{value:e(C).title,"onUpdate:value":z[2]||(z[2]=ee=>e(C).title=ee)},null,8,["value"])]),_:1},16)]),_:1})]),_:1}),s(Te,{gutter:24},{default:n(()=>[s(De,{span:12},{default:n(()=>[s(je,qe({label:"Select connection"},e(F).fk_integration_id),{default:n(()=>[s(It,{value:e(C).fk_integration_id,"onUpdate:value":z[4]||(z[4]=ee=>e(C).fk_integration_id=ee),class:"nc-extdb-db-type nc-select-shadow","dropdown-class-name":"nc-dropdown-ext-db-type",placeholder:"Select connection","allow-clear":"","show-search":"","dropdown-match-select-width":"",onChange:z[5]||(z[5]=ee=>ye())},hs({default:n(()=>[(a(!0),P(_e,null,Be(e(g),ee=>(a(),E(Ct,{key:ee.id,value:ee.id,disabled:be(ee).isDisabled},{default:n(()=>[t("div",{class:"w-full flex gap-2 items-center","data-testid":ee.title},[ee!=null&&ee.sub_type?(a(),E(St,{key:0,type:ee.sub_type,style:Ks({filter:be(ee).isDisabled?"grayscale(100%) brightness(115%)":void 0})},null,8,["type","style"])):A("",!0),s(Z,{class:"flex-1 truncate","show-on-truncate-only":!be(ee).isDisabled},{title:n(()=>[G(m(be(ee).isDisabled?be(ee).msg:ee.title),1)]),default:n(()=>[G(" "+m(ee.title),1)]),_:2},1032,["show-on-truncate-only"]),e(C).fk_integration_id===ee.id?(a(),E(gt(("iconMap"in W?W.iconMap:e(jt)).check),{key:1,id:"nc-selected-item-icon",class:"text-primary w-4 h-4"})):A("",!0)],8,Xl)]),_:2},1032,["value","disabled"]))),128))]),_:2},[e(Y)("workspaceIntegrations")?{name:"dropdownRender",fn:n(({menuNode:ee})=>[(a(),E(gt(ee))),s(as,{style:{margin:"4px 0"}}),t("div",{class:"px-1.5 flex items-center text-brand-500 text-sm cursor-pointer",onMousedown:z[3]||(z[3]=He(()=>{},["prevent"])),onClick:ft},[t("div",ei,[s(ce,{icon:"plus",class:"flex-none"}),G(" "+m(W.$t("general.new"))+" "+m(W.$t("general.connection").toLowerCase()),1)])],32)]),key:"0"}:void 0]),1032,["value"])]),_:1},16)]),_:1})]),_:1})])]),e(x)?(a(),P(_e,{key:0},[t("div",ti,[t("div",si,[e(C).dataSource.client===e(we).SQLITE?(a(),P(_e,{key:0},[],64)):e(C).dataSource.client===e(we).SNOWFLAKE?(a(),E(Te,{key:1,gutter:24},{default:n(()=>[s(De,{span:12},{default:n(()=>[s(je,qe({label:W.$t("labels.database")},e(F)["dataSource.connection.database"]),{default:n(()=>[s(Ne,{value:e(C).dataSource.connection.database,"onUpdate:value":z[6]||(z[6]=ee=>e(C).dataSource.connection.database=ee),class:"nc-extdb-host-database"},null,8,["value"])]),_:1},16,["label"])]),_:1}),s(De,{span:12},{default:n(()=>[s(je,qe({label:"Schema"},e(F)["dataSource.connection.schema"]),{default:n(()=>[s(Ne,{value:e(C).dataSource.connection.schema,"onUpdate:value":z[7]||(z[7]=ee=>e(C).dataSource.connection.schema=ee),class:"nc-extdb-host-database"},null,8,["value"])]),_:1},16)]),_:1})]),_:1})):e(C).dataSource.client===e(we).DATABRICKS?(a(),E(Te,{key:2,gutter:24},{default:n(()=>[s(De,{span:12},{default:n(()=>[s(je,qe({label:"Database"},e(F)["dataSource.connection.database"]),{default:n(()=>[s(Ne,{value:e(C).dataSource.connection.database,"onUpdate:value":z[8]||(z[8]=ee=>e(C).dataSource.connection.database=ee),class:"nc-extdb-host-database"},null,8,["value"])]),_:1},16)]),_:1}),s(De,{span:12},{default:n(()=>[s(je,qe({label:"Schema"},e(F)["dataSource.connection.schema"]),{default:n(()=>[s(Ne,{value:e(C).dataSource.connection.schema,"onUpdate:value":z[9]||(z[9]=ee=>e(C).dataSource.connection.schema=ee),class:"nc-extdb-host-schema"},null,8,["value"])]),_:1},16)]),_:1})]),_:1})):(a(),E(Te,{key:3,gutter:24},{default:n(()=>[s(De,{span:12},{default:n(()=>[s(je,qe({label:W.$t("labels.database")},e(F)["dataSource.connection.database"]),{default:n(()=>[s(Ne,{value:e(C).dataSource.connection.database,"onUpdate:value":z[10]||(z[10]=ee=>e(C).dataSource.connection.database=ee),placeholder:W.$t("labels.dbCreateIfNotExists"),class:"nc-extdb-host-database"},null,8,["value","placeholder"])]),_:1},16,["label"])]),_:1}),s(De,{span:12},{default:n(()=>{var ee;return[([e(we).PG].includes(e(C).dataSource.client)||[e(we).PG].includes((ee=e(x))==null?void 0:ee.sub_type))&&e(C).dataSource.searchPath?(a(),E(je,qe({key:0,label:W.$t("labels.schemaName")},e(F)["dataSource.searchPath.0"]),{default:n(()=>[s(Ne,{value:e(C).dataSource.searchPath[0],"onUpdate:value":z[11]||(z[11]=Ts=>e(C).dataSource.searchPath[0]=Ts),placeholder:e(ne)&&`${e(ne)} (default)`},null,8,["value","placeholder"])]),_:1},16,["label"])):A("",!0)]}),_:1})]),_:1}))])]),t("div",ni,[z[22]||(z[22]=t("div",{class:"nc-form-section-title"},"Permissions",-1)),t("div",ai,[s(os,{"allow-meta-write":e(ge),"onUpdate:allowMetaWrite":z[12]||(z[12]=ee=>ie(ge)?ge.value=ee:null),"allow-data-write":e(Ve),"onUpdate:allowDataWrite":z[13]||(z[13]=ee=>ie(Ve)?Ve.value=ee:null)},null,8,["allow-meta-write","allow-data-write"])])]),[e(we).SQLITE,e(we).SNOWFLAKE,e(we).DATABRICKS].includes(e(C).dataSource.client)?A("",!0):(a(),E(Lt,{key:0,"active-key":e(_),"onUpdate:activeKey":z[17]||(z[17]=ee=>ie(_)?_.value=ee:null),ghost:"",class:"nc-source-advanced-options !mt-4"},{expandIcon:n(({isActive:ee})=>[s(fe,{type:"text",size:"small",class:"!-ml-1.5",onClick:z[14]||(z[14]=Ts=>tt(!e(_).length))},{default:n(()=>[z[23]||(z[23]=t("div",{class:"nc-form-section-title"},"Advanced options",-1)),s(ce,{icon:"chevronDown",class:ue(["ml-2 flex-none cursor-pointer transform transition-transform duration-500",{"!rotate-180":ee}])},null,8,["class"])]),_:2,__:[23]},1024)]),default:n(()=>[s(ls,{key:"1",collapsible:"disabled"},{header:n(()=>z[24]||(z[24]=[t("span",null,null,-1)])),default:n(()=>[t("div",oi,[t("div",li,[s(Te,{gutter:24},{default:n(()=>[s(De,{span:12},{default:n(()=>[s(je,{label:W.$t("labels.inflection.tableName")},{default:n(()=>[s(It,{value:e(C).inflection.inflectionTable,"onUpdate:value":z[15]||(z[15]=ee=>e(C).inflection.inflectionTable=ee),class:"nc-select-shadow","dropdown-class-name":"nc-dropdown-inflection-table-name"},{default:n(()=>[(a(),P(_e,null,Be(xe,ee=>s(Ct,{key:ee,value:ee},{default:n(()=>[G(m(ee),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1}),s(De,{span:12},{default:n(()=>[s(je,{label:W.$t("labels.inflection.columnName")},{default:n(()=>[s(It,{value:e(C).inflection.inflectionColumn,"onUpdate:value":z[16]||(z[16]=ee=>e(C).inflection.inflectionColumn=ee),class:"nc-select-shadow","dropdown-class-name":"nc-dropdown-inflection-column-name"},{default:n(()=>[(a(),P(_e,null,Be(xe,ee=>s(Ct,{key:ee,value:ee},{default:n(()=>[G(m(ee),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["active-key"]))],64)):A("",!0),z[25]||(z[25]=t("div",null,null,-1))]),_:1,__:[25]},8,["model"]),s(Me,{"is-modal":"","filter-category":ae,"filter-integration":de}),s(he,{"load-datasource-info":"","base-id":e(M)},null,8,["base-id"])]),s(bn,{"model-value":e(K),inline:"",transition:"",class:"!bg-opacity-15"},{default:n(()=>[t("div",ii,[s(Dt,{size:"large"})])]),_:1},8,["model-value"])]),t("div",ci,[s(yn),s(gn)])])])]),_:1},8,["visible","mask-closable","keyboard"])}}}),un=Object.assign(ke(ri,[["__scopeId","data-v-2df41c96"]]),{__name:"DashboardSettingsDataSourcesCreateBase"}),di=Object.freeze(Object.defineProperty({__proto__:null,default:un},Symbol.toStringTag,{value:"Module"})),ui=at(()=>ot(()=>import("./kEFUUbpd.js"),__vite__mapDeps([61,39,1,2,40,41,46,47,42,43,44,45,48,49,7,50,6,14,15,51,52,53,4,5,8,9,10,11,12,13,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,54,55,56,57,58,59,62]),import.meta.url).then(I=>I.default||I)),pi=at(()=>ot(()=>import("./WDYzPv8C.js"),__vite__mapDeps([63,64,1,2,46,47,65,66]),import.meta.url).then(I=>I.default||I)),_i=at(()=>ot(()=>import("./CHPx98pw.js"),__vite__mapDeps([67,1,2,68,33,34,35,36]),import.meta.url).then(I=>I.default||I)),mi=at(()=>ot(()=>import("./DcZDB0M_.js"),__vite__mapDeps([69,4,1,2,5,6,7,8,9,10,11,68,33,34,35,36,22]),import.meta.url).then(I=>I.default||I)),vi={class:"flex flex-col h-full p-6","data-testid":"nc-settings-datasources-tab"},fi={class:"mb-6 flex items-center justify-between gap-3"},bi={class:"flex flex-row items-center w-full gap-x-1"},yi={class:"flex"},gi={key:0,class:"h-full"},hi={class:"px-4 pt-4 pb-2 flex items-center justify-between gap-3"},xi={class:"capitalize text-base"},wi={class:"tab","data-testid":"nc-connection-tab"},ki={class:"h-full"},$i={class:"tab","data-testid":"nc-erd-tab"},Si={class:"h-full p-6"},Ci={class:"tab","data-testid":"nc-acl-tab"},Ii={class:"p-6 h-full"},Di={class:"tab","data-testid":"nc-meta-sync-tab"},Ti={class:"p-6 h-full"},Mi={key:1,class:"ds-table overflow-y-auto nc-scrollbar-thin relative max-h-full mb-4"},Oi={class:"ds-table-head sticky top-0 bg-white z-10"},Pi={class:"ds-table-row !border-0"},Ni={class:"ds-table-col ds-table-enabled cursor-pointer"},ji={class:"ds-table-col ds-table-name"},Ei={class:"ds-table-col ds-table-integration-name"},Bi={class:"ds-table-col ds-table-type"},Ai={class:"ds-table-col ds-table-actions"},Ui={class:"ds-table-body relative"},Ri={class:"ds-table-col ds-table-enabled"},Li={key:0,class:"ds-table-handle"},Fi={class:"ds-table-col ds-table-name font-medium"},zi={class:"flex items-center gap-1"},Vi={class:"ds-table-col ds-table-actions"},Gi=["onClick"],Wi={class:"ds-table-col ds-table-enabled"},Ki={class:"ds-table-col ds-table-name font-medium w-full"},qi={key:0,class:"h-8 w-1"},Yi={class:"ds-table-col ds-table-integration-name w-full"},Hi={class:"ds-table-col ds-table-type"},Qi={class:"flex justify-end"},Ji={key:0,class:"flex-none integration-table-empty flex items-center justify-center py-8 px-6"},Zi={class:"px-2 py-6 text-gray-500 flex flex-col items-center gap-6 text-center"},Xi={class:"flex items-center justify-center absolute left-0 top-0 w-full h-[calc(100%_-_45px)] z-10 pb-10 pointer-events-none"},ec={class:"flex flex-col justify-center items-center gap-2"},tc={class:"text-center"},sc={key:0,class:"flex flex-row items-center py-2 px-3.25 bg-gray-50 rounded-lg text-gray-700 mb-4"},nc={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-3",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},ac=re({__name:"DataSources",props:{state:{},baseId:{},reload:{type:Boolean}},emits:["update:state","update:reload"],setup(I,{emit:o}){const b=I,y=o,r=Ge(b,"state",y),k=Ge(b,"reload",y),{$api:D,$e:$}=Ae(),f=et(),{loadProject:w}=f,{isDataSourceLimitReached:N,bases:u}=ve(f),i=X(()=>u.value.get(b.baseId)??{}),{isUIAllowed:d}=rt(),{projectPageTab:p}=ve(ns()),{refreshCommandPalette:l}=qt(),{updateStatLimit:M,showExternalSourcePlanLimitExceededModal:g}=Bt(),v=V([]),B=V(""),L=V(we.MYSQL),h=V(!1),j=V(!1),T=V(),S=V("");async function Y(){const U=new Set;let c=!1;for(const F of v.value){if(F.order===null||U.has(F.order)){c=!0;break}U.add(F.order)}if(c){v.value=v.value.sort((F,J)=>F.is_local||F.is_meta?-1:J.is_local||J.is_meta?1:(F.order??0)-(J.order??0)),v.value=v.value.map((F,J)=>({...F,order:J+1}));try{await Promise.all(v.value.map(async F=>{await D.source.update(F.base_id,F.id,{id:F.id,base_id:F.base_id,order:F.order})})),await w(i.value.id,!0)}catch(F){pe.error(await Fe(F))}}}async function R(U){try{U&&l(),await ht(()=>!!i.value.id).toBeTruthy(),h.value=!0,k.value=!0;const c=await D.source.list(i.value.id);c.list&&c.list.length&&(v.value=c.list),await Y()}catch(c){console.error(c)}finally{k.value=!1,h.value=!1}}const _=(U,c)=>{U&&(B.value=U,r.value=c||"")},K=U=>{$("c:source:delete"),j.value=!0,T.value=U},te=async()=>{if(T.value)try{await D.source.delete(T.value.base_id,T.value.id),$("a:source:delete"),v.value.splice(v.value.indexOf(T.value),1),M(oa.LIMIT_EXTERNAL_SOURCE_PER_WORKSPACE,-1),await w(i.value.id,!0)}catch(U){pe.error(await Fe(U))}finally{l()}},C=async(U,c)=>{try{if(!c&&v.value.filter(F=>F.enabled).length<2){pe.info("There should be at least one enabled source!");return}U.enabled=c,await D.source.update(U.base_id,U.id,{id:U.id,base_id:U.base_id,enabled:U.enabled}),await w(i.value.id,!0)}catch(F){pe.error(await Fe(F))}finally{l()}},oe=async U=>{var c,F;try{if(U.oldIndex===U.newIndex)return;const J=v.value[U.newIndex];if(J){let le;v.value.length-1===U.newIndex?le=Math.max(...v.value.map(Ie=>(Ie==null?void 0:Ie.order)??0))+1:le=(parseFloat(String(((c=v.value[U.newIndex-1])==null?void 0:c.order)??0))+parseFloat(String(((F=v.value[U.newIndex+1])==null?void 0:F.order)??0)))/2;const xe=isNaN(Number(le))?U.oldIndex:le;await D.source.update(J.base_id,J.id,{id:J.id,base_id:J.base_id,order:xe})}await w(i.value.id,!0),await R()}catch(J){pe.error(await Fe(J))}finally{await l()}};Oe(p,()=>{S.value&&(S.value=""),p.value==="data-source"&&R()},{immediate:!0}),Oe(()=>b.reload,async U=>{U&&!h.value&&await R()}),Oe(r,async U=>{switch(v.value.length||await R(),U){case we.MYSQL:L.value=we.MYSQL,r.value=lt.New;break;case we.PG:L.value=we.PG,r.value=lt.New;break;case we.SQLITE:L.value=we.SQLITE,r.value=lt.New;break;case we.SNOWFLAKE:L.value=we.SNOWFLAKE,r.value=lt.New;break;case lt.New:(g()||N.value)&&(r.value="");break}l()},{immediate:!0});const H=X({get:()=>[lt.New].includes(r.value),set:U=>{U||(r.value="")}}),q=V(null),x=V("erd"),O=()=>{var U;return v.value.filter(c=>{var F,J,le;return(le=(F=c==null?void 0:c.alias)==null?void 0:F.toLowerCase())==null?void 0:le.includes((J=S.value)==null?void 0:J.toLowerCase())}).length||"default".includes((U=S.value)==null?void 0:U.toLowerCase())},ne=X({get:()=>!!q.value,set:U=>{U||(q.value=null)}}),se=(U,c)=>{c&&c!==x.value&&(x.value=c),q.value=U};return(U,c)=>{var fe;const F=$e,J=vt,le=Ke,xe=Nt,Ie=yt,ze=ui,Se=$s,Ue=pi,Pe=_i,Re=mi,ge=Ys,Ve=Ut,ye=un,ft=Gs,tt=Ze,st=Ua,Q=Cs,ae=ts,de=es,be=ss,W=Ss,z=Qt,ce=rn;return a(),P("div",vi,[t("div",fi,[s(J,{value:e(S),"onUpdate:value":c[0]||(c[0]=Z=>ie(S)?S.value=Z:null),type:"text",class:"nc-search-data-source-input nc-input-border-on-value !max-w-90 nc-input-sm",placeholder:"Search data source","allow-clear":""},{prefix:n(()=>[s(F,{icon:"search",class:"mr-2 h-4 w-4 text-gray-500"})]),_:1},8,["value"]),!e(N)&&e(d)("sourceCreate")?(a(),E(le,{key:0,size:"large",class:"z-10 !px-2",type:"primary",onClick:c[1]||(c[1]=()=>{e(g)()||(r.value=("DataSourcesSubTab"in U?U.DataSourcesSubTab:e(lt)).New)})},{default:n(()=>[t("div",bi,[(a(),E(gt(("iconMap"in U?U.iconMap:e(jt)).plus))),t("div",yi,m(U.$t("activity.newSource")),1)])]),_:1})):A("",!0)]),t("div",{"data-testid":"nc-settings-datasources",class:"flex flex-row w-full nc-data-sources-view flex-grow min-h-0",style:Ks({maxHeight:e(H)?"100%":e(q)?"calc(100% - 46px)":"calc(100% - 66px)"})},[s(Ve,{visible:e(ne),"onUpdate:visible":c[8]||(c[8]=Z=>ie(ne)?ne.value=Z:null),centered:"",size:"large","wrap-class-name":"nc-active-data-sources-view",onKeydown:c[9]||(c[9]=Et(Z=>q.value=null,["esc"]))},{default:n(()=>[e(q)?(a(),P("div",gi,[t("div",hi,[s(Ie,{separator:">",class:"flex-1 cursor-pointer font-weight-bold !ml-1"},{default:n(()=>[s(xe,{onClick:c[2]||(c[2]=Z=>q.value=null)},{default:n(()=>c[19]||(c[19]=[t("a",{class:"!no-underline text-base"},"Data Sources",-1)])),_:1,__:[19]}),e(q)?(a(),E(xe,{key:0},{default:n(()=>[t("span",xi,m(e(q).alias||"Default Source"),1)]),_:1})):A("",!0)]),_:1}),s(le,{size:"small",type:"text",class:"nc-close-btn",onClick:c[3]||(c[3]=Z=>ne.value=!1)},{default:n(()=>[s(F,{icon:"close",class:"text-gray-600"})]),_:1})]),s(ge,{"active-key":e(x),"onUpdate:activeKey":c[7]||(c[7]=Z=>ie(x)?x.value=Z:null),class:"nc-source-tab w-full h-[calc(100%_-_58px)] max-h-[calc(100%_-_58px)]"},{default:n(()=>[!e(q).is_meta&&!e(q).is_local?(a(),E(Se,{key:"edit"},{tab:n(()=>[t("div",wi,[t("div",null,m(U.$t("labels.connectionDetails")),1)])]),default:n(()=>[t("div",ki,[s(ze,{"source-id":e(q).id,onSourceUpdated:c[4]||(c[4]=Z=>R(!0)),onClose:c[5]||(c[5]=Z=>q.value=null)},null,8,["source-id"])])]),_:1})):A("",!0),s(Se,{key:"erd"},{tab:n(()=>[t("div",$i,[t("div",null,m(U.$t("title.erdView")),1)])]),default:n(()=>[t("div",Si,[s(Ue,{class:"h-full overflow-auto","base-id":e(i).id,"source-id":e(q).id,"show-all-columns":!1},null,8,["base-id","source-id"])])]),_:1}),s(Se,{key:"acl"},{tab:n(()=>[t("div",Ci,[t("div",null,m(U.$t("labels.viewHide")),1)])]),default:n(()=>[t("div",Ii,[s(Pe,{"source-id":e(q).id},null,8,["source-id"])])]),_:1}),!e(q).is_meta&&!e(q).is_local?(a(),E(Se,{key:"meta-sync"},{tab:n(()=>[t("div",Di,[t("div",null,m(U.$t("labels.metaSync")),1)])]),default:n(()=>[t("div",Ti,[s(Re,{"source-id":e(q).id,onSourceSynced:c[6]||(c[6]=Z=>R(!0))},null,8,["source-id"])])]),_:1})):A("",!0)]),_:1},8,["active-key"])])):A("",!0)]),_:1},8,["visible"]),t("div",{class:ue(["flex flex-col w-full",{"overflow-auto":!e(H)}])},[e(H)?(a(),E(ye,{key:0,open:e(H),"onUpdate:open":c[10]||(c[10]=Z=>ie(H)?H.value=Z:null),"connection-type":e(L),"is-modal":"",onSourceCreated:c[11]||(c[11]=Z=>R(!0))},null,8,["open","connection-type"])):(a(),P("div",Mi,[t("div",Oi,[t("div",Pi,[t("div",Ni,m(U.$t("general.visibility")),1),t("div",ji,m(U.$t("general.name")),1),t("div",Ei,m(U.$t("general.connection"))+" "+m(U.$t("general.name")),1),t("div",Bi,m(U.$t("general.type")),1),t("div",Ai,m(U.$t("labels.actions")),1)])]),t("div",Ui,[s(e(Ra),{list:e(v),"item-key":"id",handle:".ds-table-handle",onEnd:oe},hs({item:n(({element:Z,index:Ne})=>{var je,De;return[Ne!==0?(a(),P("div",{key:0,class:ue(["ds-table-row border-gray-200 cursor-pointer",{"!hidden":!((De=(je=Z==null?void 0:Z.alias)==null?void 0:je.toLowerCase())!=null&&De.includes(e(S).toLowerCase()))}]),onClick:Te=>se(Z,"edit")},[t("div",Wi,[t("div",{class:"flex items-center gap-1",onClick:c[16]||(c[16]=He(()=>{},["stop"]))},[e(v).length>2?(a(),E(F,{key:0,icon:"dragVertical",small:"",class:"ds-table-handle"})):A("",!0),s(tt,null,{title:n(()=>[Z.enabled?(a(),P(_e,{key:0},[G(m(U.$t("activity.hideInUI")),1)],64)):(a(),P(_e,{key:1},[G(m(U.$t("activity.showInUI")),1)],64))]),default:n(()=>[s(ft,{checked:!!Z.enabled,class:"cursor-pointer",size:"small",onChange:Te=>C(Z,Te)},null,8,["checked","onChange"])]),_:2},1024)])]),t("div",Ki,[Z.is_meta||Z.is_local?(a(),P("div",qi,"-")):(a(),E(tt,{key:1,class:"truncate","show-on-truncate-only":""},{title:n(()=>[G(m(Z.is_meta||Z.is_local?U.$t("general.base"):Z.alias),1)]),default:n(()=>[G(" "+m(Z.is_meta||Z.is_local?U.$t("general.base"):Z.alias),1)]),_:2},1024))]),t("div",Yi,[s(tt,{class:"truncate","show-on-truncate-only":""},{title:n(()=>[G(m((Z==null?void 0:Z.integration_title)||"-"),1)]),default:n(()=>[G(" "+m((Z==null?void 0:Z.integration_title)||"-"),1)]),_:2},1024)]),t("div",Hi,[s(Q,{rounded:"lg",class:"flex items-center gap-2 px-0 py-1 !h-7 truncate !border-transparent"},{default:n(()=>[s(st,{"source-type":Z.type,class:"flex-none !w-4 !h-4"},null,8,["source-type"]),s(tt,{placement:"bottom","show-on-truncate-only":"",class:"text-sm truncate"},{title:n(()=>{var Te;return[G(m(((Te=("clientTypesMap"in U?U.clientTypesMap:e(cs))[Z.type])==null?void 0:Te.text)||Z.type),1)]}),default:n(()=>{var Te;return[G(" "+m(Z.type&&("clientTypesMap"in U?U.clientTypesMap:e(cs))[Z.type]?(Te=("clientTypesMap"in U?U.clientTypesMap:e(cs))[Z.type])==null?void 0:Te.text:Z.type),1)]}),_:2},1024)]),_:2},1024)]),t("div",{class:"ds-table-col justify-end gap-x-1 ds-table-actions",onClick:c[17]||(c[17]=He(()=>{},["stop"]))},[t("div",Qi,[!Z.is_meta&&!Z.is_local?(a(),E(W,{key:0,placement:"bottomRight"},{overlay:n(()=>[s(be,{variant:"small"},{default:n(()=>[s(ae,{onClick:Te=>se(Z,"edit")},{default:n(()=>[s(F,{icon:"edit"}),t("span",null,m(U.$t("general.edit")),1)]),_:2},1032,["onClick"]),s(de),s(ae,{danger:"",onClick:He(Te=>K(Z),["stop"])},{default:n(()=>[s(F,{icon:"delete"}),G(" "+m(U.$t("general.remove")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:n(()=>[s(le,{size:"small",type:"secondary"},{default:n(()=>[s(F,{icon:"threeDotVertical"})]),_:1})]),_:2},1024)):A("",!0)])])],10,Gi)):A("",!0)]}),_:2},["default".includes(e(S).toLowerCase())?{name:"header",fn:n(()=>[e(v)[0]?(a(),P("div",{key:0,class:"ds-table-row border-gray-200 cursor-pointer",onClick:c[15]||(c[15]=Z=>se(e(v)[0],"erd"))},[t("div",Ri,[t("div",{class:"flex items-center gap-1",onClick:c[13]||(c[13]=He(()=>{},["stop"]))},[e(v).length>2?(a(),P("div",Li)):A("",!0),s(tt,null,{title:n(()=>[e(v)[0].enabled?(a(),P(_e,{key:0},[G(m(U.$t("activity.hideInUI")),1)],64)):(a(),P(_e,{key:1},[G(m(U.$t("activity.showInUI")),1)],64))]),default:n(()=>[s(ft,{checked:!!e(v)[0].enabled,class:"cursor-pointer",size:"small",onChange:c[12]||(c[12]=Z=>C(e(v)[0],Z))},null,8,["checked"])]),_:1})])]),t("div",Fi,[t("div",zi,m(U.$t("general.default")),1)]),c[20]||(c[20]=t("div",{class:"ds-table-col ds-table-integration-name"},[t("div",{class:"flex items-center gap-1"},"-")],-1)),c[21]||(c[21]=t("div",{class:"ds-table-col ds-table-type"},[t("div",{class:"flex items-center gap-1"},"-")],-1)),t("div",Vi,[!e(v)[0].is_meta&&!e(v)[0].is_local?(a(),E(le,{key:0,size:"small",class:"nc-action-btn nc-edit-base cursor-pointer outline-0 !w-8 !px-1 !rounded-lg",type:"text",onClick:c[14]||(c[14]=He(Z=>_(e(v)[0].id,("DataSourcesSubTab"in U?U.DataSourcesSubTab:e(lt)).Edit),["stop"]))},{default:n(()=>[s(F,{icon:"edit",class:"text-gray-600"})]),_:1})):A("",!0)])])):A("",!0)]),key:"0"}:void 0]),1032,["list"]),!e(h)&&((fe=e(v))!=null&&fe.length)&&!O()?(a(),P("div",Ji,[t("div",Zi,[c[22]||(c[22]=t("img",{src:ds,class:"!w-[164px] flex-none",alt:"No search results found"},null,-1)),G(" "+m(U.$t("title.noResultsMatchedYourSearch")),1)])])):A("",!0)]),Je(t("div",Xi,[t("div",ec,[s(z,{size:"xlarge"}),t("span",tc,m(U.$t("general.loading")),1)])],512),[[Gt,e(h)]])])),s(ce,{visible:e(j),"onUpdate:visible":c[18]||(c[18]=Z=>ie(j)?j.value=Z:null),"entity-name":U.$t("general.datasource"),"on-delete":te,"delete-label":U.$t("general.remove")},{"entity-preview":n(()=>[e(T)?(a(),P("div",sc,[s(st,{"source-type":e(T).type},null,8,["source-type"]),t("div",nc,m(e(T).alias),1)])):A("",!0)]),_:1},8,["visible","entity-name","delete-label"])],2)],4)])}}}),oc=Object.assign(ke(ac,[["__scopeId","data-v-dd23951d"]]),{__name:"DashboardSettingsDataSources"}),dt=ca(),lc={title:"New Source",sync_type:Hs.Full,sync_trigger:Wt.Manual,sync_category:ia.TICKETING,exclude_models:[],on_delete_action:la.MarkDeleted,sync_trigger_cron:null},Mt={type:us.Sync,sub_type:null,config:{}},[pn,ic]=La((I,o)=>{const b=V(lc),y=V(),r=V(!1),k=V("sync"),D=V(!1),$=V(!1),f=V(!1),w=V(null),{validate:N,validateInfos:u}=_t.useForm(b,V({title:[pt()],sync_type:[pt()],sync_trigger:[pt()]})),i=V([dt(Mt)]),d=V({}),p=V(0),l=V(),{getIntegrationForm:M}=Rt(),{$api:g}=Ae(),{formState:v,isLoading:B,validate:L,clearValidate:h,validateInfos:j}=ja({formSchema:l,fetchOptions:async c=>{const F=e(I),J=e(o);return!c||!F||!J?[]:await g.internal.postOperation(F,J,{operation:"syncIntegrationFetchOptions"},{integration:v.value,key:c})}}),T=c=>Ea(v,c),S=async c=>{if(!c){l.value=void 0;return}const F=d.value[c]||await M(us.Sync,c);l.value=[...F],v.value.type=us.Sync,v.value.sub_type=c,v.value.config||(v.value.config={}),v.value.config.sync||(v.value.config.sync={}),v.value.config.sync.sync_trigger||(v.value.config.sync.sync_trigger=Wt.Manual)},Y=c=>{i.value[c]&&(i.value[c]=dt(Mt),i.value.splice(c,1)),i.value.length===0&&i.value.push(dt(Mt))},R=async()=>{if(i.value[p.value]!==void 0){try{await L()}catch{return!1}return i.value[p.value]=dt(v.value),!0}},_=async c=>{if(i.value[c]){if(D.value&&i.value[c].id&&!i.value[c].config){const F=await g.integration.read(i.value[c].id,{includeConfig:!0});i.value[c].config=F.config}i.value[c]&&(await S(i.value[c].sub_type),v.value=dt(i.value[c])),it(()=>{h(),p.value=c})}},K=async()=>{await R()&&(i.value.push(dt(Mt)),await _(i.value.length-1),D.value&&($.value=!0,f.value=!0))},te=async c=>{Y(c);const F=i.value.length-1;await _(F)},C=async c=>{await R(),await _(c)},oe=()=>{i.value=[dt(Mt)],l.value=void 0,_(0)},H=X(()=>cn.filter(c=>c.type===ks.SYNC&&(!T("sync_category")||c.sync_category===T("sync_category"))));return{syncConfigForm:b,syncConfigEditForm:y,syncConfigEditFormChanged:r,validateSyncConfig:N,validateInfosSyncConfig:u,integrationConfigs:i,selectedIntegrationIndex:p,formState:v,activeIntegrationItemForm:l,isLoading:B,availableIntegrations:H,addIntegrationConfig:K,removeIntegrationConfig:te,switchToIntegrationConfig:C,loadConfig:_,changeIntegration:S,resetStore:oe,deepReference:T,saveCurrentFormState:R,validateInfos:j,editMode:D,editModeSync:w,editModeModified:f,editModeAddIntegration:$,readSync:async c=>{const F=e(I),J=e(o);if(!(!c||!F||!J))return await g.internal.getOperation(F,J,{operation:"readSync",id:c})},createSync:async()=>{const c=e(I),F=e(o);return!c||!F?void 0:await g.internal.postOperation(c,F,{operation:"createSync"},{title:b.value.title,sync_type:b.value.sync_type,sync_trigger:b.value.sync_trigger,sync_trigger_cron:b.value.sync_trigger_cron,on_delete_action:b.value.on_delete_action,sync_category:b.value.sync_category,exclude_models:b.value.exclude_models,configs:i.value})},updateSync:async()=>{var xe,Ie;const c=e(I),F=e(o);if(!c||!F||!y.value)return;try{await L()}catch{return}const{syncConfig:J,integration:le}=await g.internal.postOperation(c,F,{operation:"updateSync"},{syncConfigId:k.value==="sync-settings"?(xe=y.value)==null?void 0:xe.id:v.value.syncConfigId,...k.value==="sync-settings"?y.value:{},...k.value==="integrations"?{syncConfigId:v.value.syncConfigId??((Ie=y.value)==null?void 0:Ie.id),config:v.value}:{}});le&&i.value[p.value]&&(v.value.syncConfigId=J.id,v.value.parentSyncConfigId=J.fk_parent_sync_config_id,Object.assign(v.value,le),Object.assign(i.value[p.value],v.value)),v.value.syncConfigId===J.id&&(w.value=J),r.value=!1,f.value=!1,await _(p.value)},triggerSync:async(c,F)=>{const J=e(I),le=e(o);return!J||!le||!c?void 0:await g.internal.postOperation(J,le,{operation:"triggerSync"},{syncConfigId:c,bulk:!!F})},deleteSync:async c=>{const F=e(I),J=e(o);!F||!J||!c||(await g.internal.postOperation(F,J,{operation:"deleteSync"},{syncConfigId:c}),await te(p.value))},editTab:k,integrationFetchDestinationSchema:async c=>{const F=e(I),J=e(o);if(!(!F||!J||!c))return await g.internal.postOperation(F,J,{operation:"syncIntegrationFetchDestinationSchema"},{integration:c})}}},"use-sync-store");function $t(){const I=ic();if(I==null)throw new Error("Please call `useSyncStore` on the appropriate parent component");return I}const cc=re({__name:"Steps",props:{current:{}},setup(I){const{syncConfigForm:o}=$t();return(b,y)=>{const r=Vt,k=oo;return a(),E(k,{class:"pointer-events-none",current:b.current,size:"small"},{default:n(()=>[s(r,{title:"Sync Category"}),s(r,{title:"Sync Settings"}),s(r,{title:"Sources"}),e(o).sync_category==="custom"?(a(),E(r,{key:0,title:"Destination Schema"})):A("",!0),s(r,{title:"Review"})]),_:1},8,["current"])}}}),rc=Object.assign(cc,{__name:"DashboardSettingsSyncSteps"}),dc={class:"w-full flex flex-wrap gap-4 overflow-y-auto"},uc=re({__name:"CategorySelect",props:{modelValue:{}},emits:["update:modelValue","change"],setup(I,{emit:o}){const b=I,y=o,r=Object.values(ra),k=Ge(b,"modelValue",y),D=$=>{k.value=$,y("change",$)};return($,f)=>{const w=$e,N=gs;return a(),P("div",dc,[(a(!0),P(_e,null,Be(e(r),u=>(a(),E(N,{key:u.value,type:"info",message:u.label,description:u.description,"show-icon":"",class:ue(["cursor-pointer hover:!bg-gray-50",{"!border-primary":e(k)===u.value}]),onClick:i=>D(u.value)},{icon:n(()=>[s(w,{icon:u.icon,class:"text-primary mt-1"},null,8,["icon"])]),_:2},1032,["message","description","class","onClick"]))),128))])}}}),pc=Object.assign(uc,{__name:"DashboardSettingsSyncCategorySelect"}),_c={class:"flex items-center mb-4 border-b border-gray-200 flex-wrap"},mc=["onClick"],vc={key:1,class:"h-5 w-5 flex items-center justify-center bg-gray-100 rounded-full"},fc=re({__name:"IntegrationTabs",setup(I){const{formState:o,syncConfigForm:b,integrationConfigs:y,selectedIntegrationIndex:r,addIntegrationConfig:k,removeIntegrationConfig:D,switchToIntegrationConfig:$,editModeModified:f,editMode:w}=$t(),N=X(()=>y.value.map((u,i)=>i===r.value?o.value:u));return(u,i)=>{const d=Is,p=$e,l=Qs;return a(),P("div",_c,[(a(!0),P(_e,null,Be(e(N),(M,g)=>(a(),P("div",{key:g,class:ue(["px-4 py-2 cursor-pointer flex items-center gap-2",{"border-b-2 border-primary text-primary":e(r)===g,"text-gray-500":e(r)!==g}]),onClick:v=>e($)(g)},[M.sub_type?(a(),E(d,{key:0,type:M.sub_type,class:"h-5 w-5"},null,8,["type"])):(a(),P("span",vc,m(g+1),1)),t("span",null,m((M==null?void 0:M.title)||(M==null?void 0:M.sub_type)||"New Source"),1),e(y).length>1&&!e(w)?(a(),E(l,{key:2,type:"text",size:"small",class:"!p-0 !min-w-0 !h-auto text-gray-400 hover:text-red-500",onClick:He(v=>e(D)(g),["stop"])},{default:n(()=>[s(p,{icon:"close",class:"h-3 w-3"})]),_:2},1032,["onClick"])):A("",!0)],10,mc))),128)),(!e(w)||!e(f))&&e(b).sync_category!=="custom"?(a(),E(l,{key:0,type:"text",class:"ml-2 flex items-center",onClick:e(k)},{default:n(()=>[s(p,{icon:"plus",class:"h-3 w-3 mr-1"}),i[0]||(i[0]=G(" Add Source "))]),_:1,__:[0]},8,["onClick"])):A("",!0)])}}}),_n=Object.assign(fc,{__name:"DashboardSettingsSyncIntegrationTabs"}),bc={class:"w-full flex gap-2 items-center"},yc=re({__name:"Select",props:{value:{},category:{}},emits:["update:value","change"],setup(I,{emit:o}){const b=I,y=o,r=X({get:()=>b.value,set:f=>y("update:value",f)}),{integrationsRefreshKey:k}=Rt(),D=X(()=>(k.value,cn.filter(f=>f.type===ks.SYNC&&(!b.category||f.sync_category===b.category)))),$=f=>{y("change",f)};return(f,w)=>{const N=Is,u=Ze,i=ys,d=Ws;return a(),E(d,{value:e(r),class:"nc-select-shadow","dropdown-class-name":"nc-dropdown-sync-type",placeholder:"Select Source",onChange:$},{default:n(()=>[(a(!0),P(_e,null,Be(e(D),p=>(a(),E(i,{key:`${p.sub_type}`,value:p.sub_type},{default:n(()=>[t("div",bc,[p!=null&&p.sub_type?(a(),E(N,{key:0,type:p.sub_type},null,8,["type"])):A("",!0),s(u,{class:"flex-1 truncate"},{title:n(()=>[G(m(p.title),1)]),default:n(()=>[G(" "+m(p.title),1)]),_:2},1024),e(r)===p.sub_type?(a(),E(gt(e(jt).check),{key:1,id:"nc-selected-item-icon",class:"text-primary w-4 h-4"})):A("",!0)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])}}}),gc=Object.assign(ke(yc,[["__scopeId","data-v-cfdf71b5"]]),{__name:"DashboardSettingsSyncSelect"}),hc={key:2,class:"flex justify-between"},xc=re({__name:"IntegrationConfig",setup(I){const{formState:o,syncConfigForm:b,selectedIntegrationIndex:y,deleteSync:r,changeIntegration:k,editMode:D,editModeModified:$,editModeAddIntegration:f,updateSync:w}=$t(),{t:N}=ct(),u=async()=>{Ls.confirm({title:"Do you want to delete this integration?",type:"warning",onOk:async()=>{try{await r(o.value.syncConfigId)}catch(i){pe.error(`${N("msg.error.deleteFailed")}: ${await Fe(i)}`)}}})};return(i,d)=>{const p=gc,l=mt,M=Xt,g=Zt,v=Ba,B=Ke,L=Ze;return a(),P("div",null,[!e(D)||e(f)?(a(),E(g,{key:0,gutter:24,class:ue({"mb-4":e(D)})},{default:n(()=>[s(M,{span:24},{default:n(()=>[s(l,{label:"Select Source",class:"w-full"},{default:n(()=>[s(p,{value:e(o).sub_type,category:e(b).sync_category,onChange:e(k)},null,8,["value","category","onChange"])]),_:1})]),_:1})]),_:1},8,["class"])):A("",!0),e(o).sub_type?(a(),E(v,{key:`${e(y)}-${e(o).sub_type}`,class:"pt-4",onChange:d[0]||(d[0]=h=>$.value=!0)})):A("",!0),e(D)?(a(),P("div",hc,[e(o).parentSyncConfigId?(a(),E(B,{key:1,class:"!px-4",type:"danger",size:"small",onClick:u},{default:n(()=>d[3]||(d[3]=[G(" Delete Integration ")])),_:1,__:[3]})):(a(),E(L,{key:0,placement:"top"},{title:n(()=>d[1]||(d[1]=[G(" You can't delete first integration ")])),default:n(()=>[s(B,{class:"!px-4",type:"danger",size:"small",disabled:""},{default:n(()=>d[2]||(d[2]=[G(" Delete Integration ")])),_:1,__:[2]})]),_:1})),s(B,{class:"!px-4",type:"primary",size:"small",disabled:!e($),onClick:e(w)},{default:n(()=>d[4]||(d[4]=[G(" Update Integration ")])),_:1,__:[4]},8,["disabled","onClick"])])):A("",!0)])}}}),mn=Object.assign(xc,{__name:"DashboardSettingsSyncIntegrationConfig"}),wc={key:0,class:"flex justify-end"},kc={key:1,class:"mt-4"},$c={class:"flex items-start mb-4"},Sc={class:"flex items-start"},Cc={key:0,class:"border rounded-lg px-1 py-2"},Ic={class:"flex justify-center flex-col ml-2"},Dc={class:"flex items-center"},Tc={class:"flex-none mr-2"},Mc={class:"!text-black"},Oc={class:"text-gray-500 text-xs"},Pc=re({__name:"Settings",setup(I){const{syncConfigForm:o,validateInfosSyncConfig:b,updateSync:y,syncConfigEditForm:r,syncConfigEditFormChanged:k,editMode:D}=$t(),$=Object.values(Zs),f=Object.values(Xs),w=Object.values(en),N=V(!0),u=X(()=>Object.values(Js).filter(p=>p.category===o.value.sync_category||!o.value.sync_category)),i=p=>{o.value.exclude_models.includes(p)?o.value.exclude_models=o.value.exclude_models.filter(l=>l!==p):o.value.exclude_models.push(p)},d=X(()=>D.value?r.value:o.value);return(p,l)=>{const M=vt,g=mt,v=Xt,B=Zt,L=bs,h=Ke,j=Ga,T=Va,S=$e,Y=fs;return e(d)?(a(),P(_e,{key:0},[s(B,{gutter:24},{default:n(()=>[s(v,{span:24},{default:n(()=>[s(g,qe({label:"Sync Title"},e(b).title,{"hide-required-mark":""}),{default:n(()=>[s(M,{value:e(d).title,"onUpdate:value":l[0]||(l[0]=R=>e(d).title=R),onChange:l[1]||(l[1]=R=>k.value=!0)},null,8,["value"])]),_:1},16)]),_:1})]),_:1}),s(B,{gutter:24},{default:n(()=>[s(v,{span:12},{default:n(()=>[s(g,qe({label:"Sync Type"},e(b).sync_type,{"hide-required-mark":""}),{default:n(()=>[s(L,{value:e(d).sync_type,"onUpdate:value":l[2]||(l[2]=R=>e(d).sync_type=R),options:e($),onChange:l[3]||(l[3]=R=>k.value=!0)},null,8,["value","options"])]),_:1},16)]),_:1}),s(v,{span:12},{default:n(()=>[s(g,qe({label:"Sync Trigger"},e(b).sync_trigger,{"hide-required-mark":""}),{default:n(()=>[s(L,{value:e(d).sync_trigger,"onUpdate:value":l[4]||(l[4]=R=>e(d).sync_trigger=R),options:e(f),onChange:l[5]||(l[5]=R=>k.value=!0)},null,8,["value","options"])]),_:1},16)]),_:1})]),_:1}),s(B,{gutter:24},{default:n(()=>[s(v,{span:12},{default:n(()=>[s(g,qe({label:"On Delete Action"},e(b).on_delete_action,{"hide-required-mark":""}),{default:n(()=>[s(L,{value:e(d).on_delete_action,"onUpdate:value":l[6]||(l[6]=R=>e(d).on_delete_action=R),options:e(w),onChange:l[7]||(l[7]=R=>k.value=!0)},null,8,["value","options"])]),_:1},16)]),_:1})]),_:1}),e(D)?(a(),P("div",wc,[s(h,{class:"!px-4",type:"primary",size:"small",disabled:!e(k),onClick:e(y)},{default:n(()=>l[10]||(l[10]=[G(" Update Sync Settings ")])),_:1,__:[10]},8,["disabled","onClick"])])):A("",!0),e(o).sync_category!=="custom"&&!e(D)?(a(),P("div",kc,[s(T,{value:e(N),"onUpdate:value":l[8]||(l[8]=R=>ie(N)?N.value=R:null),class:"w-full",onChange:l[9]||(l[9]=R=>k.value=!0)},{default:n(()=>[t("div",$c,[s(j,{value:!0,class:"!mt-0.5"},{default:n(()=>l[11]||(l[11]=[t("div",{class:"ml-2"},[t("div",{class:"text-base"},"Sync all available models"),t("div",{class:"text-gray-500 text-xs mt-1"}," All models for the category will be synced. This may take longer and use more resources. ")],-1)])),_:1,__:[11]})]),t("div",Sc,[s(j,{value:!1,class:"!mt-0.5"},{default:n(()=>l[12]||(l[12]=[t("div",{class:"ml-2"},[t("div",{class:"text-base"},"Select specific models")],-1)])),_:1,__:[12]})])]),_:1},8,["value"]),e(N)?A("",!0):(a(),P("div",Cc,[(a(!0),P(_e,null,Be(e(u),R=>{var _;return a(),P("div",{key:R.value,class:"flex items-start px-3"},[s(Y,{value:R.value,checked:!((_=e(d).exclude_models)!=null&&_.includes(R.value)),disabled:R.required,onChange:K=>i(R.value)},{default:n(()=>[t("div",Ic,[t("div",Dc,[t("div",Tc,[s(S,{icon:R.icon,class:"text-primary"},null,8,["icon"])]),t("div",Mc,m(R.label),1)]),t("div",Oc,m(R.description),1)])]),_:2},1032,["value","checked","disabled","onChange"])])}),128))]))])):A("",!0)],64)):A("",!0)}}}),vn=Object.assign(Pc,{__name:"DashboardSettingsSyncSettings"}),Nc={class:"column-mapping-container"},jc={class:"table-selector"},Ec={class:"tabs-container"},Bc={class:"tabs"},Ac=["onClick"],Uc={key:0,class:"column-mapping"},Rc={class:"table-header"},Lc={class:"select-all"},Fc={class:"table-container"},zc={class:"column-table"},Vc={class:"center-column"},Gc={class:"center-column"},Wc={class:"center-column"},Kc={key:1,class:"no-table"},qc=re({__name:"DestinationSchema",setup(I){const{formState:o,integrationFetchDestinationSchema:b}=$t();o.value.config.custom_schema||(o.value.config.custom_schema={});const y=X(()=>o.value.config.custom_schema),r=V(""),k=X(()=>Object.keys(y.value)),D={string:[Ce.SingleLineText,Ce.LongText,Ce.Email,Ce.URL,Ce.PhoneNumber,Ce.SingleSelect,Ce.MultiSelect],number:[Ce.Number,Ce.Decimal,Ce.Rating,Ce.Percent],boolean:[Ce.Checkbox],date:[Ce.Date],datetime:[Ce.DateTime],json:[Ce.JSON],jsonb:[Ce.JSON],decimal:[Ce.Decimal,Ce.Number]},$=X(()=>{var j;const h=y.value[r.value];return((j=h==null?void 0:h.columns)==null?void 0:j.every(T=>!T.exclude))??!1}),f=()=>{k.value.length>0&&!r.value&&(r.value=k.value[0]||"")},w=h=>{const j=Object.keys(D).find(T=>h.includes(T));return j&&D[j]?D[j]:[Ce.SingleLineText,Ce.LongText]},N=h=>w(h.abstractType).map(T=>({text:T,value:T})),u=h=>{o.value.config.custom_schema=h},i=h=>{var T;const j=y.value[r.value];return(T=j==null?void 0:j.systemFields)!=null&&T.primaryKey?j.systemFields.primaryKey.includes(h):!1},d=()=>{var j;const h=y.value[r.value];return(j=h==null?void 0:h.systemFields)!=null&&j.primaryKey?h.systemFields.primaryKey.length:0},p=h=>{if(!y.value[r.value])return;const T={...y.value},S=T[r.value];S&&S.columns&&S.columns.forEach(Y=>{i(Y.title)||(Y.exclude=!h)}),u(T)},l=(h,j,T)=>{const S=y.value[r.value];if(!S||!S.columns||!S.columns[h])return;const Y=S.columns[h];if(j==="exclude"&&T===!0&&i(Y.title))return;const R={...y.value},_=R[r.value];_&&_.columns&&_.columns[h]&&(_.columns[h][j]=T),u(R)},M=(h,j)=>{if(!y.value[r.value]||!j&&i(h)&&d()===1)return;const S={...y.value},Y=S[r.value];if(Y){if(Y.systemFields||(Y.systemFields={primaryKey:[]}),j){if(!Y.systemFields.primaryKey.includes(h)){Y.systemFields.primaryKey.push(h);const R=Y.columns.findIndex(_=>_.title===h);R!==-1&&Y.columns[R]&&(Y.columns[R].exclude=!1)}}else Y.systemFields.primaryKey=Y.systemFields.primaryKey.filter(R=>R!==h);u(S)}},g=h=>{if(!y.value[r.value])return;const T={...y.value},S=T[r.value];S&&(S.systemFields||(S.systemFields={primaryKey:[]}),S.systemFields.createdAt===h?S.systemFields.createdAt=void 0:S.systemFields.createdAt=h,u(T))},v=h=>{if(!y.value[r.value])return;const T={...y.value},S=T[r.value];S&&(S.systemFields||(S.systemFields={primaryKey:[]}),S.systemFields.updatedAt===h?S.systemFields.updatedAt=void 0:S.systemFields.updatedAt=h,u(T))},B=X(()=>{var j;const h=y.value[r.value];return(j=h==null?void 0:h.systemFields)==null?void 0:j.createdAt}),L=X(()=>{var j;const h=y.value[r.value];return(j=h==null?void 0:h.systemFields)==null?void 0:j.updatedAt});return We(async()=>{if(y.value&&Object.keys(y.value).length>0){const T=o.value.config.tables||[];if(Object.keys(y.value).every(S=>T.includes(S))){f();return}}const h=await b(o.value);o.value.config.custom_schema=h;const j={...y.value};Object.keys(j).forEach(T=>{const S=j[T];if(S&&S.columns){if(S.relations||(S.relations=[]),S.systemFields||(S.systemFields={primaryKey:[]}),S.columns.forEach(Y=>{Y.exclude=!!Y.exclude}),S.systemFields.primaryKey.length===0&&S.columns.length>0){const Y=S.columns[0];Y&&(S.systemFields.primaryKey=[Y.title])}S.systemFields.primaryKey.forEach(Y=>{const R=S.columns.find(_=>_.title===Y);R&&(R.exclude=!1)})}}),u(j),f()}),(h,j)=>{var R;const T=fs,S=bs,Y=Qs;return a(),P("div",Nc,[t("div",jc,[j[0]||(j[0]=t("div",{class:"header"},[t("h2",null,"Map Table Columns"),t("p",null,"Review and configure the columns for each selected table")],-1)),t("div",Ec,[t("div",Bc,[(a(!0),P(_e,null,Be(e(k),_=>(a(),P("button",{key:_,class:ue(["tab-button",{active:e(r)===_}]),onClick:K=>r.value=_},m(_),11,Ac))),128))])])]),e(r)&&e(y)[e(r)]?(a(),P("div",Uc,[t("div",Rc,[t("h3",null,"Table: "+m(e(r)),1),t("div",Lc,[s(T,{checked:e($),"onUpdate:checked":p},{default:n(()=>j[1]||(j[1]=[G("Select All Columns")])),_:1,__:[1]},8,["checked"])])]),t("div",Fc,[t("table",zc,[j[4]||(j[4]=t("thead",null,[t("tr",null,[t("th",null,"Include"),t("th",null,"Column Name"),t("th",null,"Original Type"),t("th",null,"Target Type"),t("th",null,"Unique ID"),t("th",null,"Created At"),t("th",null,"Updated At")])],-1)),t("tbody",null,[(a(!0),P(_e,null,Be(((R=e(y)[e(r)])==null?void 0:R.columns)||[],(_,K)=>(a(),P("tr",{key:_.title},[t("td",null,[s(T,{checked:!_.exclude||i(_.title),disabled:i(_.title),"onUpdate:checked":te=>l(K,"exclude",!te)},null,8,["checked","disabled","onUpdate:checked"])]),t("td",null,m(_.title),1),t("td",null,m(_.abstractType),1),t("td",null,[s(S,{value:_.uidt,"onUpdate:value":[te=>_.uidt=te,te=>l(K,"uidt",te)],options:N(_),style:{width:"100%"}},null,8,["value","onUpdate:value","options"])]),t("td",Vc,[s(T,{checked:i(_.title),"onUpdate:checked":te=>M(_.title,te)},null,8,["checked","onUpdate:checked"])]),t("td",Gc,[s(Y,{type:"text",size:"small",class:ue(["radio-button",{selected:e(B)===_.title}]),onClick:te=>g(_.title)},{default:n(()=>j[2]||(j[2]=[t("div",{class:"custom-radio-circle"},null,-1)])),_:2,__:[2]},1032,["class","onClick"])]),t("td",Wc,[s(Y,{type:"text",size:"small",class:ue(["radio-button",{selected:e(L)===_.title}]),onClick:te=>v(_.title)},{default:n(()=>j[3]||(j[3]=[t("div",{class:"custom-radio-circle"},null,-1)])),_:2,__:[3]},1032,["class","onClick"])])]))),128))])])])])):(a(),P("div",Kc,j[5]||(j[5]=[t("p",null,"No tables available for mapping",-1)])))])}}}),Yc=Object.assign(ke(qc,[["__scopeId","data-v-d5c40602"]]),{__name:"DashboardSettingsSyncDestinationSchema"}),Hc={class:"review-container"},Qc={class:"section"},Jc={class:"section-title"},Zc={class:"grid grid-cols-2 gap-4"},Xc={class:"info-item"},er={class:"info-value"},tr={class:"info-item"},sr={class:"info-value"},nr={class:"info-item"},ar={class:"info-value"},or={class:"info-item"},lr={class:"info-value"},ir={class:"section"},cr={class:"section-title"},rr={class:"text-xs text-gray-500 ml-auto"},dr={class:"model-list"},ur={key:0,class:"flex items-center py-2"},pr={key:1,class:"grid grid-cols-2 gap-2"},_r=re({__name:"Review",setup(I){const{syncConfigForm:o}=$t(),b=X(()=>{var w;const f=o.value.sync_type;return((w=Zs[f])==null?void 0:w.label)||f}),y=X(()=>{var w;const f=o.value.sync_trigger;return((w=Xs[f])==null?void 0:w.label)||f}),r=X(()=>{var w;const f=o.value.on_delete_action;return((w=en[f])==null?void 0:w.label)||f}),k=X(()=>Object.values(Js).filter(f=>f.category===o.value.sync_category||!o.value.sync_category)),D=X(()=>o.value.exclude_models.length===0),$=X(()=>D.value?k.value:k.value.filter(f=>!o.value.exclude_models.includes(f.value)));return(f,w)=>{const N=$e,u=da;return a(),P("div",Hc,[t("div",Qc,[t("div",Jc,[s(N,{icon:"settings",class:"text-primary mr-2"}),w[0]||(w[0]=t("h3",null,"Sync Configuration",-1))]),s(u,{class:"mb-4 !rounded-lg"},{default:n(()=>[t("div",Zc,[t("div",Xc,[w[1]||(w[1]=t("div",{class:"info-label"},"Title",-1)),t("div",er,m(e(o).title),1)]),t("div",tr,[w[2]||(w[2]=t("div",{class:"info-label"},"Sync Type",-1)),t("div",sr,[s(N,{icon:"refresh",class:"text-primary mr-2"}),G(" "+m(e(b)),1)])]),t("div",nr,[w[3]||(w[3]=t("div",{class:"info-label"},"Sync Trigger",-1)),t("div",ar,[s(N,{icon:"clock",class:"text-primary mr-2"}),G(" "+m(e(y)),1)])]),t("div",or,[w[4]||(w[4]=t("div",{class:"info-label"},"On Delete Action",-1)),t("div",lr,[s(N,{icon:"delete",class:"text-primary mr-2"}),G(" "+m(e(r)),1)])])])]),_:1})]),t("div",ir,[t("div",cr,[s(N,{icon:"table",class:"text-primary mr-2"}),w[5]||(w[5]=t("h3",null,"Models to Sync",-1)),t("div",rr,m(e(D)?"All models will be synced":`${e($).length} of ${e(k).length} models selected`),1)]),s(u,{class:"mb-4 !rounded-lg"},{default:n(()=>[t("div",dr,[e(D)?(a(),P("div",ur,[s(N,{icon:"check",class:"text-green-600 mr-2"}),w[6]||(w[6]=t("span",{class:"text-sm"},"All available models will be synced",-1))])):(a(),P("div",pr,[(a(!0),P(_e,null,Be(e($),i=>(a(),P("div",{key:i.value,class:"model-item"},[s(N,{icon:i.icon,class:"text-primary mr-2"},null,8,["icon"]),t("span",null,m(i.label),1)]))),128))]))])]),_:1})])])}}}),mr=Object.assign(ke(_r,[["__scopeId","data-v-295586ca"]]),{__name:"DashboardSettingsSyncReview"}),vr={class:"flex-1 flex flex-col max-h-full create-source"},fr={class:"px-4 py-3 w-full flex items-center gap-3 border-b-1 border-gray-200"},br={class:"flex items-center"},yr={class:"flex items-center gap-3"},gr={class:"h-[calc(100%_-_58px)] flex justify-center p-5"},hr={class:"flex flex-col gap-10 w-full items-center overflow-y-auto"},xr={class:"w-5xl"},wr={class:"flex rounded-lg p-6 border-1 border-nc-border-gray-medium"},kr={class:"nc-form-section"},$r={class:"flex flex-col gap-5"},Sr={key:0,class:"w-3xl"},Cr={key:1,class:"w-3xl"},Ir={key:2,class:"w-3xl"},Dr={key:3},Tr={key:4,class:"w-3xl"},Mr={key:0},Or={key:0,class:"flex justify-center items-center"},Pr={key:1,class:"flex justify-center items-center"},Nr={key:1},jr={key:0,class:"w-3xl flex justify-between"},Er=re({__name:"Create",props:{open:{type:Boolean},baseId:{},isModal:{type:Boolean}},emits:["update:open","syncCreated"],setup(I,{emit:o}){const b=I,y=o,r=Ge(b,"open",y),{loadDynamicIntegrations:k}=Rt(),{activeWorkspaceId:D}=ve(xt()),$=Qe(),{loadTables:f}=$,{refreshCommandPalette:w}=qt(),{$poller:N}=Ae(),u=V(0),i=V(!1),d=V(!1),p=V(),l=V(!1),{createSync:M,formState:g,syncConfigForm:v,isLoading:B,deepReference:L,switchToIntegrationConfig:h,resetStore:j,saveCurrentFormState:T,validateSyncConfig:S}=pn(D,b.baseId),Y=async()=>{B.value=!0,l.value=!0;try{const x=await M();if(!x)return;N.subscribe({id:x.job.id},async O=>{var ne,se,U,c,F,J;O.status!=="close"&&(O.status===Ye.COMPLETED?((ne=p.value)==null||ne.pushProgress("Done!",O.status),await f(),w(),i.value=!0):O.status===Ye.FAILED?((c=p.value)==null||c.pushProgress(((U=(se=O.data)==null?void 0:se.error)==null?void 0:U.message)??"Sync failed",O.status),await f(),w(),d.value=!0):(J=p.value)==null||J.pushProgress(((F=O.data)==null?void 0:F.message)??"Syncing...","progress"),y("syncCreated"))})}catch(x){pe.error(await Fe(x)),l.value=!1}finally{B.value=!1}},R=async()=>{switch(u.value){case 0:u.value=1;break;case 2:await T()&&(v.value.sync_category==="custom"?u.value=3:u.value=4);break;case 1:try{await S(),u.value=2}catch{}break;case 3:if(g.value.config.custom_schema){for(const x of Object.values(g.value.config.custom_schema))if(!x.systemFields.primaryKey||x.systemFields.primaryKey.length===0){pe.error("Every table must have at least one unique identifier column");return}await T()&&(u.value=4)}break;case 4:Y();break}},_=()=>{switch(u.value){case 0:u.value=0;break;case 1:u.value=0;break;case 2:u.value=1;break;case 3:u.value=2;break;case 4:v.value.sync_category==="custom"?u.value=3:u.value=2;break}},K=x=>{v.value.sync_category=x,u.value=1},te=X(()=>{switch(u.value){case 0:return!!v.value.sync_category;case 2:return g.value.sub_type;default:return!0}});We(async()=>{B.value=!0,await k(),it(()=>{h(0)}),B.value=!1}),Oe(()=>r.value,x=>{x&&(u.value=0,j())});const C=()=>{d.value=!1,l.value=!1,i.value=!1};function oe(){C(),r.value=!1}const H=()=>{C(),r.value=!1},q=X(()=>!l.value);return(x,O)=>{const ne=$e,se=Ke,U=rc,c=pc,F=mt,J=Xt,le=Zt,xe=_n,Ie=mn,ze=vn,Se=Yc,Ue=ms,Pe=mr,Re=_t,ge=Ut;return a(),E(ge,{visible:e(r),"onUpdate:visible":O[1]||(O[1]=Ve=>ie(r)?r.value=Ve:null),"mask-closable":e(q),keyboard:e(q),centered:"",size:"large","wrap-class-name":"nc-modal-create-source",onKeydown:Et(H,["esc"])},{default:n(()=>[t("div",vr,[t("div",fr,[t("div",br,[s(ne,{icon:"ncZap",class:"!text-green-700 !h-5 !w-5"})]),O[2]||(O[2]=t("div",{class:"flex-1 text-base font-weight-700"},"Create Sync",-1)),t("div",yr,[s(se,{disabled:e(l),size:"small",type:"text",onClick:H},{default:n(()=>[s(ne,{icon:"close",class:"text-gray-600"})]),_:1},8,["disabled"])])]),t("div",gr,[t("div",hr,[t("div",xr,[s(U,{current:e(u)},null,8,["current"])]),t("div",wr,[s(Re,{name:"external-base-create-form",layout:"vertical","no-style":"","hide-required-mark":"",class:"flex flex-col w-full"},{default:n(()=>[t("div",kr,[t("div",$r,[e(u)===0?(a(),P("div",Sr,[s(le,{gutter:24},{default:n(()=>[s(J,{span:24},{default:n(()=>[s(F,{label:"Sync Category"},{default:n(()=>[s(c,{"model-value":e(L)("sync_category"),onChange:O[0]||(O[0]=Ve=>K(Ve))},null,8,["model-value"])]),_:1})]),_:1})]),_:1})])):A("",!0),e(u)===2?(a(),P("div",Cr,[t("div",null,[s(xe),s(Ie)])])):A("",!0),e(u)===1?(a(),P("div",Ir,[s(ze)])):A("",!0),e(v).sync_category==="custom"&&e(u)===3?(a(),P("div",Dr,[s(Se)])):A("",!0),e(u)===4?(a(),P("div",Tr,[e(l)?(a(),P("div",Mr,[O[5]||(O[5]=t("div",{class:"mb-4 prose-xl font-bold"},"Creating sync schema and syncing initial data",-1)),s(Ue,{ref_key:"progressRef",ref:p,class:"w-full"},null,512),e(i)?(a(),P("div",Or,[s(se,{class:"mt-6 mb-8",size:"medium",onClick:oe},{default:n(()=>O[3]||(O[3]=[G(" 🚀 Go To Dashboard 🚀")])),_:1,__:[3]})])):e(d)?(a(),P("div",Pr,[s(se,{class:"mt-6 mb-8",type:"ghost",size:"medium",onClick:oe},{default:n(()=>O[4]||(O[4]=[G("Go Dashboard")])),_:1,__:[4]})])):A("",!0)])):(a(),P("div",Nr,[s(Pe)]))])):A("",!0)])])]),_:1})]),e(l)?A("",!0):(a(),P("div",jr,[s(se,{type:"ghost",disabled:e(u)===0,onClick:_},{default:n(()=>O[6]||(O[6]=[G(" Back ")])),_:1,__:[6]},8,["disabled"]),s(se,{type:"primary",loading:e(l),disabled:!e(te),onClick:R},{default:n(()=>[G(m(e(u)===4?"Create":"Continue"),1)]),_:1},8,["loading","disabled"])]))])])])]),_:1},8,["visible","mask-closable","keyboard"])}}}),fn=Object.assign(ke(Er,[["__scopeId","data-v-d96ebc09"]]),{__name:"DashboardSettingsSyncCreate"}),Br=Object.freeze(Object.defineProperty({__proto__:null,default:fn},Symbol.toStringTag,{value:"Module"})),Ar=["onClick"],Ur={key:0,class:"tab-title nc-tab"},Rr=re({__name:"SelectTab",props:ua({disabled:{type:Boolean},tooltip:{},items:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(I){const o=I,b=pa(I,"modelValue");return(y,r)=>{const k=$e,D=Ze,$=Ht("e");return a(),E(D,{disabled:!o.tooltip},{title:n(()=>[G(m(o.tooltip),1)]),default:n(()=>[t("div",{class:ue(["flex flex-row p-1 bg-gray-200 rounded-lg gap-x-0.5",{"!cursor-not-allowed opacity-50":o.disabled}])},[(a(!0),P(_e,null,Be(o.items.filter(f=>!f.hidden),f=>(a(),E(D,{key:f.value,disabled:!f.tooltip||o.disabled},{title:n(()=>[G(m(f.tooltip),1)]),default:n(()=>[Je((a(),P("div",{class:ue(["tab",{"pointer-events-none":o.disabled,active:b.value===f.value}]),onClick:w=>b.value=f.value},[s(k,{icon:f.icon,class:"tab-icon"},null,8,["icon"]),f.title?(a(),P("div",Ur,m(y.$t(f.title)),1)):A("",!0)],10,Ar)),[[$,[`c:project:mode:${f.value}`]]])]),_:2},1032,["disabled"]))),128))],2)]),_:1},8,["disabled"])}}}),Lr=Object.assign(ke(Rr,[["__scopeId","data-v-5b285768"]]),{__name:"NcSelectTab"}),Fr={class:"flex-1 flex flex-col max-h-full create-source"},zr={class:"px-4 py-3 w-full flex items-center gap-3 border-b-1 border-gray-200"},Vr={class:"flex items-center"},Gr={class:"flex items-center gap-3"},Wr={class:"h-[calc(100%_-_58px)] flex justify-center p-5"},Kr={class:"flex flex-col gap-10 w-full items-center overflow-y-auto"},qr={class:"w-3xl flex rounded-lg p-6 w-full border-1 border-nc-border-gray-medium relative"},Yr={key:0,class:"absolute inset-0 bg-gray-500/10 z-10 rounded-lg cursor-not-allowed"},Hr={key:1,class:"create-source bg-white relative flex flex-col gap-2 w-full max-w-[768px]"},Qr={key:0,class:"sync-info bg-gray-100 p-4 rounded-lg w-full"},Jr={class:"flex justify-between items-center"},Zr={class:"flex flex-col gap-2"},Xr={class:"text-sm text-gray-500"},ed={key:0,class:"text-sm text-gray-500"},td={class:"w-full flex flex-col mt-3"},sd={class:"flex items-center gap-3"},nd={class:"flex"},ad={class:"nc-form-section"},od={class:"flex flex-col gap-5"},ld={key:3,class:"create-source bg-white relative flex flex-col gap-2 w-full max-w-[768px]"},id={class:"nc-form-section w-full"},cd=re({__name:"Edit",props:{open:{type:Boolean},baseId:{},syncId:{},isModal:{type:Boolean}},emits:["update:open","syncUpdated"],setup(I,{emit:o}){const b=I,r=Ge(b,"open",o),{integrations:k,loadDynamicIntegrations:D,loadIntegrations:$}=Rt(),f=xt(),{activeWorkspaceId:w}=ve(f),{$poller:N}=Ae(),u=V([{title:"Sync",value:"sync",icon:"ncZap"},{title:"Sync Settings",value:"sync-settings",icon:"ncSettings"},{title:"Integrations",value:"integrations",icon:"ncSettings"}]),{integrationConfigs:i,isLoading:d,loadConfig:p,syncConfigEditForm:l,editMode:M,editModeSync:g,triggerSync:v,readSync:B,editTab:L}=pn(w,b.baseId);M.value=!0;const h=V(!1),j=V(!1),T=V(!1),S=V();async function Y(){d.value=!0,await D(),await $();const te=await B(b.syncId);g.value=te,l.value=te;const C=[te,...te.children];i.value=C.map(oe=>{const H=k.value.find(q=>q.id===oe.fk_integration_id);return H?{...H,syncConfigId:oe.id,parentSyncConfigId:oe.fk_parent_sync_config_id}:null}),d.value=!1}const R=async te=>{te==="integrations"&&await p(0)},_=async()=>{if(g.value)try{j.value=!0;const te=await v(b.syncId,!0);if(!te){j.value=!1;return}N.subscribe({id:te.id},async C=>{var oe,H,q,x,O,ne,se;C.status!=="close"&&(C.status===Ye.COMPLETED?((H=S.value)==null||H.pushProgress(((oe=C.data)==null?void 0:oe.message)??"Done!",C.status),j.value=!1,T.value=!0):C.status===Ye.FAILED?((O=S.value)==null||O.pushProgress(((x=(q=C.data)==null?void 0:q.error)==null?void 0:x.message)??"Sync failed",C.status),j.value=!1,T.value=!0):(se=S.value)==null||se.pushProgress(((ne=C.data)==null?void 0:ne.message)??"",C.status))})}catch(te){pe.error(await Vs(te)),j.value=!1}};We(()=>{Y()});const K=X(()=>!h.value&&!j.value);return(te,C)=>{const oe=$e,H=Ke,q=Lr,x=ms,O=vn,ne=_t,se=_n,U=mn,c=Ut;return a(),E(c,{visible:e(r),"onUpdate:visible":C[3]||(C[3]=F=>ie(r)?r.value=F:null),"mask-closable":e(K),keyboard:e(K),centered:"",size:"large","wrap-class-name":"nc-modal-create-source",onKeydown:C[4]||(C[4]=Et(F=>r.value=!1,["esc"]))},{default:n(()=>[t("div",Fr,[t("div",zr,[t("div",Vr,[s(oe,{icon:"ncZap",class:"!text-green-700 !h-5 !w-5"})]),C[5]||(C[5]=t("div",{class:"flex-1 text-base font-weight-700"},"Edit Sync Configuration",-1)),t("div",Gr,[s(H,{disabled:e(h)||e(j),size:"small",type:"text",onClick:C[0]||(C[0]=F=>r.value=!1)},{default:n(()=>[s(oe,{icon:"close",class:"text-gray-600"})]),_:1},8,["disabled"])])]),t("div",Wr,[t("div",Kr,[t("div",null,[s(q,{modelValue:e(L),"onUpdate:modelValue":[C[1]||(C[1]=F=>ie(L)?L.value=F:null),R],items:e(u)},null,8,["modelValue","items"])]),t("div",qr,[e(L)==="integrations"&&e(l).sync_category==="custom"?(a(),P("div",Yr)):A("",!0),e(L)==="sync"?(a(),P("div",Hr,[e(g)?(a(),P("div",Qr,[t("div",Jr,[C[6]||(C[6]=t("div",{class:"text-lg font-semibold"},"Sync Information",-1)),t("div",Zr,[t("div",Xr," Last Sync: "+m(e(g).last_sync_at?e(g).last_sync_at:"Never"),1),e(g).next_sync_at?(a(),P("div",ed," Next Sync: "+m(e(g).next_sync_at),1)):A("",!0)])])])):A("",!0),t("div",td,[t("div",sd,[!e(j)&&!e(T)?(a(),E(H,{key:0,size:"small",type:"primary",class:"nc-extdb-btn-submit",loading:e(j),disabled:e(d)||e(h),onClick:_},{default:n(()=>C[7]||(C[7]=[G(" Trigger Sync ")])),_:1,__:[7]},8,["loading","disabled"])):A("",!0),e(T)?(a(),E(H,{key:1,size:"small",type:"primary",class:"nc-extdb-btn-submit",onClick:C[2]||(C[2]=F=>T.value=!1)},{default:n(()=>C[8]||(C[8]=[G(" Minimize ")])),_:1,__:[8]})):A("",!0)])]),t("div",nd,[e(j)||e(T)?(a(),E(x,{key:0,ref_key:"progressRef",ref:S,class:"w-full h-[400px]"},null,512)):A("",!0)])])):A("",!0),e(L)==="sync-settings"?(a(),E(ne,{key:2,name:"external-base-create-form",layout:"vertical","no-style":"","hide-required-mark":"",class:"flex flex-col w-full"},{default:n(()=>[t("div",ad,[t("div",od,[s(O,{"edit-mode":!0})])])]),_:1})):A("",!0),e(L)==="integrations"?(a(),P("div",ld,[t("div",id,[s(se),s(U,{"edit-mode":!0})])])):A("",!0)])])])])]),_:1},8,["visible","mask-closable","keyboard"])}}}),rd=Object.assign(ke(cd,[["__scopeId","data-v-042481d1"]]),{__name:"DashboardSettingsSyncEdit"}),dd={class:"flex flex-col h-full p-6","data-testid":"nc-settings-syncs-tab"},ud={class:"mb-6 flex items-center justify-between gap-3"},pd={class:"flex flex-row items-center w-full gap-x-1"},_d={class:"flex-1 overflow-auto"},md={class:"ds-table overflow-y-auto nc-scrollbar-thin relative max-h-full mb-4"},vd={class:"ds-table-body relative"},fd=["onClick"],bd={class:"ds-table-col ds-table-name font-medium"},yd={class:"flex items-center gap-1"},gd={class:"ds-table-col ds-table-type"},hd={class:"ds-table-col ds-table-frequency"},xd={class:"ds-table-col ds-table-last-sync"},wd={class:"ds-table-col ds-table-actions"},kd={class:"flex justify-end gap-2"},$d={key:0,class:"flex-none integration-table-empty flex items-center justify-center py-8 px-6"},Sd={key:1,class:"flex-none integration-table-empty flex items-center justify-center py-8 px-6"},Cd={class:"flex items-center justify-center absolute left-0 top-0 w-full h-[calc(100%_-_45px)] z-10 pb-10 pointer-events-none"},Id={class:"flex flex-col justify-center items-center gap-2"},Dd=re({__name:"Syncs",props:{state:{},baseId:{},reload:{type:Boolean}},emits:["update:state","update:reload"],setup(I,{emit:o}){const b=I,r=Ge(b,"reload",o),{$api:k,$poller:D}=Ae(),{projectPageTab:$}=ve(ns()),f=xt(),{activeWorkspace:w}=ve(f),N=Qe(),{loadTables:u}=N,{isUIAllowed:i}=rt(),d=V(""),p=V([]),l=V(!1),M=V(!1),g=V(!1),v=V(""),B=(R,_)=>R===Wt.Manual?"Manual":R===Wt.Schedule&&_?_.includes("hourly")?"Hourly":_.includes("daily")?"Daily":_.includes("weekly")?"Weekly":_:"Unknown",L=async()=>{l.value=!0;try{const R=await k.internal.getOperation(w.value.id,b.baseId,{operation:"listSync"});p.value=R.map(_=>({..._,frequency:B(_.sync_trigger,_.sync_trigger_cron)}))}catch(R){console.error(R)}finally{l.value=!1}},h=R=>R?new Date(R).toLocaleString():"-",j=()=>{M.value=!0},T=R=>{v.value=R,g.value=!0},S=async R=>{try{await k.internal.postOperation(w.value.id,b.baseId,{operation:"deleteSync"},{syncConfigId:R}),await u(),await L()}catch(_){console.error(_)}},Y=()=>d.value?p.value.some(R=>{var _,K;return((_=R.title)==null?void 0:_.toLowerCase().includes(d.value.toLowerCase()))||((K=R.sync_type)==null?void 0:K.toLowerCase().includes(d.value.toLowerCase()))}):!0;return We(()=>{ht(()=>!!w.value).toBeTruthy().then(()=>{L()})}),Oe(()=>b.reload,R=>{R&&(r.value=!1)}),Oe($,()=>{$.value==="syncs"&&ht(()=>!!w.value).toBeTruthy().then(()=>{L()})},{immediate:!0}),(R,_)=>{const K=$e,te=vt,C=Ke,oe=Cs,H=ts,q=es,x=ss,O=Ss,ne=Qt,se=fn,U=rd;return a(),P("div",dd,[t("div",ud,[s(te,{value:e(d),"onUpdate:value":_[0]||(_[0]=c=>ie(d)?d.value=c:null),type:"text",class:"nc-search-syncs-input nc-input-border-on-value !max-w-90 nc-input-sm",placeholder:"Search syncs","allow-clear":""},{prefix:n(()=>[s(K,{icon:"search",class:"mr-2 h-4 w-4 text-gray-500"})]),_:1},8,["value"]),e(i)("sourceCreate")?(a(),E(C,{key:0,size:"small",class:"z-10 !px-2",type:"primary",onClick:j},{default:n(()=>[t("div",pd,[s(K,{icon:"plus"}),_[5]||(_[5]=t("div",{class:"flex"},"Create Sync",-1))])]),_:1})):A("",!0)]),t("div",_d,[t("div",md,[_[11]||(_[11]=_a('<div class="ds-table-head sticky top-0 bg-white z-10" data-v-dd276b48><div class="ds-table-row !border-0" data-v-dd276b48><div class="ds-table-col ds-table-name" data-v-dd276b48>Name</div><div class="ds-table-col ds-table-type" data-v-dd276b48>Type</div><div class="ds-table-col ds-table-frequency" data-v-dd276b48>Frequency</div><div class="ds-table-col ds-table-last-sync" data-v-dd276b48>Last Run</div><div class="ds-table-col ds-table-actions" data-v-dd276b48>Actions</div></div></div>',1)),t("div",vd,[(a(!0),P(_e,null,Be(e(p),c=>{var F,J;return a(),P("div",{key:c.id,class:ue(["ds-table-row border-gray-200 cursor-pointer",{"!hidden":e(d)&&!((F=c.title)!=null&&F.toLowerCase().includes(e(d).toLowerCase()))&&!((J=c.sync_type)!=null&&J.toLowerCase().includes(e(d).toLowerCase()))}]),onClick:le=>T(c.id)},[t("div",bd,[t("div",yd,[s(K,{icon:"ncZap",class:"!text-green-700 !h-5 !w-5"}),G(" "+m(c.title||"Untitled Sync"),1)])]),t("div",gd,[s(oe,{rounded:"lg",class:"flex items-center gap-2 px-2 py-1 !h-7 truncate !border-transparent"},{default:n(()=>[G(m(c.sync_type===e(Hs).Full?"Full":"Incremental"),1)]),_:2},1024)]),t("div",hd,m(c.frequency),1),t("div",xd,m(h(c.last_sync_at)),1),t("div",wd,[t("div",kd,[s(O,{placement:"bottomRight",onClick:_[1]||(_[1]=He(()=>{},["stop"]))},{overlay:n(()=>[s(x,{variant:"small"},{default:n(()=>[s(H,{onClick:le=>T(c.id)},{default:n(()=>[s(K,{icon:"edit"}),_[6]||(_[6]=t("span",null,"Edit",-1))]),_:2,__:[6]},1032,["onClick"]),s(q),s(H,{danger:"",onClick:le=>S(c.id)},{default:n(()=>[s(K,{icon:"delete"}),_[7]||(_[7]=t("span",null,"Delete",-1))]),_:2,__:[7]},1032,["onClick"])]),_:2},1024)]),default:n(()=>[s(C,{size:"small",type:"text",class:"nc-action-btn !w-8 !px-1 !rounded-lg"},{default:n(()=>[s(K,{icon:"threeDotVertical"})]),_:1})]),_:2},1024)])])],10,fd)}),128)),!e(l)&&e(p).length===0?(a(),P("div",$d,_[8]||(_[8]=[t("div",{class:"px-2 py-6 text-gray-500 flex flex-col items-center gap-6 text-center"},[t("img",{src:ds,class:"!w-[164px] flex-none",alt:"No syncs found"}),G(" No syncs found ")],-1)]))):A("",!0),!e(l)&&e(p).length>0&&!Y()?(a(),P("div",Sd,_[9]||(_[9]=[t("div",{class:"px-2 py-6 text-gray-500 flex flex-col items-center gap-6 text-center"},[t("img",{src:ds,class:"!w-[164px] flex-none",alt:"No search results found"}),G(" No results matched your search ")],-1)]))):A("",!0)]),Je(t("div",Cd,[t("div",Id,[s(ne,{size:"xlarge"}),_[10]||(_[10]=t("span",{class:"text-center"},"Loading",-1))])],512),[[Gt,e(l)]])])]),e(M)?(a(),E(se,{key:0,open:e(M),"onUpdate:open":_[2]||(_[2]=c=>ie(M)?M.value=c:null),"base-id":b.baseId,onSyncCreated:L},null,8,["open","base-id"])):A("",!0),e(g)&&e(v)?(a(),E(U,{key:1,open:e(g),"onUpdate:open":[_[3]||(_[3]=c=>ie(g)?g.value=c:null),_[4]||(_[4]=c=>g.value=c)],"base-id":b.baseId,"sync-id":e(v),onSyncUpdated:L},null,8,["open","base-id","sync-id"])):A("",!0)])}}}),Td=Object.assign(ke(Dd,[["__scopeId","data-v-dd276b48"]]),{__name:"DashboardSettingsSyncs"}),Md={};function Od(I,o){const b=kt;return a(),E(b)}const Pd=Object.assign(ke(Md,[["render",Od]]),{__name:"DashboardSettingsBaseAccess"}),Nd={};function jd(I,o){return a(),P("div")}const Ed=Object.assign(ke(Nd,[["render",jd]]),{__name:"DashboardSettingsBaseSnapshots"}),Bd={"data-testid":"nc-settings-subtab-visibility",class:"item-card flex flex-col w-full"},Ad={class:"text-nc-content-gray-emphasis font-semibold text-lg"},Ud={class:"text-nc-content-gray-subtle2 mt-2 leading-5"},Rd={class:"flex flex-col border-1 rounded-lg mt-6 border-nc-border-gray-medium"},Ld={class:"flex w-full px-3 py-2 gap-2 flex-col"},Fd={class:"flex w-full gap-1 items-center"},zd={class:"text-nc-content-gray font-semibold flex-1"},Vd={class:"text-gray-500 pl-10"},Gd={class:"flex w-full px-3 border-t-1 border-nc-border-gray-medium py-2 gap-2 flex-col"},Wd={class:"flex w-full gap-1 items-center"},Kd={class:"text-nc-content-gray font-semibold flex-1"},qd={class:"text-gray-500 pl-10"},Yd={class:"flex w-full px-3 py-2 border-t-1 border-nc-border-gray-medium gap-2 flex-col"},Hd={class:"flex w-full gap-1 items-center"},Qd={class:"text-nc-content-gray font-semibold flex-1"},Jd={class:"text-gray-500 pl-10"},Zd=re({__name:"Visibility",setup(I){const{t:o}=ct(),b=Qe(),y=et(),{base:r}=ve(b),k=At(ws,void 0),{loadTables:D,hasEmptyOrNullFilters:$}=b,f=X(()=>{var d;return(k==null?void 0:k.value)??((d=r.value)==null?void 0:d.id)}),w=V(),{includeM2M:N,showNull:u}=wt();Oe(N,async()=>await D()),We(async()=>{var d;await y.loadProject(f.value,!0),w.value=(d=y.getProjectMeta(f.value))==null?void 0:d.showNullAndEmptyInFilter});async function i(d){const p=y.bases.get(f.value);if(!p)throw new Error(`Base ${f.value} not found`);const l=y.getProjectMeta(f.value)??{};d||await $()&&(w.value=!0,pe.warning(o("msg.error.nullFilterExists")));const M={...l,showNullAndEmptyInFilter:w.value};p.meta=M,await y.updateProject(f.value,{meta:JSON.stringify(M)})}return(d,p)=>{const l=ma,M=Ht("e");return a(),P("div",Bd,[t("div",Ad,m(d.$t("labels.visibilityAndDataHandling")),1),t("div",Ud,m(d.$t("labels.visibilityConfigLabel")),1),t("div",Rd,[t("div",Ld,[t("div",Fd,[Je((a(),E(l,{checked:e(N),"onUpdate:checked":p[0]||(p[0]=g=>ie(N)?N.value=g:null),class:"nc-settings-meta-misc-m2m"},{default:n(()=>[t("span",zd,m(d.$t("msg.info.showM2mTables")),1)]),_:1},8,["checked"])),[[M,["c:themes:show-m2m-tables"]]])]),t("span",Vd,m(d.$t("msg.info.showM2mTablesDesc")),1)]),t("div",Gd,[t("div",Wd,[Je((a(),E(l,{checked:e(u),"onUpdate:checked":p[1]||(p[1]=g=>ie(u)?u.value=g:null),class:"nc-settings-show-null"},{default:n(()=>[t("span",Kd,m(d.$t("msg.info.showNullInCells")),1)]),_:1},8,["checked"])),[[M,["c:settings:show-null"]]])]),t("span",qd,m(d.$t("msg.info.showNullInCellsDesc")),1)]),t("div",Yd,[t("div",Hd,[Je((a(),E(l,{checked:e(w),"onUpdate:checked":p[2]||(p[2]=g=>ie(w)?w.value=g:null),class:"nc-settings-show-null-and-empty-in-filter",onChange:i},{default:n(()=>[t("span",Qd,m(d.$t("msg.info.showNullAndEmptyInFilter")),1)]),_:1},8,["checked"])),[[M,["c:settings:show-null-and-empty-in-filter"]]])]),t("span",Jd,m(d.$t("msg.info.showNullAndEmptyInFilterDesc")),1)])])])}}}),Xd=Object.assign(Zd,{__name:"DashboardSettingsBaseVisibility"}),eu={"data-testid":"nc-settings-subtab-visibility",class:"item-card flex flex-col w-full"},tu={class:"flex flex-col border-1 rounded-lg mt-6 border-nc-border-gray-medium"},su={class:"flex w-full px-3 py-2 gap-2 flex-col"},nu={class:"flex flex-col w-full gap-1"},au=re({__name:"Migrate",setup(I){const{$state:o,$api:b}=Ae(),y=b.instance.defaults.baseURL,r=Qe(),k=et(),{base:D}=ve(r),$=At(ws,void 0),f=X(()=>{var i;return($==null?void 0:$.value)??((i=D.value)==null?void 0:i.id)}),w=V({migrationUrl:void 0}),N=V(!1);async function u(){N.value=!0;try{const i=await $fetch(`/api/v2/meta/migrate/${f.value}`,{baseURL:y,method:"POST",headers:{"xc-auth":o.token.value},body:w.value});i!=null&&i.msg&&pe.info(i.msg)}catch(i){pe.error(i.message)}finally{N.value=!1}}return We(async()=>{await k.loadProject(f.value,!0)}),(i,d)=>{const p=vt,l=mt,M=_t,g=Ke;return a(),P("div",eu,[d[3]||(d[3]=t("div",{class:"text-nc-content-gray-emphasis font-semibold text-lg"},"Migrate Data To NocoDB",-1)),d[4]||(d[4]=t("div",{class:"text-nc-content-gray-subtle2 mt-2 leading-5"},"Easily migrate your data to NocoDB Cloud",-1)),t("div",tu,[t("div",su,[t("div",nu,[s(M,{ref:"form",name:"quick-migrate-form",layout:"horizontal",class:"m-0"},{default:n(()=>[s(l,{class:"!m-0"},{default:n(()=>[d[1]||(d[1]=t("div",{class:"flex items-end"},[t("label",null," Migration URL ")],-1)),s(p,{value:e(w).migrationUrl,"onUpdate:value":d[0]||(d[0]=v=>e(w).migrationUrl=v),placeholder:"Enter migration URL for destination",class:"!rounded-lg !my-2 nc-input-api-key"},null,8,["value"])]),_:1,__:[1]})]),_:1},512),s(g,{type:"primary",loading:e(N),disabled:!e(w).migrationUrl,onClick:u},{default:n(()=>d[2]||(d[2]=[G(" Migrate ")])),_:1,__:[2]},8,["loading","disabled"])])])])])}}}),ou=Object.assign(au,{__name:"DashboardSettingsBaseMigrate"}),Ds=va(()=>{const{$api:I}=Ae(),{user:o}=wt(),{t:b}=ct(),y=et(),{activeWorkspaceId:r}=ve(xt()),{activeProjectId:k}=ve(y),{basesUser:D}=ve(y),$=X(()=>k.value?D.value.get(k.value)||[]:[]),f=V([]),w=V(""),N=V(!1),u=X(()=>f.value.some(v=>v.isNew));return{mcpTokens:f,createMcpToken:async v=>{if(k.value)try{N.value=!0;const B=await I.internal.postOperation(r.value,k.value,{operation:"mcpCreate"},{...v,title:w.value});if(B){const L=f.value.findIndex(h=>h.isNew);if(L!==-1){const h=B,j=$.value.find(T=>T.id===h.fk_user_id);f.value[L]={...h,isNew:!1,created_display_name:(j==null?void 0:j.display_name)??(j==null?void 0:j.email)??""}}}return pe.success(b("msg.success.mcpTokenCreated")),N.value=!1,B}catch(B){N.value=!1,pe.error(await Fe(B)),console.error(B)}},listMcpTokens:async()=>{try{const v=await I.internal.getOperation(r.value,k.value,{operation:"mcpList"});v&&Array.isArray(v)&&(f.value=v.map(B=>{const L=$.value.find(h=>h.id===B.fk_user_id);return{...B,isNew:!1,created_display_name:(L==null?void 0:L.display_name)??(L==null?void 0:L.email)??""}}))}catch(v){pe.error(await Fe(v)),console.error(v)}},updateMcpToken:async v=>{try{v.loading=!0;const B=await I.internal.postOperation(r.value,k.value,{operation:"mcpUpdate"},{tokenId:v.id});return v.loading=!1,pe.success(b("msg.success.mcpTokenUpdated")),B}catch(B){pe.error(await Fe(B)),v.loading=!1,console.error(B)}},deleteMcpToken:async v=>{if(!(!k.value||!r.value))try{const B=f.value.find(h=>h.id===v.id);B&&(B.loading=!0),await I.internal.postOperation(r.value,k.value,{operation:"mcpDelete"},{tokenId:v.id})?(f.value=f.value.filter(h=>h.id!==v.id),pe.success(b("msg.success.mcpTokenDeleted"))):(B&&(B.loading=!1),pe.error(b("msg.error.failedToDeleteMcpToken")))}catch(B){const L=f.value.find(h=>h.id===v.id);L&&(L.loading=!1),pe.error(await Fe(B)),console.error("Error deleting MCP token:",B)}},isUnsavedMCPTokenPending:u,cancelNewMcpToken:()=>{f.value=f.value.filter(v=>!v.isNew)},addNewMcpToken:()=>{var v,B,L,h;w.value=`MCP - ${((v=o.value)==null?void 0:v.display_name)??((h=(L=(B=o.value)==null?void 0:B.email)==null?void 0:L.split("@"))==null?void 0:h[0])} - ${ps().format("D MMMM YYYY, h:mm A")}`,f.value=[{title:w.value,isNew:!0},...f.value]},isCreatingMcpToken:N,newMcpTokenTitle:w}}),lu={class:"flex flex-row items-center py-2 px-3 bg-gray-50 rounded-lg text-gray-700"},iu={class:"capitalize text-ellipsis overflow-hidden font-bold select-none w-full pl-3",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},cu=re({__name:"Delete",props:{modelValue:{type:Boolean},mcpToken:{}},emits:["update:modelValue","deleted"],setup(I,{emit:o}){const b=I,y=o,{mcpToken:r}=b,k=Ge(b,"modelValue",y),{deleteMcpToken:D}=Ds();async function $(){if(r.id)try{await D(r),k.value=!1,y("deleted")}catch(f){pe.error(await Fe(f))}}return(f,w)=>{const N=rn;return a(),E(N,{visible:e(k),"onUpdate:visible":w[0]||(w[0]=u=>ie(k)?k.value=u:null),"entity-name":f.$t("labels.mcpToken"),"on-delete":$},{"entity-preview":n(()=>[t("div",lu,[t("div",iu,[t("span",null,m(e(r).title),1)])])]),_:1},8,["visible","entity-name"])}}}),ru=Object.assign(cu,{__name:"DlgMCPDelete"}),du={class:"nc-mcp-code-tab-wrapper h-80 flex flex-col mt-2"},uu={class:"flex h-9 bg-gray-50 border-b-1 border-nc-border-gray-medium rounded-t-lg items-center px-3"},pu={class:"flex items-center gap-2 text-small leading-[18px] min-w-80px justify-center"},_u={class:"h-full w-full flex flex-col justify-center items-center mt-28"},mu=re({__name:"Code",props:{code:{}},setup(I){const b=ut(I,"code"),y=fa(ba,{style:{fontSize:"2rem"},spin:!0}),{t:r}=ct(),{copy:k}=Rs(),D=V(!1),$=async()=>{try{await k(b.value),pe.info(r("msg.info.copiedToClipboard")),D.value=!0,setTimeout(()=>{D.value=!1},5e3)}catch(f){pe.error(f.message)}};return(f,w)=>{const N=$e,u=Ke,i=Wa,d=qs;return a(),P("div",du,[t("div",uu,[w[0]||(w[0]=t("div",{class:"flex-1 text-nc-content-gray leading-5"},"JSON",-1)),s(u,{type:"text",size:"small",class:"!hover:bg-gray-200",onClick:$},{default:n(()=>[t("div",pu,[s(N,{icon:e(D)?"circleCheck":"copy",class:ue(["h-4 w-4",{"text-gray-700":!e(D),"text-green-700":e(D)}])},null,8,["icon","class"]),G(" "+m(e(D)?f.$t("general.copied"):f.$t("general.copy")),1)])]),_:1})]),(a(),E(ya,null,{fallback:n(()=>[t("div",_u,[s(d,{size:"large",indicator:e(y)},null,8,["indicator"])])]),default:n(()=>[s(i,{class:"h-72 !rounded-b-lg overflow-hidden !bg-gray-50","model-value":e(b),"read-only":!0,lang:"json",validate:!1,"disable-deep-compare":!0,"monaco-config":{minimap:{enabled:!1},fontSize:13,lineHeight:18,padding:{top:12,bottom:12},overviewRulerBorder:!1,overviewRulerLanes:0,hideCursorInOverviewRuler:!0,lineDecorationsWidth:12,lineNumbersMinChars:0,roundedSelection:!1,selectOnLineNumbers:!1,scrollBeyondLastLine:!1,contextmenu:!1,glyphMargin:!1,folding:!1,bracketPairColorization:{enabled:!1},wordWrap:"on",scrollbar:{horizontal:"hidden",verticalScrollbarSize:6},renderIndentGuides:!1,wrappingStrategy:"advanced",renderLineHighlight:"none",tabSize:2,detectIndentation:!1,insertSpaces:!0,lineNumbers:"off"},"hide-minimap":""},null,8,["model-value"])]),_:1}))])}}}),vu=Object.assign(mu,{__name:"DashboardSettingsBaseMCPCode"}),fu={class:"flex w-full items-center p-2 justify-between"},bu={class:"flex items-center gap-3 pl-1 flex-1"},yu={class:"text-gray-900 truncate font-semibold text-xl"},gu={class:"flex justify-end items-center gap-3 pr-0.5 flex-1"},hu={class:"flex bg-white rounded-b-2xl h-[calc(100%_-_66px)]"},xu={ref:"containerElem",class:"h-full flex-1 flex flex-col overflow-y-auto scroll-smooth nc-scrollbar-thin px-24 py-6 mx-auto"},wu={class:"flex flex-col max-w-[640px] w-full mx-auto gap-3"},ku={class:"text-nc-content-gray font-bold leading-6"},$u={class:"relative flex flex-col leading-6 text-nc-content-gray-subtle2 gap-3 my-3"},Su={class:"relative flex flex-col leading-6 text-nc-content-gray-subtle2 gap-3 my-3"},Cu={class:"relative flex flex-col leading-6 text-nc-content-gray-subtle2 gap-3 my-3"},Iu={class:"h-full bg-gray-50 border-l-1 w-80 p-5 rounded-br-2xl border-gray-200"},Du={class:"w-full flex flex-col gap-3"},Tu={class:"text-sm text-gray-700 font-semibold !my-0"},Mu={class:"h-7 w-7 flex items-center justify-center"},Ou=re({__name:"Modal",props:{value:{type:Boolean},token:{}},emits:["close","update:value","update:token"],setup(I,{emit:o}){const b=I,y=o,r=Ge(b,"value"),{appInfo:k}=wt(),{openedProject:D}=ve(et()),$=Ge(b,"token"),f=[{title:"Getting with MCP Server",href:"https://docs.nocodb.com/automation/webhook/create-webhook/"},{title:"Setting up MCP Server with Claude",href:"https://docs.nocodb.com/automation/webhook/webhook-overview"},{title:"Setting up MCP Server with Cursor",href:"https://docs.nocodb.com/automation/webhook/create-webhook#webhook-with-custom-payload-"},{title:"Setting up MCP Server with Windsurf",href:"https://docs.nocodb.com/automation/webhook/create-webhook#webhook-with-conditions"}],{updateMcpToken:w}=Ds(),N=async()=>{const p=await w($.value);p&&($.value=p)},u=()=>{y("close"),r.value=!1},i=V("claude"),d=X(()=>{var p,l;return`
{
  "mcpServers": {
    "NocoDB Base - ${(p=D.value)==null?void 0:p.title}": {
      "command": "npx",
      "args": [
        "mcp-remote",
        "${k.value.ncSiteUrl}/mcp/${$.value.id}",
        "--header",
        "xc-mcp-token: ${((l=$.value)==null?void 0:l.token)??"xxxxxxxxxxxxxxxxxxxxxxxxxxx"}"
      ]
    }
  }
}
`});return(p,l)=>{const M=$e,g=Ke,v=vu,B=$s,L=Ys,h=gs,j=nn,T=Ut;return a(),E(T,{visible:e(r),"onUpdate:visible":l[4]||(l[4]=S=>ie(r)?r.value=S:null),"show-separator":!0,size:"large","wrap-class-name":"nc-modal-mcp-token-create-edit"},{header:n(()=>[t("div",fu,[t("div",bu,[s(M,{class:"text-gray-900 h-5 w-5",icon:"mcp"}),t("span",yu,m(e($).title),1)]),t("div",gu,[s(g,{type:"text",size:"small","data-testid":"nc-close-webhook-modal",onClick:He(u,["stop"])},{default:n(()=>[s(M,{icon:"close"})]),_:1})])])]),default:n(()=>[t("div",hu,[t("div",xu,[t("div",wu,[t("div",ku,m(p.$t("labels.mcpSetup")),1),s(L,{"active-key":e(i),"onUpdate:activeKey":l[3]||(l[3]=S=>ie(i)?i.value=S:null)},{default:n(()=>[s(B,{key:"claude",class:"!h-full"},{tab:n(()=>[t("span",{class:ue([{"text-brand-500 font-medium":e(i)==="claude","text-gray-700":e(i)!=="claude"},"text-sm"])}," Claude ",2)]),default:n(()=>[t("div",$u,[l[5]||(l[5]=G(" Get started with the NocoDB MCP with Claude Desktop in 3 simple steps ")),l[6]||(l[6]=t("ol",{class:"list-decimal pl-5"},[t("li",null,"Navigate to Claude Desktop settings from the navigation bar."),t("li",null,"Go to the Develop Tab, and click on “Edit Config”."),t("li",null,"Add the JSON configuration that’s provided after creating a token in claude_desktop_config.json")],-1)),s(g,{type:"secondary",class:"w-39",size:"small",loading:e($).loading,onClick:l[0]||(l[0]=S=>N(e($)))},{default:n(()=>[G(m(p.$t("labels.regenerateToken")),1)]),_:1},8,["loading"]),(a(),E(v,{key:e(d),code:e(d)},null,8,["code"]))])]),_:1}),s(B,{key:"cursor",class:"!h-full"},{tab:n(()=>[t("span",{class:ue([{"text-brand-500 font-medium":e(i)==="cursor","text-gray-700":e(i)!=="cursor"},"text-sm"])}," Cursor ",2)]),default:n(()=>[t("div",Su,[l[7]||(l[7]=G(" Get started with the NocoDB MCP with Cursor in 3 simple steps ")),l[8]||(l[8]=t("ol",{class:"list-decimal pl-5"},[t("li",null,"Open Cursor Settings (press Shift+Cmd+J)"),t("li",null,'Select the "MCP" tab and click "Add MCP Server" .'),t("li",null,"Add the JSON configuration that’s provided after creating a token.")],-1)),s(g,{type:"secondary",class:"w-44",size:"small",loading:e($).loading,onClick:l[1]||(l[1]=S=>N(e($)))},{default:n(()=>[G(m(p.$t("labels.regenerateToken")),1)]),_:1},8,["loading"]),(a(),E(v,{key:e(d),code:e(d)},null,8,["code"]))])]),_:1}),s(B,{key:"windsurf",class:"!h-full"},{tab:n(()=>[t("span",{class:ue([{"text-brand-500 font-medium":e(i)==="windsurf","text-gray-700":e(i)!=="windsurf"},"text-sm"])}," Windsurf ",2)]),default:n(()=>[t("div",Cu,[l[9]||(l[9]=G(" Get started with the NocoDB MCP with Windsurf in 4 simple steps ")),l[10]||(l[10]=t("ol",{class:"list-decimal pl-5"},[t("li",null,"Access Windsurf settings and Select Cascade Tab in the left sidebar"),t("li",null,"Click on Add Server."),t("li",null,"Now click on Add Custom Server in the modal."),t("li",null,"Paste the JSON configuration that’s provided after creating a token in the opened file")],-1)),s(g,{type:"secondary",class:"w-44",size:"small",loading:e($).loading,onClick:l[2]||(l[2]=S=>N(e($)))},{default:n(()=>[G(m(p.$t("labels.regenerateToken")),1)]),_:1},8,["loading"]),s(v,{code:e(d)},null,8,["code"])])]),_:1})]),_:1},8,["active-key"])]),s(h,{type:"info",class:"mt-3 max-w-[640px] w-full mx-auto"},{message:n(()=>[G(m(p.$t("labels.mcpTokenVisibilityInfo")),1)]),description:n(()=>[G(m(p.$t("labels.mcpTokenVisibilityInfoDescription"))+" ",1),l[11]||(l[11]=t("br",null,null,-1)),G(" "+m(p.$t("labels.mcpTokenVisibilityInfoDescription2")),1)]),_:1})],512),t("div",Iu,[t("div",Du,[t("h2",Tu,m(p.$t("labels.supportDocs")),1),t("div",null,[(a(),P(_e,null,Be(f,(S,Y)=>t("div",{key:Y,class:"flex items-center gap-1"},[t("div",Mu,[s(M,{icon:"bookOpen",class:"flex-none w-4 h-4 text-gray-500"})]),s(j,{href:S.href,target:"_blank",rel:"noopener noreferrer",class:"!text-gray-500 text-sm !no-underline !hover:underline"},{default:n(()=>[G(m(S.title),1)]),_:2},1032,["href"])])),64))])])])])]),_:1},8,["visible"])}}}),Pu=Object.assign(Ou,{__name:"DashboardSettingsBaseMCPModal"}),Nu={key:0,class:"absolute w-full h-full inset-0 flex items-center justify-center z-90 bg-black/12"},ju={key:0,style:{"box-shadow":"0px 8px 8px -4px rgba(0, 0, 0, 0.04), 0px 20px 24px -4px rgba(0, 0, 0, 0.1)"},class:"bg-white p-6 flex flex-col w-[488px] rounded-2xl"},Eu={class:"text-nc-content-gray-emphasis text-lg font-bold"},Bu={class:"text-nc-gray-subtle2 mt-2"},Au={class:"w-full flex justify-between items-center gap-3 mt-5"},Uu={class:"flex flex-col w-full"},Ru={class:"text-nc-content-gray-emphasis font-semibold text-lg"},Lu={class:"text-nc-content-gray-subtle2 mt-2 leading-5"},Fu={class:"flex items-center mt-6 gap-5"},zu={class:"text-[10px] leading-[14px] uppercase font-semibold pt-1 text-gray-300"},Vu={class:"mt-1 text-[13px]"},Gu={class:"text-[10px] leading-[14px] uppercase font-semibold mt-2 text-gray-300"},Wu={class:"mt-1 pb-1 text-[13px]"},Ku={key:0,class:"text-nc-content-gray-subtle"},qu={key:1},Yu={class:"flex gap-2"},Hu=re({__name:"index",setup(I){const{t:o}=ct(),{sorts:b,sortDirection:y,loadSorts:r,handleGetSortedData:k,saveOrUpdate:D}=ln("Webhook"),$=X({get:()=>y.value,set:_=>{if(Object.keys(_).length===0){D({});return}const K=Object.entries(_);if(K.length>0){const[te,C]=K[0];D({field:te,direction:C})}}}),{mcpTokens:f,createMcpToken:w,listMcpTokens:N,cancelNewMcpToken:u,isUnsavedMCPTokenPending:i,addNewMcpToken:d,isCreatingMcpToken:p,newMcpTokenTitle:l,updateMcpToken:M}=Ds(),g=X(()=>k(f.value,b.value)),v=[{key:"name",title:o("general.name"),name:"Token",minWidth:397,padding:"12px 24px",showOrderBy:!0,dataIndex:"title"},{key:"created_at",title:o("labels.createdOn"),width:150,minWidth:180,showOrderBy:!0,dataIndex:"created_at"},{key:"action",title:o("general.action"),width:162,minWidth:162,justify:"justify-end",align:"center"}];We(async()=>{r(),await N()});const B=V(!1),L=V(null),h=_=>{_.isNew||(L.value=_,B.value=!0)},j=async _=>{const K=await w(_);K&&h(K)},T=async _=>{const K=await M(_);K&&h(K)},S=async()=>{L.value=null,B.value=!1,await N()},Y=_=>{const K=V(!0),{close:te}=bt(ru,{modelValue:K,mcpToken:_,"onUpdate:modelValue":C,onDeleted:async()=>{C(),await N()}});function C(){K.value=!1,te(1e3)}},R=(_,K)=>ps(_).format(K);return(_,K)=>{const te=Qt,C=Ke,oe=Ze,H=vt,q=$e,x=ts,O=es,ne=ss,se=Ss,U=on,c=Pu;return a(),P(_e,null,[e(p)?(a(),P("div",Nu,[e(p)?(a(),P("div",ju,[t("div",Eu,m(_.$t("labels.creatingMCPToken")),1),t("div",Bu,m(_.$t("labels.creatingTokenDescription")),1),t("div",Au,[s(te,{size:"xlarge"})])])):A("",!0)])):A("",!0),t("div",Uu,[t("div",Ru,m(_.$t("labels.modelContextProtocol")),1),t("div",Lu,m(_.$t("labels.mcpSubText")),1),t("div",Fu,[s(C,{disabled:e(i),type:"secondary","data-testid":"add-new-mcp-token",size:"small",onClick:e(d)},{default:n(()=>[G(m(_.$t("labels.newMCPEndpoint")),1)]),_:1},8,["disabled","onClick"])]),s(U,{"order-by":e($),"onUpdate:orderBy":K[3]||(K[3]=F=>ie($)?$.value=F:null),columns:v,"header-row-height":"44px","row-height":"44px",data:e(g),class:"h-full mt-5","body-row-class-name":"nc-base-settings-mcp-token-item group no-border-last",onRowClick:h},{bodyCell:n(({column:F,record:J})=>[F.key==="name"?(a(),P(_e,{key:0},[J.isNew?(a(),E(H,{key:1,value:e(l),"onUpdate:value":K[0]||(K[0]=le=>ie(l)?l.value=le:null),class:"new-token-title",placeholder:"Token name"},null,8,["value"])):(a(),E(oe,{key:0,class:"truncate text-gray-800 font-semibold text-sm"},{title:n(()=>[t("div",zu,m(_.$t("labels.createdOn")),1),t("div",Vu,m(e(ps)(J.created_at).format("D MMMM YYYY, hh:mm A")),1),t("div",Gu,m(_.$t("labels.createdBy")),1),t("div",Wu,m(J.created_display_name),1)]),default:n(()=>[G(m(J.title)+" ",1)]),_:2},1024))],64)):A("",!0),F.key==="created_at"?(a(),P(_e,{key:1},[!J.isNew&&J.created_at?(a(),P("div",Ku,m(R(J.created_at,"D MMM YYYY")),1)):A("",!0)],64)):A("",!0),F.key==="action"?(a(),P(_e,{key:2},[J.isNew?(a(),P("div",qu,[t("div",Yu,[s(C,{"data-testid":"cancel-token-btn",type:"secondary",size:"small",onClick:K[2]||(K[2]=He(le=>e(u)(),["stop"]))},{default:n(()=>[G(m(_.$t("general.cancel")),1)]),_:1}),s(C,{"data-testid":"create-token-btn",type:"primary",size:"small",onClick:He(le=>j(J),["stop"])},{default:n(()=>[G(m(_.$t("general.save")),1)]),_:2},1032,["onClick"])])])):(a(),E(se,{key:0},{overlay:n(()=>[s(ne,{variant:"small"},{default:n(()=>[s(x,{onClick:le=>T(J)},{default:n(()=>[s(q,{icon:"refresh"}),G(" "+m(_.$t("labels.regenerateToken")),1)]),_:2},1032,["onClick"]),s(O),s(x,{danger:"",onClick:le=>Y(J)},{default:n(()=>[s(q,{icon:"delete"}),G(" "+m(_.$t("labels.deleteToken")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:n(()=>[s(C,{type:"secondary",class:"!hidden !group-hover:block",size:"small",onClick:K[1]||(K[1]=He(()=>{},["stop"]))},{default:n(()=>[s(q,{icon:"threeDotVertical"})]),_:1})]),_:2},1024))],64)):A("",!0)]),_:1},8,["order-by","data"]),e(B)?(a(),E(c,{key:0,visible:e(B),"onUpdate:visible":K[4]||(K[4]=F=>ie(B)?B.value=F:null),token:e(L),"onUpdate:token":K[5]||(K[5]=F=>ie(L)?L.value=F:null),onClose:S},null,8,["visible","token"])):A("",!0)])],64)}}}),Qu=Object.assign(ke(Hu,[["__scopeId","data-v-51b1299c"]]),{__name:"DashboardSettingsBaseMCP"}),Ju={class:"w-full flex p-6 nc-base-settings overflow-auto nc-scrollbar-thin gap-8"},Zu={class:"flex flex-col"},Xu={class:"h-full flex flex-col gap-1 w-60"},ep={class:"flex flex-col flex-1 max-w-[760px]"},tp=re({__name:"index",setup(I){const{isUIAllowed:o}=rt(),b=X(()=>nt),y=X(()=>nt),r=X(()=>o("baseMiscSettings")&&o("migrateBase")),k=Jt(),D=["baseType","snapshots","visibility","mcp","migrate"],$=V(b.value?"baseType":y.value?"snapshots":"visibility"),{isFeatureEnabled:f}=Yt(),w=X(()=>o("baseMiscSettings")&&f(Pt.MODEL_CONTEXT_PROTOCOL)),N=(u,i=!0)=>{!y.value&&u==="snapshots"||!b.value&&u==="baseType"||!r.value&&u==="migrate"||(i&&k.push({query:{...k.currentRoute.value.query,tab:u}}),$.value=u)};return We(()=>{const u=k.currentRoute.value.query;u&&u.tab&&D.includes(u.tab)&&N(u.tab)}),Oe(()=>k.currentRoute.value.query.tab,u=>{u&&D.includes(u)&&u!==$.value&&N(u,!1)}),(u,i)=>{const d=$e,p=Pd,l=Ed,M=Xd,g=ou,v=Qu;return a(),P("div",Ju,[t("div",Zu,[t("div",Xu,[e(b)?(a(),P("div",{key:0,"data-testid":"base-access-tab",class:ue([{"active-menu":e($)==="baseType"},"gap-3 hover:bg-gray-100 transition-all text-nc-content-gray flex rounded-lg items-center cursor-pointer py-1.5 px-3"]),onClick:i[0]||(i[0]=B=>N("baseType"))},[s(d,{icon:"ncUsers"}),t("span",null,m(u.$t("general.baseType")),1)],2)):A("",!0),e(y)?(a(),P("div",{key:1,"data-testid":"snapshots-tab",class:ue([{"active-menu":e($)==="snapshots"},"gap-3 hover:bg-gray-100 transition-all text-nc-content-gray flex rounded-lg items-center cursor-pointer py-1.5 px-3"]),onClick:i[1]||(i[1]=B=>N("snapshots"))},[s(d,{icon:"camera"}),t("span",null,m(u.$t("general.snapshots")),1)],2)):A("",!0),e(o)("baseMiscSettings")?(a(),P("div",{key:2,class:ue([{"active-menu":e($)==="visibility"},"gap-3 hover:bg-gray-100 transition-all text-nc-content-gray flex rounded-lg items-center cursor-pointer py-1.5 px-3"]),"data-testid":"visibility-tab",onClick:i[2]||(i[2]=B=>N("visibility"))},[s(d,{icon:"ncEye"}),t("span",null,m(u.$t("labels.visibilityAndDataHandling")),1)],2)):A("",!0),e(w)?(a(),P("div",{key:3,class:ue([{"active-menu":e($)==="mcp"},"gap-3 hover:bg-gray-100 transition-all text-nc-content-gray flex rounded-lg items-center cursor-pointer py-1.5 px-3"]),"data-testid":"mcp-tab",onClick:i[3]||(i[3]=B=>N("mcp"))},[s(d,{icon:"mcp"}),t("span",null,m(u.$t("labels.modelContextProtocol")),1)],2)):A("",!0),e(r)?(a(),P("div",{key:4,class:ue([{"active-menu":e($)==="migrate"},"gap-3 hover:bg-gray-100 transition-all text-nc-content-gray flex rounded-lg items-center cursor-pointer py-1.5 px-3"]),"data-testid":"migrate-tab",onClick:i[4]||(i[4]=B=>N("migrate"))},[s(d,{icon:"move"}),i[5]||(i[5]=t("span",null," Migrate ",-1))],2)):A("",!0)])]),t("div",ep,[e($)==="baseType"?(a(),E(p,{key:0})):A("",!0),e($)==="snapshots"?(a(),E(l,{key:1})):A("",!0),e($)==="visibility"?(a(),E(M,{key:2})):A("",!0),e($)==="migrate"?(a(),E(g,{key:3})):A("",!0),e($)==="mcp"?(a(),E(v,{key:4})):A("",!0)])])}}}),sp=Object.assign(ke(tp,[["__scopeId","data-v-2e3317ee"]]),{__name:"DashboardSettingsBase"}),np=at(()=>ot(()=>import("./ag2dqf-6.js"),__vite__mapDeps([70,1,2,71]),import.meta.url).then(I=>I.default||I)),ap={class:"h-full nc-base-view"},op={class:"flex-1 flex flex-row items-center gap-x-3"},lp={key:0,class:"flex flex-row items-center h-full gap-x-2 px-2"},ip={class:"truncate"},cp={key:1,class:"flex nc-base-view-tab",style:{height:"calc(100% - var(--topbar-height))"}},rp={class:"tab-title","data-testid":"proj-view-tab__overview"},dp={class:"tab-title","data-testid":"proj-view-tab__access-settings"},up={class:"tab-title","data-testid":"proj-view-tab__permissions"},pp={class:"tab-title","data-testid":"proj-view-tab__data-sources"},_p={class:"tab-title","data-testid":"proj-view-tab__syncs"},mp={class:"tab-title","data-testid":"proj-view-tab__base-settings"},vp=re({__name:"View",props:{baseId:{},tab:{},showEmptySkeleton:{type:Boolean}},setup(I){const o=I,{hideSidebar:b}=ve(Ka()),{integrations:y}=Ma(),r=et(),{openedProject:k,activeProjectId:D,basesUser:$,bases:f}=ve(r),{activeTable:w}=ve(xs()),{activeWorkspace:N}=ve(xt()),{isSharedBase:u,isPrivateBase:i}=ve(Qe()),{$e:d,$api:p}=Ae(),{blockTableAndFieldPermissions:l,showUpgradeToUseTableAndFieldPermissions:M}=Bt(),g=zs(async()=>{let x;return o.baseId?(x=f.value.get(o.baseId),x||(x=await p.base.read(o.baseId))):x=k.value,x}),v=At(Fs,V(!1)),L=Jt().currentRoute,{isUIAllowed:h,baseRoles:j,isBaseRolesLoaded:T}=rt(),{base:S}=ve(Qe()),{projectPageTab:Y}=ve(ns()),{isMobileMode:R}=wt(),_=V(""),K=X(()=>{var x,O,ne;if(!((x=S.value)!=null&&x.default_role&&!j.value[Xe.OWNER]))return D.value?(ne=(O=$.value.get(D.value))==null?void 0:O.filter(se=>!(se!=null&&se.deleted)))==null?void 0:ne.length:0}),{isTableAndFieldPermissionsEnabled:te}=qa(),{isFeatureEnabled:C}=Yt(),oe=X(()=>h("projectOverviewTab")),H=X({get(){return Y.value},set(x){x==="permissions"&&M()||(Y.value=x)}});Oe(()=>{var x;return(x=L.value.query)==null?void 0:x.page},async(x,O)=>{if("baseId"in L.value.params&&(await ht(()=>T.value).toBeTruthy(),!L.value.params.viewId)){if(x&&x!==O){x==="syncs"?H.value="syncs":x==="data-source"?H.value="data-source":x==="overview"&&oe.value?H.value="overview":x==="permissions"&&!l.value&&nt||(x==="base-settings"?H.value="base-settings":H.value="collaborator");return}v.value||!oe.value?H.value="collaborator":H.value="overview"}},{immediate:!0});const{navigateToProjectPage:q}=Qe();return Oe(H,()=>{d(`a:project:view:tab-change:${H.value}`),q({page:H.value})}),Oe(()=>{var x,O;return[(x=g.value)==null?void 0:x.id,(O=g.value)==null?void 0:O.title]},()=>{var x,O,ne;(x=w.value)!=null&&x.title||ga(`${((O=g.value)==null?void 0:O.title)??((ne=N.value)==null?void 0:ne.title)??"NocoDB"}`)},{immediate:!0}),Oe(()=>{var x;return(x=g.value)==null?void 0:x.id},()=>{y.value=[]}),We(async()=>{await ht(()=>{var x;return!!((x=g.value)!=null&&x.id)}).toBeTruthy(),o.tab&&(H.value=o.tab)}),We(()=>{b.value=!1}),(x,O)=>{var ge,Ve;const ne=$a,se=xa,U=Ze,c=$e,F=Cs,J=np,le=tl,xe=$s,Ie=Tl,ze=Ol,Se=oc,Ue=Td,Pe=sp,Re=wa;return a(),P("div",ap,[e(v)?A("",!0):(a(),P("div",{key:0,class:ue(["flex flex-row px-2 py-2 gap-3 justify-between w-full border-b-1 border-nc-border-gray-medium",{"nc-table-toolbar-mobile":e(R),"h-[var(--topbar-height)]":!e(R)}])},[t("div",op,[s(ne),x.showEmptySkeleton?A("",!0):(a(),P("div",lp,[s(se,{color:("parseProp"in x?x.parseProp:e(ha))((ge=e(g))==null?void 0:ge.meta).iconColor,type:(Ve=e(g))==null?void 0:Ve.type},null,8,["color","type"]),s(U,{class:"flex font-bold text-sm capitalize truncate max-w-150 text-nc-content-gray","show-on-truncate-only":""},{title:n(()=>{var ye;return[G(m((ye=e(g))==null?void 0:ye.title),1)]}),default:n(()=>{var ye;return[t("span",ip,m((ye=e(g))==null?void 0:ye.title),1)]}),_:1}),e(i)?(a(),E(F,{key:0,size:"xs",class:"!text-bodySm !bg-nc-bg-gray-medium !text-nc-content-gray-subtle2",color:"grey",border:!1},{default:n(()=>[s(c,{icon:"ncLock",class:"w-3.5 h-3.5 mr-1"}),G(" "+m(x.$t("general.private")),1)]),_:1})):A("",!0)]))]),x.showEmptySkeleton?A("",!0):(a(),E(J,{key:0}))],2)),x.showEmptySkeleton?A("",!0):(a(),P("div",cp,[s(Re,{"active-key":e(H),"onUpdate:activeKey":O[3]||(O[3]=ye=>ie(H)?H.value=ye:null),class:"w-full"},{leftExtra:n(()=>O[4]||(O[4]=[t("div",{class:"w-3"},null,-1)])),default:n(()=>[!e(v)&&e(oe)?(a(),E(xe,{key:"overview",class:"nc-project-overview-tab-content"},{tab:n(()=>[t("div",rp,[s(c,{icon:"ncMultiCircle"}),t("div",null,m(x.$t("general.overview")),1)])]),default:n(()=>[s(le)]),_:1})):A("",!0),e(h)("newUser",{roles:e(j)})&&!e(u)?(a(),E(xe,{key:"collaborator"},{tab:n(()=>[t("div",dp,[s(c,{icon:"users"}),t("div",null,m(x.$t("labels.members")),1),e(K)?(a(),P("div",{key:0,class:ue(["tab-info",{"bg-primary-selected":e(H)==="collaborator","bg-nc-bg-gray-extralight":e(H)!=="collaborator"}])},m(e(K)),3)):A("",!0)])]),default:n(()=>{var ye;return[s(Ie,{"base-id":(ye=e(g))==null?void 0:ye.id},null,8,["base-id"])]}),_:1})):A("",!0),("isEeUI"in x?x.isEeUI:e(nt))&&e(h)("sourceCreate")&&e(S).id&&e(te)?(a(),E(xe,{key:"permissions"},{tab:n(()=>[t("div",up,[s(c,{icon:"ncLock"}),t("div",null,m(x.$t("general.permissions")),1)])]),default:n(()=>[s(ze,{state:e(_),"onUpdate:state":O[0]||(O[0]=ye=>ie(_)?_.value=ye:null),"base-id":e(S).id},null,8,["state","base-id"])]),_:1})):A("",!0),e(h)("sourceCreate")&&e(S).id?(a(),E(xe,{key:"data-source"},{tab:n(()=>{var ye;return[t("div",pp,[s(c,{icon:"ncDatabase"}),t("div",null,m(x.$t("labels.dataSources")),1),(ye=e(S).sources)!=null&&ye.length?(a(),P("div",{key:0,class:ue(["tab-info",{"bg-primary-selected":e(H)==="data-source","bg-nc-bg-gray-extralight":e(H)!=="data-source"}])},m(e(S).sources.length),3)):A("",!0)])]}),default:n(()=>[s(Se,{state:e(_),"onUpdate:state":O[1]||(O[1]=ye=>ie(_)?_.value=ye:null),"base-id":e(S).id,class:"max-h-full"},null,8,["state","base-id"])]),_:1})):A("",!0),e(C)(("FEATURE_FLAG"in x?x.FEATURE_FLAG:e(Pt)).SYNC)&&e(h)("sourceCreate")&&e(S).id?(a(),E(xe,{key:"syncs"},{tab:n(()=>[t("div",_p,[s(c,{icon:"ncZap"}),O[5]||(O[5]=t("div",null,"Syncs",-1))])]),default:n(()=>[s(Ue,{state:e(_),"onUpdate:state":O[2]||(O[2]=ye=>ie(_)?_.value=ye:null),"base-id":e(S).id,class:"max-h-full"},null,8,["state","base-id"])]),_:1})):A("",!0),!e(u)&&(e(h)("baseMiscSettings")||e(C)(("FEATURE_FLAG"in x?x.FEATURE_FLAG:e(Pt)).MODEL_CONTEXT_PROTOCOL))?(a(),E(xe,{key:"base-settings"},{tab:n(()=>[t("div",mp,[s(c,{icon:"ncSettings"}),t("div",null,m(x.$t("activity.settings")),1)])]),default:n(()=>[s(Pe,{"base-id":e(S).id,class:"max-h-full"},null,8,["base-id"])]),_:1})):A("",!0)]),_:1},8,["active-key"])]))])}}}),fp=Object.assign(ke(vp,[["__scopeId","data-v-59d703d5"]]),{__name:"ProjectView"}),bp=re({__name:"index",setup(I){const b=Jt().currentRoute,y=Qe(),{base:r,sources:k,isSharedBase:D}=ve(y),$=xs(),{openTable:f}=$,{activeTables:w}=ve($),{isMobileMode:N}=wt(),{files:u,reset:i}=ka(),{$e:d}=Ae(),{isUIAllowed:p}=rt(),l=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel.sheet.macroenabled.12","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.spreadsheet-template","text/csv","application/json","text/json"];Oe(u,T=>T&&M(T),{flush:"post"});function M(T){if(!T)return;const S=Array.from(T).map(Y=>Y);g(S)}function g(T){if(!T)return;if(T.length>1)return pe.error({content:"Only one file can be imported at a time.",duration:2});let S=null;const Y=l.some(R=>{const _=T[0].type===R;if(_){const K=T[0].name.split(".").pop();S=K==="csv"||K==="json"?K:"excel"}return _});if(!Y)return pe.error({content:"Invalid file type",duration:2});S&&Y&&v(S,T[0])}function v(T,S){var te,C,oe,H,q;if(!((te=r.value)!=null&&te.id))return;d(`a:actions:import-${T}`);const Y=V(!0),{close:R,vNode:_}=bt(Bs,{modelValue:Y,importType:T,"onUpdate:modelValue":K,baseId:r.value.id,sourceId:(C=k.value)==null?void 0:C.filter(x=>x.enabled)[0].id});(q=(H=(oe=_.value)==null?void 0:oe.component)==null?void 0:H.exposed)==null||q.handleChange({file:{uid:`${T}-${S.name}-${Math.random().toString(36).substring(2)}`,name:S.name,type:S.type,status:"done",fileName:S.name,lastModified:S.lastModified,size:S.size,originFileObj:S},event:{percent:100}});function K(){Y.value=!1,R(1e3),i()}}const B=X(()=>D.value||N.value),L=V(!0),h=X(()=>w.value.length===0||!!b.value.query.page||p("projectOverviewTab")),j=()=>{L.value&&it(()=>{L.value=!1})};return Oe([()=>D.value,()=>w.value.length,()=>p("projectOverviewTab"),()=>b.value.query.page],([T,S,Y,R])=>{var _;if(!S||!((_=w.value[0])!=null&&_.base_id)){j();return}if(!T&&(R||Y)){j();return}f(w.value[0],!0)},{immediate:!0,flush:"pre"}),(T,S)=>{const Y=fp;return e(B)?A("",!0):(a(),E(Y,{key:0,"show-empty-skeleton":!e(h)||e(L)},null,8,["show-empty-skeleton"]))}}}),Qp=Object.freeze(Object.defineProperty({__proto__:null,default:bp},Symbol.toStringTag,{value:"Module"}));export{dl as _,Ul as a,Vl as b,Qp as i,ul as u};
