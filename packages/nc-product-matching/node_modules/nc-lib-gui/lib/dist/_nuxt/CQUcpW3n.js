const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DgrNj_OO.js","./DRA9KN5F.js","./entry.CNP42Mi6.css","./C2UaKEE0.js","./Item.GTPiKSkc.css","./C_VN1MCC.js","./index.CMurbi1o.css","./xPXNcuDa.js","./BYKJ-MHf.js","./gByPF8bR.js","./Modal.CB1oWLel.css","./DkDj6Z7Z.js","./B94p8ToD.js","./gAYHr7Gr.js","./Cd4chHHL.js","./boyBAVNN.js","./BMufqs0w.js","./Overlay.CpKx7Pnx.css","./yMSt-9W5.js","./C83syoBY.js","./CbX26EBz.js","./TimeSelector.DAR2lbHN.css","./index.Ws4Ly2yP.css","./AttachFile.D3qxYYb4.css"])))=>i.map(i=>d[i]);
import{e as ae,as as oe,fj as se,r as x,G as ne,gy as le,os as ie,dm as re,aG as L,bv as ce,I as r,o,w as _,a as s,t as i,L as e,b as p,K as f,N as de,d as g,M as pe,b9 as I,bo as N,c as m,ag as O,an as S,aq as me,Q as R,cS as ue,aX as _e,P as fe,a_ as ge}from"./DRA9KN5F.js";import{u as be,a as ve,_ as he}from"./xPXNcuDa.js";import{S as ye}from"./BVqTF1QK.js";import"./BYKJ-MHf.js";import"./gByPF8bR.js";import"./DkDj6Z7Z.js";import"./B94p8ToD.js";import"./gAYHr7Gr.js";import"./Cd4chHHL.js";import"./boyBAVNN.js";import"./BMufqs0w.js";import"./yMSt-9W5.js";import"./C83syoBY.js";import"./CbX26EBz.js";import"./DP83Cqnl.js";const ke=_e(()=>ge(()=>import("./DgrNj_OO.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]),import.meta.url).then(C=>C.default||C)),we={class:"flex justify-between pb-6 gap-4 items-center"},xe={class:"font-semibold text-xl"},Ce={class:"flex items-center gap-2"},De={class:"flex gap-2 items-center"},Me={class:"flex gap-2 items-center"},$e={class:"p-4"},Ae={class:"text-brand-500 font-bold"},Fe={key:0,class:"flex flex-col gap-1"},je={class:"nc-attachment h-full w-full flex items-center justify-center"},Ee={class:"p-4"},Ie={class:"font-semibold text-brand-500"},Ne={class:"font-semibold"},Re=ae({__name:"Modal",setup(C){const{isUIAllowed:V}=oe(),{isLoading:T,isPublic:B,isReadonly:c,visibleItems:b,modalVisible:l,column:P,onDrop:D,updateModelValue:Z,selectedFile:U,selectedVisibleItems:M,isSharedForm:v,bulkDownloadAttachments:G}=be(),{onChange:K,open:q}=se({reset:!0}),$=x(),A=ne(le,null),z=x(),{dragging:d}=ve(z,b,Z,c),H=function(...t){e(d)||D.apply(this,t)},{isOverDropZone:F}=ie($,H),j=x(!1);re("Escape",()=>{l.value=!1,F.value=!1}),L(l,(t,a)=>{j.value||(setTimeout(()=>{j.value=!1},500),a&&!t&&(A==null||A.trigger()))});function Q(t){U.value=t,j.value=!0,l.value=!1;const a=L(U,h=>{h||(setTimeout(()=>{l.value=!0},50),a==null||a())})}ce($,"paste",t=>{var a;(a=t.clipboardData)!=null&&a.files&&D(t.clipboardData.files)});const X=t=>{q()};K(t=>{D(t,{})});const u=x(!1);return(t,a)=>{const h=pe,E=de,J=he,W=ye,Y=ue,ee=ke,te=fe;return o(),r(te,{visible:e(l),"onUpdate:visible":a[4]||(a[4]=y=>R(l)?l.value=y:null),"wrap-class-name":"nc-modal-attachment-expand-cell",class:O(["nc-attachment-modal",{active:e(l)}]),width:"80%"},{default:_(()=>{var y;return[s("div",we,[s("div",xe,i((y=e(P))==null?void 0:y.title),1),s("div",Ce,[p(E,{disabled:!e(M).some(n=>!!n),type:"secondary",size:"small",onClick:e(G)},{default:_(()=>[s("div",De,[p(h,{icon:"download"}),g(" "+i(t.$t("activity.bulkDownload")),1)])]),_:1},8,["disabled","onClick"]),e(v)||!e(c)&&e(V)("dataEdit")&&!e(B)?(o(),r(E,{key:0,class:"nc-attach-file group",size:"small","data-testid":"attachment-expand-file-picker-button",onClick:a[0]||(a[0]=n=>u.value=!0)},{default:_(()=>[s("div",Me,[(o(),r(I(("iconMap"in t?t.iconMap:e(N)).cellAttachment),{class:"w-4 h-4"})),g(" "+i(t.$t("activity.attachFile")),1)])]),_:1})):f("",!0),p(E,{type:"secondary",size:"small",onClick:a[1]||(a[1]=n=>l.value=!1)},{default:_(()=>[p(h,{icon:"close"})]),_:1})])]),s("div",{ref_key:"dropZoneRef",ref:$,tabindex:"0",class:"relative min-h-[96px]"},[e(v)||!e(c)&&!e(d)&&e(F)?(o(),m("div",{key:0,class:O(["text-white absolute inset-0 flex flex-col items-center justify-center border-dashed border-2 border-nc-border-gray-medium rounded-lg pt-2",{"border-nc-border-brand":!e(b).length}])},[(o(),r(I(("iconMap"in t?t.iconMap:e(N)).upload),{class:"w-8 h-8 text-brand-500"})),s("div",$e,[s("h1",Ae,i(t.$t("labels.dropHere")),1)])],2)):f("",!0),e(b).length>0?(o(),m("div",{key:1,ref_key:"sortableRef",ref:z,class:"grid max-h-140 overflow-auto nc-scrollbar-md md:grid-cols-3 xl:grid-cols-5 gap-y-8 gap-x-4 relative"},[(o(!0),m(S,null,me(e(b),(n,k)=>(o(),r(J,{key:`${n==null?void 0:n.title}-${k}`,dragging:e(d),"onUpdate:dragging":a[2]||(a[2]=w=>R(d)?d.value=w:null),selected:e(M)[k],"onUpdate:selected":w=>e(M)[k]=w,attachment:n,index:k,"allow-selection":!0,"allow-rename":!e(v)||!e(c)&&e(V)("dataEdit")&&!e(B),"allow-delete":!e(c),onClicked:w=>Q(n)},null,8,["dragging","selected","onUpdate:selected","attachment","index","allow-rename","allow-delete","onClicked"]))),128)),e(T)?(o(),m("div",Fe,[p(Y,{class:"nc-attachment-item group"},{default:_(()=>[s("div",je,[p(W,{class:""})])]),_:1})])):f("",!0)],512)):(o(),m("div",{key:2,class:"h-[30vh] min-h-[96px] border-dashed border-2 border-nc-border-medium rounded-lg justify-center cursor-pointer flex items-center flex-col",onClick:X},[e(v)||!e(c)&&!e(d)&&e(F)?f("",!0):(o(),m(S,{key:0},[(o(),r(I(("iconMap"in t?t.iconMap:e(N)).upload),{class:"w-8 h-8 text-gray-500"})),s("span",Ee,[g(i(t.$t("labels.clickTo"))+" ",1),s("span",Ie,i(t.$t("labels.browseFiles")),1),g(" "+i(t.$t("general.or"))+" ",1),s("span",Ne,i(t.$t("labels.dragFilesHere")),1),g(" "+i(t.$t("labels.toUpload")),1)])],64))])),e(u)?(o(),r(ee,{key:3,value:e(u),"onUpdate:value":a[3]||(a[3]=n=>R(u)?u.value=n:null)},null,8,["value"])):f("",!0)],512)]}),_:1},8,["visible","class"])}}}),Xe=Object.assign(Re,{__name:"CellAttachmentModal"});export{Xe as default};
