const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BALLsGq5.js","./DRA9KN5F.js","./entry.CNP42Mi6.css","./DCm6TF8M.js","./Bj4kMpzI.js","./CbSESqy_.js","./Bxzk9hCO.js","./CbX26EBz.js","./TimeSelector.DAR2lbHN.css","./Bm6QmuXP.js","./CkpISeXq.js","./index.N-A1gxk9.css","./zMMvJhqz.js","./FilterInput.7KjqjE1F.css","./CI3EriLB.js","./ytmFgNfN.js","./Pagination.Cmvjwryu.css","./gAYHr7Gr.js","./DkDj6Z7Z.js","./CQa0sIfA.js","./DxC2Oool.js","./By5RWL3d.js","./Cd4chHHL.js","./boyBAVNN.js","./B94p8ToD.js","./DfIS_byq.js","./BVqTF1QK.js","./DP83Cqnl.js","./CNwEZGnv.js","./DlXIlcns.js","./Ce4xoeky.js","./VirtualCell.6f0pX0MN.css"])))=>i.map(i=>d[i]);
import{e as xe,G as a,fO as we,kL as ke,kM as ge,dM as je,gf as be,r as i,ef as Le,gz as Re,gx as Ee,mj as Ve,g6 as ze,kk as Me,Y,iw as Ae,gA as Pe,j9 as Oe,j1 as Te,iZ as Ue,j2 as Ne,as as De,ki as Se,n as g,kn as Z,aG as J,g as Be,iU as $e,kN as W,bz as Fe,I,o as m,w as h,a as ee,c as j,K as y,cf as He,L as t,gX as Ke,ag as te,an as ne,aq as Ge,aC as Xe,O as U,b,N as qe,M as Qe,ap as Ye,aX as D,Q as N,bw as Ze,hL as Je,a_ as S,_ as We}from"./DRA9KN5F.js";import{_ as et}from"./DAm3lfXS.js";import{a as tt}from"./B94p8ToD.js";import{u as nt}from"./BALLsGq5.js";import{u as at}from"./CbX26EBz.js";import"./YYodiGXA.js";import"./DkDj6Z7Z.js";import"./gAYHr7Gr.js";import"./Cd4chHHL.js";import"./boyBAVNN.js";import"./DCm6TF8M.js";import"./Bj4kMpzI.js";import"./CbSESqy_.js";import"./Bxzk9hCO.js";import"./Bm6QmuXP.js";import"./CkpISeXq.js";import"./zMMvJhqz.js";import"./CI3EriLB.js";import"./ytmFgNfN.js";import"./CQa0sIfA.js";import"./DxC2Oool.js";import"./By5RWL3d.js";import"./DfIS_byq.js";import"./BVqTF1QK.js";import"./DP83Cqnl.js";import"./CNwEZGnv.js";import"./DlXIlcns.js";import"./Ce4xoeky.js";const ot=D(()=>S(()=>import("./BALLsGq5.js").then(o=>o.U),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]),import.meta.url).then(o=>o.default||o)),st=D(()=>S(()=>import("./BALLsGq5.js").then(o=>o.L),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]),import.meta.url).then(o=>o.default||o)),lt=D(()=>S(()=>import("./BALLsGq5.js").then(o=>o.b),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]),import.meta.url).then(o=>o.default||o)),it={class:"nc-cell-field flex items-center gap-1 w-full chips-wrapper min-h-6.5 relative"},rt=xe({__name:"HasMany",async setup(o){let B,$;const p=a(we),c=a(ke),ae=a(ge),oe=a(be,je()),F=a(Le,i(!1)),L=a(Re,i(!1)),f=a(Ee,null),d=a(Ve,null),se=a(ze,i(!1)),x=a(Me,i(!1)),le=a(Ae,Y({})),v=a(Pe,null),H=a(Oe,i()),ie=a(Te,!1),R=a(Ne,Y(Ue)),s=i(!1),l=i(!1),u=i(!1),w=i(!1),{isUIAllowed:re}=De(),{state:E,isNew:V,removeLTARRef:ue}=tt(),{relatedTableMeta:me,loadRelatedTableMeta:ce,relatedTableDisplayValueProp:z,unlink:pe}=nt(p,ae,V,oe.trigger);[B,$]=Se(()=>ce()),await B,$();const M=g(()=>!se.value&&re("dataEdit")&&!x.value||F.value),K=g(()=>{var e;return c!=null&&c.value?(c==null?void 0:c.value)??[]:V.value?((e=E==null?void 0:E.value)==null?void 0:e[p==null?void 0:p.value.title])??[]:[]}),G=g(()=>K.value.reduce((e,n)=>{if(!z.value)return e;const C=n[z.value];return[...e,{value:C,item:n}]},[])),fe=async e=>{V.value?await ue(e,p.value):await pe(e)},A=g(()=>{var e,n;return(n=(e=me.value)==null?void 0:e.columns)==null?void 0:n.find(C=>C.title===z.value)}),de=()=>{l.value=!1,s.value=!0,w.value=!1},ve=()=>{s.value=!1,l.value=!0},_=()=>{x.value||(l.value=!0,s.value=!1,u.value=!0,w.value=!1)},P=()=>{M.value&&(s.value=!0,l.value=!1,u.value=!0,w.value=!0)};at(a(Z,i(!1)),e=>{switch(e.key){case"Enter":s.value=!0,e.stopPropagation();break}}),J([l,s],()=>{u.value=l.value||s.value}),J(u,e=>{e||(s.value=!1,l.value=!1)},{flush:"post"});const X=a(Z,i(!1));function k(e){e.type==="click"&&(L.value||F.value||X.value)&&_()}const O=e=>{if(!(!(e instanceof KeyboardEvent)||!e.target||Ze(e))&&Je(e))return l.value?(s.value=!1,l.value=!1):_(),!0};return Be(()=>{d==null||d.on(k),f==null||f.on(k),v==null||v.on(O),!(x.value||!ie||L.value||!R)&&$e(()=>{O(le.event)||(W(".nc-canvas-table-editable-cell-wrapper .nc-has-many-plus-icon",R)?P():W(".nc-canvas-table-editable-cell-wrapper .nc-has-many-maximize-icon",R)?_():M.value?P():_())})}),Fe(()=>{d==null||d.off(k),f==null||f.off(k),v==null||v.off(O)}),(e,n)=>{const C=et,q=Qe,Q=qe,_e=Ye,ye=ot,Ce=st,Ie=lt;return m(),I(Ie,{"is-open":t(u),"onUpdate:isOpen":n[5]||(n[5]=r=>N(u)?u.value=r:null)},{overlay:h(()=>[t(s)?(m(),I(ye,{key:0,modelValue:t(s),"onUpdate:modelValue":n[1]||(n[1]=r=>N(s)?s.value=r:null),column:t(A),"hide-back-btn":t(w),onAttachLinkedRecord:ve,onEscape:n[2]||(n[2]=r=>u.value=!1)},null,8,["modelValue","column","hide-back-btn"])):y("",!0),t(l)?(m(),I(Ce,{key:1,modelValue:t(l),"onUpdate:modelValue":n[3]||(n[3]=r=>N(l)?l.value=r:null),"cell-value":t(K),column:t(A),onAttachRecord:de,onEscape:n[4]||(n[4]=r=>u.value=!1)},null,8,["modelValue","cell-value","column"])):y("",!0)]),default:h(()=>{var r;return[ee("div",it,[ee("div",{class:te(["chips flex items-center img-container flex-1 hm-items min-w-0 overflow-y-auto overflow-x-hidden",{"flex-wrap":t(H)!==1}]),style:He({maxHeight:`${("rowHeightInPx"in e?e.rowHeightInPx:t(Ke))[t(H)]}px`})},[t(G)?(m(),j(ne,{key:0},[(m(!0),j(ne,null,Ge(t(G),(T,he)=>(m(),I(C,{key:he,item:T.item,value:T.value,column:t(A),"show-unlink-button":!1,truncate:!1,onUnlink:ut=>fe(T.item)},null,8,["item","value","column","onUnlink"]))),128)),((r=t(c))==null?void 0:r.length)===10?(m(),j("span",{key:0,class:"caption pointer ml-1 grey--text",onClick:_}," more... ")):y("",!0)],64)):y("",!0)],6),!t(x)&&!t(Xe)(t(p))?(m(),j("div",{key:0,class:te(["flex justify-end gap-[2px] min-h-4 items-center absolute right-0 top-0 bottom-0 has-many-actions",{active:t(X)}]),onClick:n[0]||(n[0]=U(()=>{},["stop"]))},[t(M)?(m(),I(Q,{key:0,size:"xsmall",type:"secondary",class:"nc-action-icon nc-has-many-plus-icon",onClick:U(P,["stop"])},{default:h(()=>[b(q,{icon:"plus",class:"text-sm nc-plus"})]),_:1})):y("",!0),b(_e,{title:e.$t("tooltip.expandShiftSpace"),disabled:t(L),class:"flex"},{default:h(()=>[b(Q,{size:"xsmall",type:"secondary",class:"nc-action-icon nc-has-many-maximize-icon",onClick:U(_,["stop"])},{default:h(()=>[b(q,{icon:"maximize"})]),_:1})]),_:1},8,["title","disabled"])],2)):y("",!0)])]}),_:1},8,["is-open"])}}}),Nt=Object.assign(We(rt,[["__scopeId","data-v-9507de27"]]),{__name:"VirtualCellHasMany"});export{Nt as default};
