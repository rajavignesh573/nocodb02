const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BGi5yrxT.js","./DRA9KN5F.js","./entry.CNP42Mi6.css","./DmPKCP7M.js"])))=>i.map(i=>d[i]);
import{e$ as ye,e as xe,f as dt,a9 as Et,J as Ot,eG as cn,a8 as Dt,al as Nt,n as R,eH as Ct,u as un,r as M,fq as dn,fr as pn,g as Ke,aG as Pe,I as S,o as r,b9 as Be,P as ct,L as e,a3 as ut,ag as Se,Q as me,w as n,b as t,c as y,K as k,a as s,N as Re,M as Oe,cf as Ze,d as oe,t as A,ar as tt,aH as Ft,aJ as vn,aA as pt,an as de,aq as ke,e_ as We,ap as nt,eU as Fe,eP as At,b3 as mn,ad as fn,af as _n,a2 as Lt,_ as Ue,T as Ge,ch as j,X as Ve,a6 as yn,cT as _e,eV as gn,bR as bn,eW as hn,$ as qe,eY as Pt,eZ as Bt,a0 as vt,a1 as le,O as Rt,bB as mt,eJ as Mt,cU as zt,bo as Wt,eS as xn,aS as ft,ah as Sn,dg as wn,f8 as Ut,a4 as Le,a5 as et,f0 as $n,dy as kn,ao as je,b$ as In,fs as Cn,a7 as An,bQ as Un,ft as jt,fu as ge,eX as Tn,ae as En,bC as On,fv as rt,aw as Dn,aX as Vt,a_ as qt,ak as Nn}from"./DRA9KN5F.js";import Fn from"./CtCRqrd3.js";import{_ as _t}from"./BMufqs0w.js";import{c as Ln,C as it,b as Pn,g as Bn}from"./CN7ac-4_.js";import{d as Kt}from"./G4Pt-Lbf.js";import{u as Qe,i as Tt,a as Rn,b as Mn,_ as Gt}from"./C5HnjaiI.js";import{r as zn}from"./BYKJ-MHf.js";import{_ as Wn}from"./BSgyuQBI.js";import{C as jn,_ as Vn}from"./-iDxnmJF.js";import{_ as qn}from"./QeWwuUYP.js";import{_ as Kn,L as Gn}from"./D8vl_16c.js";import{u as Qn}from"./DkDj6Z7Z.js";const Hn=(w,O,g)=>{if("ssl"in w&&w.ssl)return O===ye.No||typeof w.ssl=="object"&&Object.values(w.ssl).every(U=>U==null)?void 0:g==="pg"&&["true","false"].includes(w.ssl)?w.ssl==="true":g==="pg"&&!["boolean","object"].includes(typeof w.ssl)?void 0:w.ssl},Jn={key:0,class:"p-4 w-full flex items-center justify-between gap-3 border-b-1 border-nc-border-gray-medium"},Xn={class:"flex items-center gap-3"},Yn={key:0,class:"px-6 pt-6"},Zn={class:"flex-1"},ea={class:"text-sm font-normal text-nc-content-gray-subtle2 mb-2"},ta={href:"https://nocodb.com/docs/product-docs/integrations",target:"_blank",rel:"noopener noreferrer"},na={class:"flex items-center gap-2 !max-w-[400px]"},aa={class:"flex items-center gap-2"},oa={key:0,class:"bg-nc-bg-brand text-nc-content-brand p-1 text-xs rounded-md min-w-6"},sa={class:"px-2 mb-2"},la={class:"flex items-center gap-2"},ra={class:"category-type-title flex gap-2"},ia={key:0,class:"integration-type-list"},ca=["onClick"],ua={class:"integration-icon-wrapper"},da={class:"flex-1"},pa={class:"name"},va={key:0,class:"subtitle flex-1"},ma={key:0},fa={key:1,class:"flex items-center"},_a={class:"flex items-center gap-2"},ya={class:"flex items-center gap-2"},ga={class:"flex items-center gap-2"},ba={key:3,class:""},ha={class:"flex items-center gap-2"},xa={key:0,class:"h-full text-center flex items-center justify-center gap-3"},Sa={key:1,class:"h-full flex items-center justify-center"},wa={class:"flex flex-col gap-4"},$a={class:"flex items-center justify-between gap-4"},ka={class:"flex flex-col gap-2"},Ia={class:"flex items-center justify-end gap-3"},Ca=xe({__name:"IntegrationsTab",props:{isModal:{type:Boolean,default:!1},filterCategory:{type:Function,default:()=>!0},filterIntegration:{type:Function,default:()=>!0},showFilter:{type:Boolean,default:!1}},setup(w){const O=w,{isModal:g,filterCategory:U,filterIntegration:h}=O,{$e:x}=dt(),{t:D}=Et(),{syncDataUpvotes:I,updateSyncDataUpvotes:B}=Ot(),{isFeatureEnabled:_}=cn(),{activeWorkspace:Z}=Dt(Nt()),$=R(()=>_(Ct.INTEGRATIONS)),N=un(),c=N.currentRoute,{pageMode:Y,IntegrationsPageMode:G,requestIntegration:T,addIntegration:F,saveIntegrationRequest:W,integrationsRefreshKey:V,integrationsCategoryFilter:q,activeViewTab:ue,loadDynamicIntegrations:re}=Qe(),ie=p=>{var d;return p&&((d=p==null?void 0:p.focus)==null?void 0:d.call(p))},o=M(null),v=M(""),i=M(),{width:m}=dn(i),b=R(()=>m.value<=328||m.value<624?"328px":m.value<920?"576px":m.value<1216?"872px":"1168px"),L=R(()=>new Set(I.value)),te=R(()=>Tt.filter(p=>{const d=o.value?p.value===o.value.value:!0;return U(p)&&d&&!p.value.endsWith("-coming-soon")}).map(p=>({label:D(p.title),value:p.value}))),ce=M(!1),ee=R({get:()=>{const p=te.value.map(P=>P.value);if(c.value.query.categories===void 0)return q.value;const d=(c.value.query.categories||"").split(",").map(P=>P.trim()).filter(P=>p.includes(P));return q.value=d,N.push({query:{...c.value.query,categories:void 0}}),q.value},set:p=>{pn(p)&&(q.value=p)}}),fe=R(()=>_(Ct.DATA_REFLECTION)),Ie=(p,d)=>Rn.filter(P=>!fe.value&&P.sub_type===Fe.NOCODB||P.hidden?!1:h(P)&&P.type===p&&D(P.title).toLowerCase().includes(d.trim().toLowerCase())),he=R(()=>(V.value,Tt.filter(p=>{const d=o.value?p.value===o.value.value:!0,P=ee.value.includes(p.value)||ee.value.some(ne=>`${ne}-coming-soon`===p.value);return U(p)&&d&&P}).reduce((p,d)=>(p[d.value]={title:d.title,subtitle:d.subtitle,list:Ie(d.value,v.value),isAvailable:d.isAvailable,teleEventName:d.teleEventName,value:d.value},p),{}))),we=R(()=>{const p=Object.keys(he.value);return p.length?!p.some(d=>he.value[d].list.length>0):!0}),be=R({get:()=>Y.value===G.LIST,set:p=>{p||(Y.value=null)}}),De=(p,d)=>{var P;L.value.has(d)||(x(`a:integration-request:${((P=he.value[p])==null?void 0:P.teleEventName)||p}:${d}`),B([...I.value,d]))},se=async(p,d)=>{if(!d.isAvailable){De(p,d.sub_type);return}await F(d)},Ce=R(()=>te.value.length===ee.value.length),Ne=()=>{Ce.value?ee.value=[]:ee.value=te.value.map(p=>p.value)};Ke(()=>{re(),q.value.length||(q.value=te.value.map(p=>p.value))});const Te=R(()=>{var p;return!!((p=Z.value)!=null&&p.data_reflection_enabled)});return Pe(ue,p=>{p!=="integrations"&&ce.value&&(ce.value=!1)}),(p,d)=>{const P=Oe,ne=Re,f=tt,z=pt,Ae=vn,Me=Ft,ze=qn,He=nt,Je=At,at=mn,ot=Lt,Ee=Gn,Xe=Kn;return r(),S(Be(e(g)?ct:"div"),{visible:e(be),"onUpdate:visible":d[13]||(d[13]=H=>me(be)?be.value=H:null),centered:"",size:"large",class:Se({"h-full":!e(g)}),"wrap-class-name":"nc-modal-available-integrations-list",onKeydown:d[14]||(d[14]=ut(H=>be.value=!1,["esc"]))},{default:n(()=>[t(Xe,null,{default:n(()=>[t(Ee,{class:"nc-integration-layout-content"},{default:n(()=>[e(g)?(r(),y("div",Jn,[t(ne,{type:"text",size:"small",onClick:d[0]||(d[0]=H=>be.value=!1)},{default:n(()=>[t(P,{icon:"arrowLeft"})]),_:1}),t(P,{icon:"gitCommit",class:"flex-none h-5 w-5"}),d[15]||(d[15]=s("div",{class:"flex-1 text-base font-weight-700"},"New Connection",-1)),s("div",Xn,[t(ne,{size:"small",type:"text",onClick:d[1]||(d[1]=H=>be.value=!1)},{default:n(()=>[t(P,{icon:"close",class:"text-nc-content-gray-subtle2"})]),_:1})])])):k("",!0),s("div",{class:Se(["w-full flex flex-col gap-6",{"h-[calc(100%_-_66px)]":e(g),"h-full":!e(g)}])},[e(m)?(r(),y("div",Yn,[s("div",{class:"flex items-end justify-end flex-wrap gap-3 m-auto",style:Ze({maxWidth:e(b)})},[s("div",Zn,[s("div",ea,[s("div",null,[oe(A(p.$t("msg.connectIntegrations"))+" ",1),s("a",ta,A(p.$t("msg.learnMore")),1)])]),s("div",na,[e($)?(r(),S(f,{key:0,value:e(v),"onUpdate:value":d[2]||(d[2]=H=>me(v)?v.value=H:null),type:"text",class:"flex-1 nc-input-border-on-value nc-search-integration-input !min-w-[300px] nc-input-sm flex-none",placeholder:"Search integration","allow-clear":""},{prefix:n(()=>[t(P,{icon:"search",class:"mr-2 h-4 w-4 text-nc-content-gray-muted"})]),_:1},8,["value"])):k("",!0),e($)&&p.showFilter?(r(),S(Me,{key:1,visible:e(ce),"onUpdate:visible":d[5]||(d[5]=H=>me(ce)?ce.value=H:null),placement:"bottomRight"},{overlay:n(()=>[t(Ae,{value:e(ee),"onUpdate:value":d[3]||(d[3]=H=>me(ee)?ee.value=H:null),open:e(ce),"onUpdate:open":d[4]||(d[4]=H=>me(ce)?ce.value=H:null),list:e(te),"search-input-placeholder":"Search category","close-on-select":!1,"is-multi-select":"",variant:"medium"},{listFooter:n(()=>[t(z,{class:"!mt-0 !mb-2"}),s("div",sa,[s("div",{class:"px-2 py-1.5 flex items-center justify-between gap-2 text-sm font-weight-500 !text-nc-content-brand hover:bg-nc-bg-gray-light rounded-md cursor-pointer",onClick:Ne},[s("div",la,[t(P,{icon:e(Ce)?"eyeSlash":"eye"},null,8,["icon"]),s("div",null,A(e(Ce)?p.$t("general.hideAll"):p.$t("general.showAll")),1)])])])]),_:1},8,["value","open","list"])]),default:n(()=>[t(ne,{size:"small",type:"secondary"},{default:n(()=>[s("div",aa,[t(P,{icon:"filter"}),e(te).length-e(ee).length?(r(),y("div",oa,A(e(te).length-e(ee).length),1)):k("",!0)])]),_:1})]),_:1},8,["visible"])):k("",!0)])]),e($)?(r(),S(ne,{key:0,type:"ghost",size:"small",class:"!text-primary",onClick:d[6]||(d[6]=H=>e(T).isOpen=!0)},{default:n(()=>d[16]||(d[16]=[oe(" Request Integration ")])),_:1,__:[16]})):k("",!0)],4)])):k("",!0),s("div",{ref_key:"integrationListRef",ref:i,class:"flex-1 px-6 pb-6 flex flex-col nc-workspace-settings-integrations-list overflow-y-auto nc-scrollbar-thin"},[e(m)?(r(),y("div",{key:0,class:Se(["w-full flex justify-center",{"flex-1":e(we)}])},[s("div",{class:"flex flex-col space-y-6 w-full",style:Ze({maxWidth:e(b)})},[(r(!0),y(de,null,ke(e(he),(H,$e)=>(r(),y(de,null,[(e($)||H.value===e(We).DATABASE)&&H.list.length?(r(),y("div",{key:$e,class:"integration-type-wrapper"},[s("div",ra,[oe(A(p.$t(H.title))+" ",1),H.isAvailable?k("",!0):(r(),S(ze,{key:0,border:!1,class:"text-nc-content-brand !h-5 bg-nc-bg-brand text-xs font-normal px-2"},{default:n(()=>[oe(A(p.$t("msg.toast.futureRelease")),1)]),_:1}))]),H.list.length?(r(),y("div",ia,[(r(!0),y(de,null,ke(H.list,J=>(r(),y(de,{key:J.sub_type},[e($)||J.isAvailable?(r(),S(He,{key:0,disabled:J==null?void 0:J.isAvailable,placement:"bottom"},{title:n(()=>[oe(A(p.$t("tooltip.comingSoonIntegration")),1)]),default:n(()=>[s("div",{tabindex:0,class:Se(["source-card focus-visible:outline-none outline-none h-full",{"is-available":J==null?void 0:J.isAvailable}]),onClick:yt=>se($e,J)},[s("div",ua,[(r(),S(Be(J.icon),{class:"integration-icon",style:Ze(J.iconStyle)},null,8,["style"]))]),s("div",da,[s("div",pa,A(p.$t(J.title)),1),J.subtitle?(r(),y("div",va,A(p.$t(J.subtitle)),1)):k("",!0)]),!e(fe)&&(J==null?void 0:J.sub_type)===e(Fe).NOCODB?(r(),y("div",ma)):(J==null?void 0:J.sub_type)===e(Fe).NOCODB?(r(),y("div",fa,[e(Te)?(r(),S(ne,{key:0,type:"secondary",size:"xs",class:"integration-upvote-btn !rounded-lg !px-1 !py-0 selected"},{default:n(()=>[s("div",_a,[t(P,{icon:"ncCheck",class:"text-primary flex-none"})])]),_:1})):(r(),S(ne,{key:1,type:"secondary",size:"xs",class:"action-btn !rounded-lg !px-1 !py-0"},{default:n(()=>[s("div",ya,[t(P,{icon:"ncPlus",class:"flex-none"})])]),_:1}))])):J!=null&&J.isAvailable?(r(),S(ne,{key:2,type:"secondary",size:"xs",class:"action-btn !rounded-lg !px-1 !py-0"},{default:n(()=>[s("div",ga,[t(P,{icon:"ncPlus",class:"flex-none"})])]),_:1})):(r(),y("div",ba,[t(ne,{type:"secondary",size:"xs",class:Se(["integration-upvote-btn !rounded-lg !px-1 !py-0",{selected:e(L).has(J.sub_type)}])},{default:n(()=>[s("div",ha,[t(P,{icon:"ncArrowUp"})])]),_:2},1032,["class"])]))],10,ca)]),_:2},1032,["disabled"])):k("",!0)],64))),128))])):k("",!0)])):k("",!0)],64))),256)),e(we)?(r(),y("div",xa,[t(Je,{image:("Empty"in p?p.Empty:e(At)).PRESENTED_IMAGE_SIMPLE,description:p.$t("labels.noData"),class:"!my-0"},null,8,["image","description"])])):k("",!0)],4)],2)):(r(),y("div",Sa,[t(at,{size:"xlarge"})]))],512)],2),t(ct,{visible:e(T).isOpen,"onUpdate:visible":d[11]||(d[11]=H=>e(T).isOpen=H),centered:"",size:"medium",onKeydown:d[12]||(d[12]=ut(H=>e(T).isOpen=!1,["esc"]))},{default:n(()=>{var H;return[fn(s("div",wa,[s("div",$a,[d[17]||(d[17]=s("div",{class:"text-base font-bold text-nc-content-gray"},"Request Integration",-1)),t(ne,{size:"small",type:"text",onClick:d[7]||(d[7]=$e=>e(T).isOpen=!1)},{default:n(()=>[t(P,{icon:"close",class:"text-nc-content-gray-subtle2"})]),_:1})]),s("div",ka,[t(ot,{ref:ie,value:e(T).msg,"onUpdate:value":d[8]||(d[8]=$e=>e(T).msg=$e),class:"!rounded-md !text-sm !min-h-[120px] max-h-[500px] nc-scrollbar-thin",size:"large","hide-details":"",placeholder:"Provide integration name and your use-case."},null,8,["value"])]),s("div",Ia,[t(ne,{size:"small",type:"secondary",onClick:d[9]||(d[9]=$e=>e(T).isOpen=!1)},{default:n(()=>[oe(A(p.$t("general.cancel")),1)]),_:1}),t(ne,{disabled:!((H=e(T).msg)!=null&&H.trim()),loading:e(T).isLoading,size:"small",onClick:d[10]||(d[10]=$e=>e(W)(e(T).msg))},{default:n(()=>[oe(A(p.$t("general.submit")),1)]),_:1},8,["disabled","loading"])])],512),[[_n,e(T).isOpen]])]}),_:1},8,["visible"])]),_:1})]),_:1})]),_:1},40,["visible","class"])}}}),Aa=Object.assign(Ue(Ca,[["__scopeId","data-v-4d15655c"]]),{__name:"WorkspaceIntegrationsTab"}),Ua={};function Ta(w,O){return r(),y("span")}const Ea=Object.assign(Ue(Ua,[["render",Ta]]),{__name:"DashboardSettingsDataSourcesInfo"}),Oa={class:"w-full flex flex-col gap-3"},Da={class:"h-7 w-7 flex items-center justify-center"},Na=["href"],Fa=xe({__name:"SupportedDocs",setup(w){const O=[{title:"Integrations",href:"https://nocodb.com/docs/product-docs/integrations"},{title:"Create new connection",href:"https://nocodb.com/docs/product-docs/integrations/create-connection"},{title:"Add new Data source",href:"https://nocodb.com/docs/product-docs/data-sources/connect-to-data-source"}];return(g,U)=>{const h=Oe;return r(),y("div",Oa,[U[0]||(U[0]=s("div",{class:"text-sm text-gray-800 font-semibold"},"Relevant documentation",-1)),s("div",null,[(r(),y(de,null,ke(O,(x,D)=>s("div",{key:D,class:"flex items-center gap-1"},[s("div",Da,[t(h,{icon:"bookOpen",class:"flex-none w-4 h-4 text-gray-600"})]),s("a",{href:x.href,target:"_blank",rel:"noopener noreferrer",class:"!text-gray-700 text-sm !no-underline !hover:underline"},A(x.title),9,Na)])),64))])])}}}),Qt=Object.assign(Fa,{__name:"WorkspaceIntegrationsSupportedDocs"}),La={key:0,class:"h-full"},Pa={class:"p-4 w-full flex items-center justify-between gap-3 border-b-1 border-gray-200"},Ba={class:"flex-1 flex items-center gap-3"},Ra={key:1,class:"h-8 w-8 flex items-center justify-center children:flex-none bg-gray-200 rounded-lg"},Ma={class:"flex-1 text-base font-weight-700"},za={class:"flex items-center gap-3"},Wa={class:"h-[calc(100%_-_66px)] flex"},ja={class:"nc-edit-or-add-integration-left-panel nc-scrollbar-thin relative"},Va={class:"w-full gap-8 max-w-[768px]"},qa={class:"nc-edit-or-add-connection bg-white relative flex flex-col justify-center gap-2 w-full"},Ka={class:"nc-form-section"},Ga={class:"nc-form-section-body"},Qa={class:"nc-form-section"},Ha={class:"flex items-center justify-between"},Ja={class:"flex items-center gap-2"},Xa={class:"p-4 w-[448px] flex flex-col gap-3"},Ya={class:"flex items-center gap-2 justify-end"},Za={class:"nc-form-section-body"},eo={class:"text-xs text-warning mt-1"},to={class:"text-xs text-warning mt-1"},no={class:"flex flex-col gap-3"},ao={class:"flex gap-2"},oo={class:"flex items-center"},so={class:"flex"},lo={class:"border-1 border-gray-200 rounded-lg p-3"},ro={class:"w-full flex gap-2 items-center"},io={class:"flex-1"},co={class:"flex gap-2 w-full"},uo={class:"flex flex-col gap-2"},po={class:"border-1 border-gray-200 !rounded-lg shadow-sm overflow-hidden"},vo={class:"flex items-center justify-center h-full w-full !bg-white !bg-opacity-85 z-1000"},mo={class:"nc-edit-or-add-integration-right-panel"},fo=3,_o=xe({__name:"index",props:{open:{type:Boolean},connectionType:{},loadDatasourceInfo:{type:Boolean},baseId:{}},emits:["update:open"],setup(w,{emit:O}){const g=w,h=Ge(g,"open",O),x=R(()=>g.connectionType??j.MYSQL),{isFromIntegrationPage:D,pageMode:I,IntegrationsPageMode:B,activeIntegration:_,saveIntegration:Z,updateIntegration:$,integrationsIconMap:N}=Qe(),c=R(()=>I.value===B.EDIT),Y=Ve.useForm,G=M(!1),T=M(!1),F=M(),{api:W}=yn(),{$e:V}=dt(),{t:q}=Et(),ue=M(!1),re=(l=j.MYSQL)=>{var E,C;const a=Bn(l);return"database"in a.connection&&(a.connection.database=""),l===j.SQLITE&&((C=(E=a.connection)==null?void 0:E.connection)!=null&&C.filename)&&(a.connection.connection.filename=""),a},ie=(l=j.MYSQL)=>({title:"",dataSource:{...re(l)},sslUse:ye.No,extraParameters:[],is_private:!1}),o=M(ie()),v=M(ie()),i=M(!1),m=M(!1),b=M(0),L=M([]),te=M([]),ce=M(!1),ee=M(!1),fe=R(()=>ee.value?"Re-enter your password to test or update connection":void 0),Ie=R(()=>c.value?!G.value&&!i.value:!G.value),he=()=>{b.value+=1,b.value>=2&&(m.value=!0)},we=R(()=>Ln.filter(l=>[j.SNOWFLAKE,j.DATABRICKS].includes(l.value)&&m.value||![j.SNOWFLAKE,j.DATABRICKS].includes(l.value))),be=R(()=>{let l={"dataSource.connection.host":[_e()],"dataSource.connection.port":[_e()],"dataSource.connection.user":[_e()],"dataSource.connection.password":[_e()]};switch(o.value.dataSource.client){case j.SQLITE:l={"dataSource.connection.connection.filename":[_e()]};break;case j.SNOWFLAKE:l={"dataSource.connection.account":[_e()],"dataSource.connection.username":[_e()],"dataSource.connection.password":[_e()],"dataSource.connection.warehouse":[_e()],"dataSource.connection.database":[_e()],"dataSource.connection.schema":[_e()]};break;case j.DATABRICKS:l={"dataSource.connection.token":[_e()],"dataSource.connection.host":[_e()],"dataSource.connection.path":[_e()]};break;case j.PG:l["dataSource.searchPath.0"]=[_e()];break}return{title:[{required:!0,message:"Connection name is required"},bn("connection")],extraParameters:[gn],"dataSource.client":[_e()],...l}}),{validate:De,validateInfos:se}=Y(o,be),Ce=()=>{o.value.dataSource={...re(o.value.dataSource.client)}},Ne=l=>{if(o.value.dataSource.client!==j.SQLITE){const a=o.value.dataSource.connection;switch(l){case ye.No:a.ssl=void 0;break;case ye.Allowed:a.ssl="true";break;default:a.ssl={ca:"",cert:"",key:""};break}}},Te=(l=!1)=>{if(o.value.dataSource.client!==j.SQLITE){const a=o.value.dataSource.connection;a.ssl?typeof a.ssl=="string"?o.value.sslUse=ye.Allowed:o.value.sslUse=ye.Preferred:o.value.sslUse=ye.No,l&&(v.value.sslUse=wn(o.value.sslUse),L.value=o.value.sslUse!==ye.No?["1"]:[])}},p=()=>{o.value.extraParameters.push({key:"",value:""})},d=l=>{o.value.extraParameters.splice(l,1)},P=M(""),ne=M(!1),f=M(),z=M(),Ae=M(),Me=(l,a)=>{a&&zn(a,E=>{"ssl"in o.value.dataSource.connection&&typeof o.value.dataSource.connection.ssl=="object"&&(o.value.dataSource.connection.ssl[l]=E??""),a.value=null})},ze=R(()=>!!o.value.sslUse&&o.value.sslUse!==ye.No&&o.value.sslUse!==ye.Allowed);function He(){const l=Object.fromEntries(new Map(o.value.extraParameters.filter(E=>{var C;return(C=E.key)==null?void 0:C.trim()}).map(E=>[E.key,E.value]))),a={...o.value.dataSource.connection,...l};return a.ssl=Hn(a,o.value.sslUse,o.value.dataSource.client),a}const Je=()=>{var l,a,E,C,K;(K=(C=(E=(a=(l=F.value)==null?void 0:l.$el.querySelector(".ant-form-item-explain-error"))==null?void 0:a.parentNode)==null?void 0:E.parentNode)==null?void 0:C.querySelector("input"))==null||K.focus()},at=async()=>{var l;if(!(c.value&&!((l=_.value)!=null&&l.id))){try{await De()}catch{Je();return}try{ue.value=!0;const a=He(),E={...o.value.dataSource,connection:a};c.value?await $({id:_.value.id,title:o.value.title,type:Ut.Database,sub_type:o.value.dataSource.client,config:E,is_private:o.value.is_private}):await Z({title:o.value.title,type:Ut.Database,sub_type:o.value.dataSource.client,config:E,is_private:o.value.is_private},"create",g.loadDatasourceInfo,g.baseId)}catch(a){Le.error(await et(a))}finally{ue.value=!1}}};function ot(l){l&&(o.value.dataSource={...o.value.dataSource,...l,connection:{...o.value.dataSource.connection,...l.connection}})}const Ee=M(),Xe=async(l=0,a=null,E=null)=>{var C;try{await De()}catch(K){if((C=K==null?void 0:K.errorFields)!=null&&C.length){Je();return}}V("a:source:create:extdb:test-connection",[]);try{if(T.value=!0,o.value.dataSource.client===j.SQLITE)G.value=!0,i.value=!0;else{const K=He();K.database=$n(o.value.dataSource);const Q={...o.value.dataSource,connection:K},X=await W.utils.testConnection(Q);X.code===0?(G.value=!0,i.value=!0):(G.value=!1,Le.error(`${q("msg.error.dbConnectionFailed")} ${X.message}`))}}catch(K){const Q=a||JSON.parse(JSON.stringify(o.value.dataSource));await H(K,l,Q,E||K)}finally{T.value=!1}};async function H(l,a,E,C){if(a<fo){const K=Pn(l);if(K)return ot(K),Xe(a+1,E,C)}o.value.dataSource=E||o.value.dataSource,G.value=!1,Ee.value=await et(C||l)}const $e=async()=>{var a;if(!P.value||P.value==="")return;const l=await W.utils.urlToConfig({url:P.value});l?(o.value.dataSource.client=l.client,o.value.dataSource.connection={...l.connection},l.client===j.SQLITE&&(o.value.dataSource.connection.connection={filename:((a=l==null?void 0:l.connection)==null?void 0:a.filename)||""})):Le.error(q("msg.error.invalidURL")),ne.value=!1,Te()},J=R({get:()=>({...o.value}),set:l=>{var a,E,C,K;l&&typeof l=="object"?o.value={...ie(),...l}:o.value=ie((E=(a=o.value)==null?void 0:a.dataSource)!=null&&E.client?(K=(C=o.value)==null?void 0:C.dataSource)==null?void 0:K.client:void 0),Te()}});function yt(){const l=Kt(v.value,o.value);return!(typeof l=="object"&&Object.keys(l).length===1&&(l==null?void 0:l.title)!==void 0)}const gt=l=>{l?L.value=["1"]:(L.value=[],o.value.sslUse=ye.No,Ne(o.value.sslUse))},Jt=l=>{l?(te.value=["1"],Xt(!0,"nc-connection-advanced-options")):te.value=[]};let st;function Xt(l,a){st&&clearTimeout(st),qe(()=>{const E=document.querySelector(`.nc-edit-or-add-connection .${a}`);E&&(st=setTimeout(()=>{E.scrollIntoView({block:"center",behavior:"smooth"})},400))})}const bt=R(()=>{var a,E,C,K;const l=c.value?((a=_.value)==null?void 0:a.sub_type)||((C=(E=_.value)==null?void 0:E.config)==null?void 0:C.client):(K=_.value)==null?void 0:K.type;return N[l]}),ht=()=>{ee.value&&(o.value.dataSource.connection.password="",ee.value=!1)};return Pe(o,()=>{yt()?(G.value=!1,Ee.value=null,i.value=!1):i.value=!0},{deep:!0}),Ke(async()=>{var l,a,E;if(ce.value=!0,I.value===B.ADD)o.value.title=await hn();else{if(!_.value)return;const C=["host","port","user","password","database"],K=Object.entries(_.value.config.connection).filter(([Q])=>!C.includes(Q)).map(([Q,X])=>({key:Q,value:X}));o.value={title:_.value.title||"",dataSource:_.value.config,extraParameters:K,sslUse:ye.No,is_private:(l=_.value)==null?void 0:l.is_private},((E=(a=o.value.dataSource)==null?void 0:a.connection)==null?void 0:E.password)===null&&(ee.value=!0,o.value.dataSource.connection.password="*".repeat(8)),v.value=JSON.parse(JSON.stringify(o.value)),Te(!0)}qe(()=>{setTimeout(()=>{var K,Q;const C=(Q=(K=F.value)==null?void 0:K.$el)==null?void 0:Q.querySelector("input[type=text]");C==null||C.setSelectionRange(0,o.value.title.length),C==null||C.focus()},500)}),ce.value=!1}),Pe(x,l=>{o.value.dataSource.client=l,Ce()},{immediate:!0}),(l,a)=>{var It;const E=Oe,C=Re,K=nt,Q=tt,X=vt,ae=Bt,pe=Pt,Yt=Lt,Zt=Ft,xt=Mt,St=mt,wt=zt,en=Wn,lt=pt,tn=xn,$t=Vn,kt=jn,nn=Fn,an=Ve,on=ft,sn=_t,ln=Ea,rn=Qt;return e(_)?(r(),y("div",La,[s("div",Pa,[s("div",Ba,[!e(c)&&!e(D)?(r(),S(C,{key:0,type:"text",size:"small",onClick:a[0]||(a[0]=u=>I.value=e(B).LIST)},{default:n(()=>[t(E,{icon:"arrowLeft"})]),_:1})):k("",!0),e(bt)?(r(),y("div",Ra,[(r(),S(Be(e(bt)),{class:"!stroke-transparent w-4 h-4"}))])):k("",!0),s("div",Ma,A((It=e(_))==null?void 0:It.title),1)]),s("div",za,[s("div",{class:"w-[15px] h-[15px] cursor-pointer",onDblclick:he},null,32),t(K,{disabled:!e(Ee)},{title:n(()=>[oe(A(e(Ee)),1)]),default:n(()=>[t(C,{type:"secondary",size:"small",class:Se(["nc-extdb-btn-test-connection",{"pointer-events-none":e(G)}]),loading:e(T),disabled:e(ce)||e(ee),"icon-position":"right",onClick:a[1]||(a[1]=u=>Xe())},{icon:n(()=>[e(G)?(r(),S(E,{key:0,icon:"circleCheckSolid",class:"!text-green-700 w-4 h-4"})):e(Ee)?(r(),S(E,{key:1,icon:"alertTriangleSolid",class:"!text-red-700 w-4 h-4"})):k("",!0)]),default:n(()=>[s("span",null,A(e(G)?"Test successful":"Test connection"),1)]),_:1},8,["class","loading","disabled"])]),_:1},8,["disabled"]),t(C,{size:"small",type:"primary",disabled:e(Ie)||e(ce),loading:e(ue),class:"nc-extdb-btn-submit",onClick:at},{default:n(()=>[oe(A(e(I)===e(B).ADD?"Create connection":"Update connection"),1)]),_:1},8,["disabled","loading"]),t(C,{size:"small",type:"text",onClick:a[2]||(a[2]=u=>h.value=!1)},{default:n(()=>[t(E,{icon:"close",class:"text-gray-600"})]),_:1})])]),s("div",Wa,[s("div",ja,[s("div",Va,[s("div",qa,[t(an,{ref_key:"form",ref:F,model:e(o),"hide-required-mark":"",name:"external-base-create-form",layout:"vertical",class:"flex flex-col gap-8"},{default:n(()=>[s("div",Ka,[a[40]||(a[40]=s("div",{class:"nc-form-section-title"},"General",-1)),s("div",Ga,[t(pe,{gutter:24},{default:n(()=>[t(ae,{span:12},{default:n(()=>[t(X,le({label:"Connection name"},e(se).title),{default:n(()=>[t(Q,{value:e(o).title,"onUpdate:value":a[3]||(a[3]=u=>e(o).title=u)},null,8,["value"])]),_:1},16)]),_:1})]),_:1})])]),s("div",Qa,[s("div",Ha,[a[43]||(a[43]=s("div",{class:"nc-form-section-title"},"Connection details",-1)),[e(j).SQLITE,e(j).SNOWFLAKE,e(j).DATABRICKS].includes(e(o).dataSource.client)?k("",!0):(r(),S(Zt,{key:0,visible:e(ne),"onUpdate:visible":a[7]||(a[7]=u=>me(ne)?ne.value=u:null),placement:"bottomRight"},{overlay:n(()=>[s("div",Xa,[a[42]||(a[42]=s("div",{class:"text-sm text-gray-700"}," Auto populate connection configuration using database connection URL ",-1)),t(Yt,{ref:u=>{var ve;(ve=u==null?void 0:u.$el)==null||ve.focus()},value:e(P),"onUpdate:value":a[5]||(a[5]=u=>me(P)?P.value=u:null),class:"!rounded-lg !min-h-[120px] !max-h-[250px] nc-scrollbar-thin"},null,8,["value"]),s("div",Ya,[t(C,{size:"small",type:"secondary",onClick:a[6]||(a[6]=()=>{ne.value=!1,P.value=""})},{default:n(()=>[oe(A(l.$t("general.cancel")),1)]),_:1}),t(C,{size:"small",onClick:$e},{default:n(()=>a[41]||(a[41]=[oe(" Import")])),_:1,__:[41]})])])]),default:n(()=>[t(C,{type:"text",size:"small",class:"nc-extdb-btn-import-url !rounded-md !px-2 flex-none -my-1.5",onClick:a[4]||(a[4]=Rt(u=>ne.value=!0,["stop"]))},{default:n(()=>[s("div",Ja,[t(E,{icon:"ncLink",class:"flex-none"}),oe(" "+A(l.$t("activity.useConnectionUrl")),1)])]),_:1})]),_:1},8,["visible"]))]),s("div",Za,[e(m)?(r(),S(pe,{key:0,gutter:24},{default:n(()=>[t(ae,{span:12},{default:n(()=>[t(X,le({label:l.$t("labels.dbType")},e(se)["dataSource.client"]),{default:n(()=>[t(St,{value:e(o).dataSource.client,"onUpdate:value":a[8]||(a[8]=u=>e(o).dataSource.client=u),class:"nc-select-shadow nc-extdb-db-type","dropdown-class-name":"nc-dropdown-ext-db-type",onChange:Ce},{default:n(()=>[(r(!0),y(de,null,ke(e(we),u=>(r(),S(xt,{key:u.value,value:u.value},{default:n(()=>[oe(A(u.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},16,["label"])]),_:1})]),_:1})):k("",!0),e(o).dataSource.client===e(j).SQLITE?(r(),S(pe,{key:1,gutter:24},{default:n(()=>[t(ae,{span:12},{default:n(()=>[t(X,le({label:l.$t("labels.sqliteFile")},e(se)["dataSource.connection.connection.filename"]),{default:n(()=>[t(Q,{value:e(o).dataSource.connection.connection.filename,"onUpdate:value":a[9]||(a[9]=u=>e(o).dataSource.connection.connection.filename=u),placeholder:"Enter absolute file path"},null,8,["value"])]),_:1},16,["label"])]),_:1})]),_:1})):e(o).dataSource.client===e(j).SNOWFLAKE?(r(),y(de,{key:2},[t(pe,{gutter:24},{default:n(()=>[t(ae,{span:12},{default:n(()=>[t(X,le({label:l.$t("labels.account")},e(se)["dataSource.connection.account"]),{default:n(()=>[t(Q,{value:e(o).dataSource.connection.account,"onUpdate:value":a[10]||(a[10]=u=>e(o).dataSource.connection.account=u),class:"nc-extdb-host-address"},null,8,["value"])]),_:1},16,["label"])]),_:1})]),_:1}),t(pe,{gutter:24},{default:n(()=>[t(ae,{span:12},{default:n(()=>[t(X,le({label:l.$t("labels.username")},e(se)["dataSource.connection.username"]),{default:n(()=>[t(Q,{value:e(o).dataSource.connection.username,"onUpdate:value":a[11]||(a[11]=u=>e(o).dataSource.connection.username=u),class:"nc-extdb-host-user"},null,8,["value"])]),_:1},16,["label"])]),_:1}),t(ae,{span:12},{default:n(()=>[t(X,le({label:l.$t("labels.password"),class:"nc-form-item-connection-password"},e(se)["dataSource.connection.password"]),{help:n(()=>[s("div",eo,A(e(fe)),1)]),default:n(()=>[t(wt,{value:e(o).dataSource.connection.password,"onUpdate:value":a[12]||(a[12]=u=>e(o).dataSource.connection.password=u),class:"nc-extdb-host-password",onFocus:ht},null,8,["value"])]),_:1},16,["label"])]),_:1})]),_:1}),t(pe,{gutter:24},{default:n(()=>[t(ae,{span:12},{default:n(()=>[t(X,le({label:"Warehouse"},e(se)["dataSource.connection.warehouse"]),{default:n(()=>[t(Q,{value:e(o).dataSource.connection.warehouse,"onUpdate:value":a[13]||(a[13]=u=>e(o).dataSource.connection.warehouse=u),class:"nc-extdb-host-database"},null,8,["value"])]),_:1},16)]),_:1}),t(ae,{span:12},{default:n(()=>[t(X,le({label:l.$t("labels.database")},e(se)["dataSource.connection.database"]),{default:n(()=>[t(Q,{value:e(o).dataSource.connection.database,"onUpdate:value":a[14]||(a[14]=u=>e(o).dataSource.connection.database=u),class:"nc-extdb-host-database",placeholder:`${l.$t("labels.database")} ${l.$t("general.name").toLowerCase()}`},null,8,["value","placeholder"])]),_:1},16,["label"])]),_:1})]),_:1}),t(pe,{gutter:24},{default:n(()=>[t(ae,{span:12},{default:n(()=>[t(X,le({label:"Schema"},e(se)["dataSource.connection.schema"]),{default:n(()=>[t(Q,{value:e(o).dataSource.connection.schema,"onUpdate:value":a[15]||(a[15]=u=>e(o).dataSource.connection.schema=u),class:"nc-extdb-host-database"},null,8,["value"])]),_:1},16)]),_:1})]),_:1})],64)):e(o).dataSource.client===e(j).DATABRICKS?(r(),y(de,{key:3},[t(pe,{gutter:24},{default:n(()=>[t(ae,{span:12},{default:n(()=>[t(X,le({label:"Token"},e(se)["dataSource.connection.token"]),{default:n(()=>[t(Q,{value:e(o).dataSource.connection.token,"onUpdate:value":a[16]||(a[16]=u=>e(o).dataSource.connection.token=u),class:"nc-extdb-host-token"},null,8,["value"])]),_:1},16)]),_:1}),t(ae,{span:12},{default:n(()=>[t(X,le({label:"Host"},e(se)["dataSource.connection.host"]),{default:n(()=>[t(Q,{value:e(o).dataSource.connection.host,"onUpdate:value":a[17]||(a[17]=u=>e(o).dataSource.connection.host=u),class:"nc-extdb-host-address"},null,8,["value"])]),_:1},16)]),_:1})]),_:1}),t(pe,{gutter:24},{default:n(()=>[t(ae,{span:12},{default:n(()=>[t(X,le({label:"Path"},e(se)["dataSource.connection.path"]),{default:n(()=>[t(Q,{value:e(o).dataSource.connection.path,"onUpdate:value":a[18]||(a[18]=u=>e(o).dataSource.connection.path=u),class:"nc-extdb-host-path"},null,8,["value"])]),_:1},16)]),_:1}),t(ae,{span:12},{default:n(()=>[t(X,le({label:"Database"},e(se)["dataSource.connection.database"]),{default:n(()=>[t(Q,{value:e(o).dataSource.connection.database,"onUpdate:value":a[19]||(a[19]=u=>e(o).dataSource.connection.database=u),placeholder:`${l.$t("labels.database")} ${l.$t("general.name").toLowerCase()}`,class:"nc-extdb-host-database"},null,8,["value","placeholder"])]),_:1},16)]),_:1})]),_:1}),t(pe,{gutter:24},{default:n(()=>[t(ae,{span:12},{default:n(()=>[t(X,le({label:"Schema"},e(se)["dataSource.connection.schema"]),{default:n(()=>[t(Q,{value:e(o).dataSource.connection.schema,"onUpdate:value":a[20]||(a[20]=u=>e(o).dataSource.connection.schema=u),class:"nc-extdb-host-schema"},null,8,["value"])]),_:1},16)]),_:1})]),_:1})],64)):(r(),y(de,{key:4},[t(pe,{gutter:24},{default:n(()=>[t(ae,{span:12},{default:n(()=>[t(X,le({label:l.$t("labels.hostAddress")},e(se)["dataSource.connection.host"]),{default:n(()=>[t(Q,{value:e(o).dataSource.connection.host,"onUpdate:value":a[21]||(a[21]=u=>e(o).dataSource.connection.host=u),class:"nc-extdb-host-address"},null,8,["value"])]),_:1},16,["label"])]),_:1}),t(ae,{span:12},{default:n(()=>[t(X,le({label:l.$t("labels.port"),class:"nc-form-item-connection-port"},e(se)["dataSource.connection.port"]),{default:n(()=>[t(en,{value:e(o).dataSource.connection.port,"onUpdate:value":a[22]||(a[22]=u=>e(o).dataSource.connection.port=u),class:"!w-full nc-extdb-host-port !rounded-md"},null,8,["value"])]),_:1},16,["label"])]),_:1})]),_:1}),t(pe,{gutter:24},{default:n(()=>[t(ae,{span:12},{default:n(()=>[t(X,le({label:l.$t("labels.username")},e(se)["dataSource.connection.user"]),{default:n(()=>[t(Q,{value:e(o).dataSource.connection.user,"onUpdate:value":a[23]||(a[23]=u=>e(o).dataSource.connection.user=u),class:"nc-extdb-host-user"},null,8,["value"])]),_:1},16,["label"])]),_:1}),t(ae,{span:12},{default:n(()=>[t(X,{label:l.$t("labels.password")},{help:n(()=>[s("div",to,A(e(fe)),1)]),default:n(()=>[t(wt,{value:e(o).dataSource.connection.password,"onUpdate:value":a[24]||(a[24]=u=>e(o).dataSource.connection.password=u),class:"nc-extdb-host-password",onFocus:ht},null,8,["value"])]),_:1},8,["label"])]),_:1})]),_:1}),t(pe,{gutter:24},{default:n(()=>[t(ae,{span:12},{default:n(()=>[t(X,le({label:l.$t("labels.database")},e(se)["dataSource.connection.database"]),{default:n(()=>[t(Q,{value:e(o).dataSource.connection.database,"onUpdate:value":a[25]||(a[25]=u=>e(o).dataSource.connection.database=u),placeholder:`${l.$t("labels.database")} ${l.$t("general.name").toLowerCase()}`,class:"nc-extdb-host-database"},null,8,["value","placeholder"])]),_:1},16,["label"])]),_:1}),t(ae,{span:12},{default:n(()=>[[e(j).PG].includes(e(o).dataSource.client)&&e(o).dataSource.searchPath?(r(),S(X,le({key:0,label:l.$t("labels.schemaName")},e(se)["dataSource.searchPath.0"]),{default:n(()=>[t(Q,{value:e(o).dataSource.searchPath[0],"onUpdate:value":a[26]||(a[26]=u=>e(o).dataSource.searchPath[0]=u)},null,8,["value"])]),_:1},16,["label"])):k("",!0)]),_:1})]),_:1}),[e(j).SQLITE,e(j).SNOWFLAKE,e(j).DATABRICKS].includes(e(o).dataSource.client)?k("",!0):(r(),S(pe,{key:0,gutter:24},{default:n(()=>[t(ae,{span:24},{default:n(()=>[t(X,le({class:"nc-form-extra-connectin-parameters mb-2",label:"Connection parameters"},e(se).extraParameters),{default:n(()=>[s("div",no,[(r(!0),y(de,null,ke(e(o).extraParameters,(u,ve)=>(r(),y("div",{key:ve},[t(pe,{gutter:24},{default:n(()=>[t(ae,{span:12},{default:n(()=>[t(Q,{value:u.key,"onUpdate:value":Ye=>u.key=Ye,placeholder:"Key"},null,8,["value","onUpdate:value"])]),_:2},1024),t(ae,{span:12},{default:n(()=>[s("div",ao,[t(Q,{value:u.value,"onUpdate:value":Ye=>u.value=Ye,placeholder:"Value"},null,8,["value","onUpdate:value"]),t(C,{type:"text",size:"small",onClick:Ye=>d(ve)},{default:n(()=>[t(E,{icon:"delete",class:"flex-none text-gray-500"})]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024)]))),128)),s("div",null,[t(C,{size:"small",type:"secondary",class:"",onClick:p},{default:n(()=>[s("div",oo,[t(E,{icon:"plus"}),a[44]||(a[44]=oe(" Add "))])]),_:1})])])]),_:1},16)]),_:1})]),_:1}))],64))])]),[e(j).SQLITE,e(j).SNOWFLAKE,e(j).DATABRICKS].includes(e(o).dataSource.client)?k("",!0):(r(),y(de,{key:0},[t(lt),t(kt,{"active-key":e(L),"onUpdate:activeKey":a[36]||(a[36]=u=>me(L)?L.value=u:null),ghost:"",class:"!mt-4"},{expandIcon:n(({isActive:u})=>[t(tn,{checked:u,size:"small",onChange:a[27]||(a[27]=ve=>gt(ve))},null,8,["checked"])]),default:n(()=>[t($t,{key:"1",collapsible:"disabled"},{header:n(()=>[s("div",so,[s("div",{class:"nc-form-section-title cursor-pointer",onClick:a[28]||(a[28]=u=>gt(!e(L).length))}," Use SSL ")])]),default:n(()=>[s("div",lo,[t(pe,{gutter:24},{default:n(()=>[t(ae,{span:12},{default:n(()=>[t(X,{label:"SSL mode"},{default:n(()=>[t(St,{value:e(o).sslUse,"onUpdate:value":a[29]||(a[29]=u=>e(o).sslUse=u),class:"nc-select-shadow","dropdown-class-name":"nc-dropdown-ssl-mode",onSelect:Ne},{default:n(()=>[(r(!0),y(de,null,ke(Object.values(e(ye)),u=>(r(),S(xt,{key:u,value:u},{default:n(()=>[s("div",ro,[s("div",io,A(u),1),e(o).sslUse===u?(r(),S(Be(("iconMap"in l?l.iconMap:e(Wt)).check),{key:0,id:"nc-selected-item-icon",class:"text-primary w-4 h-4"})):k("",!0)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),t(pe,{gutter:24},{default:n(()=>[t(ae,{span:24},{default:n(()=>[e(o).sslUse&&![e(ye).No,e(ye).Allowed].includes(e(o).sslUse)?(r(),S(X,{key:0,label:"SSL keys",class:"!mt-3"},{default:n(()=>[s("div",co,[t(K,{placement:"top"},{title:n(()=>[s("span",null,A(l.$t("tooltip.clientCert")),1)]),default:n(()=>[t(C,{size:"small",type:"secondary",disabled:!e(ze),class:"shadow !w-[90px]",onClick:a[30]||(a[30]=u=>{var ve;return(ve=e(Ae))==null?void 0:ve.click()})},{default:n(()=>[oe(A(l.$t("labels.clientCert")),1)]),_:1},8,["disabled"])]),_:1}),t(K,{placement:"top"},{title:n(()=>[s("span",null,A(l.$t("tooltip.clientKey")),1)]),default:n(()=>[t(C,{size:"small",type:"secondary",disabled:!e(ze),class:"shadow !w-[90px]",onClick:a[31]||(a[31]=u=>{var ve;return(ve=e(z))==null?void 0:ve.click()})},{default:n(()=>[oe(A(l.$t("labels.clientKey")),1)]),_:1},8,["disabled"])]),_:1}),t(K,{placement:"top"},{title:n(()=>[s("span",null,A(l.$t("tooltip.clientCA")),1)]),default:n(()=>[t(C,{size:"small",type:"secondary",disabled:!e(ze),class:"shadow !w-[90px]",onClick:a[32]||(a[32]=u=>{var ve;return(ve=e(f))==null?void 0:ve.click()})},{default:n(()=>[oe(A(l.$t("labels.serverCA")),1)]),_:1},8,["disabled"])]),_:1})])]),_:1})):k("",!0)]),_:1})]),_:1}),s("input",{ref_key:"caFileInput",ref:f,type:"file",class:"!hidden",accept:".ca",onChange:a[33]||(a[33]=u=>Me(("CertTypes"in l?l.CertTypes:e(it)).ca,e(f)))},null,544),s("input",{ref_key:"certFileInput",ref:Ae,type:"file",class:"!hidden",accept:".cert",onChange:a[34]||(a[34]=u=>Me(("CertTypes"in l?l.CertTypes:e(it)).cert,e(Ae)))},null,544),s("input",{ref_key:"keyFileInput",ref:z,type:"file",class:"!hidden",accept:".key",onChange:a[35]||(a[35]=u=>Me(("CertTypes"in l?l.CertTypes:e(it)).key,e(z)))},null,544)])]),_:1})]),_:1},8,["active-key"])],64)),[e(j).SQLITE,e(j).SNOWFLAKE,e(j).DATABRICKS].includes(e(o).dataSource.client)?k("",!0):(r(),S(kt,{key:1,"active-key":e(te),"onUpdate:activeKey":a[39]||(a[39]=u=>me(te)?te.value=u:null),ghost:"",class:"nc-connection-advanced-options !mt-4"},{expandIcon:n(({isActive:u})=>[t(C,{type:"text",size:"small",class:"!-ml-1.5",onClick:a[37]||(a[37]=ve=>Jt(!e(te).length))},{default:n(()=>[a[45]||(a[45]=s("div",{class:"nc-form-section-title"},"Advanced options",-1)),t(E,{icon:"chevronDown",class:Se(["ml-2 flex-none cursor-pointer transform transition-transform duration-500",{"!rotate-180":u}])},null,8,["class"])]),_:2,__:[45]},1024)]),default:n(()=>[t($t,{key:"1",collapsible:"disabled"},{header:n(()=>a[46]||(a[46]=[s("span",null,null,-1)])),default:n(()=>[s("div",uo,[a[47]||(a[47]=s("div",null,"Edit Connection JSON",-1)),s("div",po,[t(nn,{modelValue:e(J),"onUpdate:modelValue":a[38]||(a[38]=u=>me(J)?J.value=u:null),class:"nc-connection-json-editor h-[400px] w-full"},null,8,["modelValue"])])])]),_:1})]),_:1},8,["active-key"]))]),_:1},8,["model"]),a[48]||(a[48]=s("div",{class:"mt-10"},null,-1))])]),t(sn,{"model-value":e(ce),inline:"",transition:"",class:"!bg-opacity-15"},{default:n(()=>[s("div",vo,[t(on,{size:"large"})])]),_:1},8,["model-value"])]),s("div",mo,[("isEeUI"in l?l.isEeUI:e(Sn))?(r(),y(de,{key:0},[t(ln,{varient:"new"}),t(lt)],64)):k("",!0),t(rn),t(lt)])])])):k("",!0)}}}),yo=Object.assign(Ue(_o,[["__scopeId","data-v-ac1f5b79"]]),{__name:"WorkspaceIntegrationsFormsEditOrAddDatabase"}),go=xe({__name:"MountedWrapper",emits:["mounted"],setup(w,{emit:O}){const g=O,U=kn();return Ke(()=>{g("mounted")}),(h,x)=>je(h.$slots,"default",In(Cn(e(U))))}}),bo=Object.assign(go,{__name:"NcFormBuilderInputMountedWrapper"}),ho=xe({__name:"SelectBase",props:{value:{}},emits:["update:value"],setup(w,{emit:O}){const h=Ge(w,"value",O),x=An(),D=R(()=>x.basesList.map(I=>({label:I.title,value:I.id})));return(I,B)=>{const _=mt;return r(),S(_,{value:e(h),"onUpdate:value":B[0]||(B[0]=Z=>me(h)?h.value=Z:null),options:e(D)},null,8,["value","options"])}}}),xo=Object.assign(ho,{__name:"NcFormBuilderInputSelectBase"}),So={class:"flex items-center gap-2"},wo={class:"font-bold"},$o=xe({__name:"OAuth",props:{value:{},element:{},haveValue:{type:Boolean}},emits:["update:value"],setup(w,{emit:O}){const g=w,h=Ge(g,"value",O),x=R(()=>g.element.oauthMeta),D=()=>Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),I=(_,Z,$,N=500,c=600)=>{const Y=window.screenX+(window.outerWidth-N)/2,G=window.screenY+(window.outerHeight-c)/2.5;_+=`&state=${$}`;const T=window.open(_,Z,`width=${N},height=${c},left=${Y},top=${G}`);if(!T)throw new Error("Popup blocked");return new Promise((F,W)=>{let V=!1;const q=Un(()=>{if(V){clearInterval(q),W(new Error("Popup closed by user"));return}try{if(V=T.closed,V){clearInterval(q),W(new Error("Popup closed by user"));return}const ue=T.location.href;if(console.log("url",ue),console.log("OAuthConfig.value.redirectUri",x.value.redirectUri),ue.includes(x.value.redirectUri)){const re=new URL(ue).searchParams,ie=re.get(x.value.codeKey||"code");ie?(clearInterval(q),re.get("state")!==$&&W(new Error("Invalid state please try again")),T.close(),F(ie)):W(new Error("No code returned"))}}catch{try{V=T.closed,V&&(clearInterval(q),W(new Error("Popup closed by user")))}catch{}}},500)})},B=async()=>{const _=x.value.authUri,Z=await I(_,`${x.value.provider} OAuth`,D(),500,600);if(!Z){Le.error("Failed to authenticate using OAuth");return}h.value=Z};return(_,Z)=>{const $=Oe,N=Re;return r(),y("div",null,[t(N,{type:"primary",onClick:B},{default:n(()=>[s("div",So,[s("div",wo,"Authenticate With "+A(e(x).provider),1),_.haveValue?(r(),S($,{key:0,icon:"circleCheckSolid",class:"text-success w-6 h-6 bg-white-500"})):k("",!0)])]),_:1})])}}}),ko=Object.assign($o,{__name:"NcFormBuilderInputOAuth"}),Io=(w,O)=>O.split(".").reduce((g,U)=>g?g[U]:null,w.value),Co=(w,O,g)=>{const U=O.split("."),h=U.pop();if(!h)return;const x=U.reduce((D,I)=>(D[I]||(D[I]={}),D[I]),w.value);x[h]=g},[Ao,Uo]=Qn(w=>{const{formSchema:O,onSubmit:g,onChange:U,fetchOptions:h,initialState:x=M({})}=w,D=Ve.useForm,I=M(),B=M(!1),_=M(!1),Z=M(0),$=(v,i,m)=>{const b=i.split("."),L=b.pop();if(!L)return;const te=b.reduce((ce,ee)=>(ce[ee]||(ce[ee]={}),ce[ee]),v);te[L]=m},N=()=>{const v={};for(const i of e(O)||[])i.model&&(i.type===ge.Switch?$(v,i.model,i.defaultValue??!1):i.type===ge.Select?$(v,i.model,i.defaultValue??[]):$(v,i.model,i.defaultValue??""));return v},c=M(N()),Y=v=>Io(c,v),G=(v,i)=>{Co(c,v,i)},T=async v=>{if(!h||!v.fetchOptionsKey)return[];const i=await h(v.fetchOptionsKey);v.options=i},F=v=>{if(!v.condition)return!0;const i=v.condition;function m(b){const L=Y(b.model);return b.value||b.equal?b.value?b.value===L:b.equal===L:b.in?b.in.includes(L):b.empty?Array.isArray(L)?L.length===0:!L:b.notEmpty?Array.isArray(L)?L.length>0:!!L:!1}return Array.isArray(i)?i.every(b=>m(b)):m(i)},W=R(()=>{var m;const v={},i=(m=e(O))==null?void 0:m.filter(b=>F(b));for(const b of i||[])b.category=b.category||jt,v[b.category]||(v[b.category]=[]),v[b.category].push(b);return v}),V=R(()=>{const v={};for(const i of e(O)||[])i.model&&i.validators&&F(i)&&(v[i.model]=i.validators.map(m=>m.type==="required"?{required:!0,message:m.message}:null).filter(m=>m!==null));return v}),{validate:q,clearValidate:ue,validateInfos:re}=D(c,V),ie=async()=>{var v,i,m,b,L;try{await q()}catch(te){return(L=(b=(m=(i=(v=I.value)==null?void 0:v.$el.querySelector(".ant-form-item-explain-error"))==null?void 0:i.parentNode)==null?void 0:m.parentNode)==null?void 0:b.querySelector("input"))==null||L.focus(),{success:!1,details:te}}B.value=!0;try{return{success:!0,result:await(g==null?void 0:g())}}catch(te){return{success:!1,details:te}}finally{B.value=!1}};function o(){if(!(x!=null&&x.value))return!1;const v=Kt(x.value,c.value);return!(typeof v=="object"&&Object.keys(v).length===0)}return Pe(c,()=>{U==null||U(),Z.value++,o()?_.value=!0:_.value=!1},{deep:!0}),Pe(()=>e(O),async()=>{B.value=!0,c.value={...c.value,...N(),...(x==null?void 0:x.value)??{}},qe(ue),B.value=!1},{immediate:!0}),{form:I,formState:c,initialState:x,formSchema:O,formElementsCategorized:W,isLoading:B,isChanged:_,validateInfos:re,clearValidate:ue,validate:q,submit:ie,checkCondition:F,deepReference:Y,setFormState:G,loadOptions:T,changeKey:Z}},"form-builder-helper");function To(){const w=Uo();if(w==null)throw new Error("Please call `useProvideFormBuilderHelper` on the appropriate parent component");return w}const Eo={class:"nc-form-builder nc-scrollbar-thin relative"},Oo={key:0,class:"nc-form-section-title"},Do={class:"nc-form-section-body"},No={class:"flex flex-wrap"},Fo={class:"flex items-center gap-1"},Lo={key:0},Po={key:1,class:"text-red-500"},Bo={class:"text-xs"},Ro={class:"flex items-center aa"},Mo={class:"ml-[6px] font-bold"},zo={class:"text-xs"},Wo={key:0,class:"w-full mt-1 pl-[35px]"},jo={class:"text-xs text-gray-500"},Vo=["data-testid"],qo=["onClick"],Ko={class:"w-full flex items-center gap-2 px-2 py-2 rounded-md hover:bg-gray-100"},Go={key:7,class:"w-full mt-1"},Qo={class:"text-xs text-gray-500"},Ho={class:"flex items-center justify-center h-full w-full !bg-white !bg-opacity-85 z-1000"},Jo=xe({__name:"index",emits:["change"],setup(w,{emit:O}){const g=O,{form:U,formState:h,formSchema:x,formElementsCategorized:D,isLoading:I,validateInfos:B,deepReference:_,setFormState:Z,loadOptions:$,changeKey:N}=To(),{loadIntegrations:c,integrations:Y,eventBus:G,pageMode:T,IntegrationsPageMode:F}=Mn(),W=i=>i.selectMode==="multipleWithInput"?"tags":i.selectMode==="multiple"?"multiple":void 0,V=R(()=>{var i;return(i=e(x))==null?void 0:i.some(m=>m.type===ge.SelectIntegration)}),q=R(()=>V.value?(e(x)||[]).filter(i=>i.type===ge.SelectIntegration&&i.model).reduce((i,m)=>(i[m.model]=Y.value.filter(b=>m.integrationFilter?(!m.integrationFilter.type||m.integrationFilter.type===b.type)&&(!m.integrationFilter.sub_type||m.integrationFilter.sub_type===b.sub_type):!0),i),{}):{}),ue=R(()=>V.value?Object.keys(q.value).reduce((i,m)=>(i[m]=q.value[m].map(b=>({label:b.title,value:b.id})),i),{}):{}),re=M(null),ie=i=>{re.value=null,qe(()=>{T.value=F.LIST,re.value=i})},o=R(()=>{if(!re.value)return{type:()=>!0,sub_type:()=>!0};const i=(e(x)||[]).find(m=>m.model===re.value);return{type:m=>{var b,L;return!((b=i==null?void 0:i.integrationFilter)!=null&&b.type)||m.value===((L=i==null?void 0:i.integrationFilter)==null?void 0:L.type)},sub_type:m=>{var b,L;return!((b=i==null?void 0:i.integrationFilter)!=null&&b.sub_type)||m.sub_type===((L=i==null?void 0:i.integrationFilter)==null?void 0:L.sub_type)}}}),v=(i,m)=>{Z(i,m),g("change",i,m)};return G.on((i,m)=>{i===Tn.INTEGRATION_ADD&&(m!=null&&m.id)&&re.value&&(v(re.value,m.id),re.value=null)}),Pe(()=>e(x),async()=>{V.value&&await c()},{immediate:!0}),(i,m)=>{const b=Oe,L=nt,te=tt,ce=zt,ee=mt,fe=bo,Ie=En,he=Gt,we=Mt,be=On,De=xo,se=ko,Ce=vt,Ne=Ve,Te=Aa,p=Fs,d=ft,P=_t;return r(),y("div",Eo,[t(Ne,{ref_key:"form",ref:U,model:e(h),"hide-required-mark":"",layout:"vertical",class:"flex flex-col gap-4"},{default:n(()=>[(r(!0),y(de,null,ke(Object.keys(e(D)),ne=>(r(),y("div",{key:ne,class:"nc-form-section"},[ne!==e(jt)?(r(),y("div",Oo,A(ne),1)):k("",!0),s("div",Do,[s("div",No,[(r(!0),y(de,null,ke(e(D)[ne],f=>(r(),y(de,{key:f.model},[f.type===e(ge).Space?(r(),y("div",{key:0,style:Ze(`width:${+f.width||100}%`),class:"w-full"},null,4)):(r(),S(Ce,le({key:1,ref_for:!0},e(B)[f.model],{class:"nc-form-item",style:`width:${+f.width||100}%`,required:!1,"data-testid":`nc-form-input-${f.model}`}),{label:n(()=>[s("div",Fo,[[e(ge).Switch].includes(f.type)?k("",!0):(r(),y("span",Lo,A(f.label),1)),f.required?(r(),y("span",Po,"*")):k("",!0),f.helpText&&f.showHintAsTooltip?(r(),S(L,{key:2},{title:n(()=>[s("div",Bo,A(f.helpText),1)]),default:n(()=>[t(b,{icon:"info",class:"text-gray-500 h-4"})]),_:2},1024)):k("",!0)])]),default:n(()=>[f.type===e(ge).Input?(r(),S(te,{key:0,autocomplete:"off",class:"!w-full",value:e(_)(f.model),"onUpdate:value":z=>v(f.model,z)},null,8,["value","onUpdate:value"])):f.type===e(ge).Password?(r(),S(ce,{key:1,readonly:"",onfocus:"this.removeAttribute('readonly');",onblur:"this.setAttribute('readonly', true);",autocomplete:"off",value:e(_)(f.model),"onUpdate:value":z=>v(f.model,z)},null,8,["value","onUpdate:value"])):f.type===e(ge).Select?(r(),S(fe,{key:e(N),onMounted:z=>e($)(f)},{default:n(()=>{var z;return[t(ee,{value:e(_)(f.model),options:f.options,mode:W(f),"show-search":"",loading:f.fetchOptionsKey&&((z=f.options)==null?void 0:z.length)===0,"onUpdate:value":Ae=>v(f.model,Ae)},null,8,["value","options","mode","loading","onUpdate:value"])]}),_:2},1032,["onMounted"])):f.type===e(ge).Switch?(r(),y("div",{key:3,class:Se(["flex flex-col px-2",f.border?"border-1 rounded-lg shadow":""])},[s("div",Ro,[t(Ie,{checked:!!e(_)(f.model),"onUpdate:checked":z=>v(f.model,z)},null,8,["checked","onUpdate:checked"]),s("span",Mo,A(f.label),1),f.helpText?(r(),S(L,{key:0},{title:n(()=>[s("div",zo,A(f.helpText),1)]),default:n(()=>[t(b,{icon:"info",class:"text-gray-500 h-4 ml-1"})]),_:2},1024)):k("",!0)]),f.helpText&&!f.showHintAsTooltip?(r(),y("div",Wo,[s("div",jo,A(f.helpText),1)])):k("",!0)],2)):f.type===e(ge).SelectIntegration?(r(),S(ee,{key:4,value:e(_)(f.model),options:e(ue)[f.model],"dropdown-match-select-width":"",class:"nc-select-shadow",placeholder:"Select Integration","allow-clear":"","show-search":"","onUpdate:value":z=>v(f.model,z)},{dropdownRender:n(({menuNode:z})=>[(r(),S(Be(z))),t(be,{style:{margin:"4px 0"}}),s("div",{class:"px-1.5 flex items-center text-brand-500 text-sm cursor-pointer",onMousedown:m[0]||(m[0]=Rt(()=>{},["prevent"])),onClick:Ae=>ie(f.model)},[s("div",Ko,[t(b,{icon:"plus",class:"flex-none"}),oe(" "+A(i.$t("general.new"))+" "+A(i.$t("general.connection").toLowerCase()),1)])],40,qo)]),default:n(()=>[(r(!0),y(de,null,ke(e(q)[f.model],z=>(r(),S(we,{key:z.id,value:z.id},{default:n(()=>[s("div",{class:"w-full flex gap-2 items-center","data-testid":z.title},[z!=null&&z.sub_type?(r(),S(he,{key:0,type:z.sub_type},null,8,["type"])):k("",!0),t(L,{class:"flex-1 truncate"},{title:n(()=>[oe(A(z.title),1)]),default:n(()=>[oe(" "+A(z.title),1)]),_:2},1024),e(h).fk_integration_id===z.id?(r(),S(Be(e(Wt).check),{key:1,id:"nc-selected-item-icon",class:"text-primary w-4 h-4"})):k("",!0)],8,Vo)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","options","onUpdate:value"])):f.type===e(ge).SelectBase?(r(),S(De,{key:5,value:e(_)(f.model),"onUpdate:value":z=>v(f.model,z)},null,8,["value","onUpdate:value"])):f.type===e(ge).OAuth?(r(),S(se,{key:6,value:e(_)(f.model),element:f,"have-value":!!e(_)(f.model),"onUpdate:value":z=>v(f.model,z)},null,8,["value","element","have-value","onUpdate:value"])):k("",!0),f.helpText&&f.type!==e(ge).Switch&&!f.showHintAsTooltip?(r(),y("div",Go,[s("div",Qo,A(f.helpText),1)])):k("",!0)]),_:2},1040,["style","data-testid"]))],64))),128))])])]))),128))]),_:1},8,["model"]),e(V)&&e(re)?(r(),y(de,{key:0},[t(Te,{"is-modal":"","filter-category":e(o).type,"filter-integration":e(o).sub_type},null,8,["filter-category","filter-integration"]),t(p)],64)):k("",!0),t(P,{"model-value":e(I),inline:"",transition:"",class:"!bg-opacity-15"},{default:n(()=>[s("div",Ho,[t(d,{size:"large"})])]),_:1},8,["model-value"])])}}}),Xo=Object.assign(Ue(Jo,[["__scopeId","data-v-f8387770"]]),{__name:"NcFormBuilder"}),Yo={};function Zo(w,O){return r(),y("div")}const es=Object.assign(Ue(Yo,[["render",Zo]]),{__name:"WorkspaceIntegrationsSyncPanel"}),ts={key:0,class:"h-full"},ns={class:"p-4 w-full flex items-center justify-between gap-3 border-b-1 border-gray-200"},as={class:"flex-1 flex items-center gap-3"},os={key:1,class:"bg-nc-bg-gray-light rounded-md h-8 w-8 flex-none flex items-center justify-center children:flex-none"},ss={class:"flex-1 text-base font-weight-700"},ls={class:"flex items-center gap-3"},rs={class:"h-[calc(100%_-_66px)] flex"},is={class:"nc-edit-or-add-integration-left-panel nc-scrollbar-thin relative"},cs={class:"w-full gap-4 max-w-[784px]"},us={key:0,class:"nc-edit-or-add-integration-right-panel"},ds=xe({__name:"Wrapper",props:{open:{type:Boolean},integrationType:{},integrationSubType:{}},emits:["update:open"],setup(w,{emit:O}){const h=Ge(w,"open",O),{isFromIntegrationPage:x,pageMode:D,IntegrationsPageMode:I,activeIntegration:B,activeIntegrationItem:_}=Qe(),Z=R(()=>D.value===I.EDIT);return($,N)=>{var W,V;const c=Oe,Y=Re,G=Gt,T=Qt,F=pt;return e(B)?(r(),y("div",ts,[s("div",ns,[s("div",as,[!e(Z)&&!e(x)?(r(),S(Y,{key:0,type:"text",size:"small",onClick:N[0]||(N[0]=q=>D.value=e(I).LIST)},{default:n(()=>[t(c,{icon:"arrowLeft"})]),_:1})):k("",!0),(W=e(_))!=null&&W.sub_type?(r(),y("div",os,[t(G,{type:e(_).sub_type,size:e(_).sub_type===e(Fe).NOCODB?"lg":"sm"},null,8,["type","size"])])):k("",!0),s("div",ss,A((V=e(B))==null?void 0:V.title),1)]),s("div",ls,[je($.$slots,"headerRightExtra",{},void 0,!0),je($.$slots,"headerRight",{},void 0,!0),t(Y,{size:"small",type:"text",onClick:N[1]||(N[1]=q=>h.value=!1)},{default:n(()=>[t(c,{icon:"close",class:"text-gray-600"})]),_:1})])]),s("div",rs,[s("div",is,[s("div",cs,[je($.$slots,"leftPanel",{class:"nc-edit-or-add-integration relative flex flex-col justify-center gap-2 w-full"},void 0,!0)])]),je($.$slots,"rightPanel",{class:"nc-edit-or-add-integration-right-panel"},()=>[$.$slots.rightPanel?k("",!0):(r(),y("div",us,[t(T),t(F)]))],!0)])])):k("",!0)}}}),Ht=Object.assign(Ue(ds,[["__scopeId","data-v-0e9d8bba"]]),{__name:"WorkspaceIntegrationsFormsEditOrAddCommonWrapper"}),ps=""+new URL("nocodb-pg-integration.FHQFpA2d.png",import.meta.url).href;function vs(){const{appInfo:w}=Ot(),{$api:O}=dt(),{activeWorkspace:g}=Dt(Nt()),U=M(),h=M(),x=R(()=>{var $;return($=g.value)==null?void 0:$.data_reflection_enabled}),D=R(()=>{var $;return(($=U.value)==null?void 0:$.host)||(w.value.ncSiteUrl?`${new URL(w.value.ncSiteUrl).hostname}`:"")});return{connectionUrl:R(()=>`postgresql://${U.value.username}:${U.value.password}@${D.value}:${U.value.port}/${U.value.database}${h.value?`?options=-c%20search_path%3D${encodeURIComponent(h.value)}`:""}`),connectionHost:D,connectionDetails:U,selectedBase:h,dataReflectionEnabled:x,getConnectionDetails:async $=>{var c;if(!((c=g.value)!=null&&c.id))return;const N=await O.internal.getOperation(g.value.id,rt,{operation:"getDataReflection"});return $&&(h.value=$),U.value=N},createConnectionDetails:async $=>{var N;if((N=g.value)!=null&&N.id){try{const c=await O.internal.postOperation(g.value.id,rt,{operation:"createDataReflection"},{});$&&(h.value=$),U.value=c,g.value.data_reflection_enabled=!0}catch(c){Le.error(await et(c))}return U.value}},deleteConnectionDetails:async()=>{var $;if(($=g.value)!=null&&$.id)try{await O.internal.postOperation(g.value.id,rt,{operation:"deleteDataReflection"},{}),U.value=null,g.value.data_reflection_enabled=!1}catch(N){Le.error(await et(N))}}}}const ms=Vt(()=>qt(()=>import("./BGi5yrxT.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(w=>w.default||w)),fs=Vt(()=>qt(()=>import("./DmPKCP7M.js"),__vite__mapDeps([3,1,2]),import.meta.url).then(w=>w.default||w)),_s={key:0,class:"nc-nocodb-connection-details-placeholder flex flex-col gap-8 w-full h-full items-center justify-center text-center mt-10"},ys={key:1,class:"connection-details bg-white relative h-full flex flex-col w-full"},gs={class:"h-full max-h-[calc(100%_-_65px)] flex"},bs={class:"connection-details-left-panel nc-scrollbar-thin relative"},hs={key:0,class:"h-full w-[768px] mx-auto"},xs={class:"nc-form-section"},Ss={class:"nc-form-section-body"},ws={class:"nc-form-section"},$s={class:"nc-form-section-body"},ks={class:"flex items-center justify-center h-full w-full !bg-white !bg-opacity-85 z-1000"},Is=xe({__name:"index",props:{open:{type:Boolean},integrationType:{},integrationSubType:{}},emits:["update:open"],setup(w,{emit:O}){const g=w,U=O,{connectionDetails:h,connectionUrl:x,connectionHost:D,selectedBase:I,createConnectionDetails:B,getConnectionDetails:_,deleteConnectionDetails:Z,dataReflectionEnabled:$}=vs();return Ke(async()=>{await _()}),(N,c)=>{const Y=Re,G=tt,T=vt,F=Bt,W=Pt,V=ms,q=fs,ue=Ve,re=ft,ie=_t,o=Ht;return r(),S(o,le(g,{"onUpdate:open":c[7]||(c[7]=v=>U("update:open",v))}),Dn({leftPanel:n(({class:v})=>[s("div",{class:Se(v)},[e($)?(r(),y("div",ys,[s("div",gs,[s("div",bs,[e(h)?(r(),y("div",hs,[t(ue,{ref:"form",model:e(h),"hide-required-mark":"",name:"external-base-create-form",layout:"vertical","no-style":"",class:"flex flex-col gap-5.5"},{default:n(()=>[s("div",xs,[c[14]||(c[14]=s("div",{class:"nc-form-section-title"},"General",-1)),s("div",Ss,[t(W,{gutter:24},{default:n(()=>[t(F,{span:12},{default:n(()=>[t(T,{label:"Connection name"},{default:n(()=>[t(G,{value:"NocoDB",disabled:""})]),_:1})]),_:1})]),_:1})])]),s("div",ws,[c[15]||(c[15]=s("div",{class:"flex items-center justify-between"},[s("div",{class:"nc-form-section-title"},"Connection details")],-1)),s("div",$s,[t(W,{gutter:24},{default:n(()=>[t(F,{span:24},{default:n(()=>[t(T,{label:"Connection URL"},{default:n(()=>[t(V,{modelValue:e(x),"onUpdate:modelValue":c[0]||(c[0]=i=>me(x)?x.value=i:null),class:"nc-connection-url"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(W,{gutter:24},{default:n(()=>[t(F,{span:12},{default:n(()=>[t(T,{label:"Host"},{default:n(()=>[t(V,{modelValue:e(D),"onUpdate:modelValue":c[1]||(c[1]=i=>me(D)?D.value=i:null),class:"nc-connection-host"},null,8,["modelValue"])]),_:1})]),_:1}),t(F,{span:12},{default:n(()=>[t(T,{label:"Port"},{default:n(()=>[t(V,{modelValue:e(h).port,"onUpdate:modelValue":c[2]||(c[2]=i=>e(h).port=i),class:"nc-connection-port"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(W,{gutter:24},{default:n(()=>[t(F,{span:12},{default:n(()=>[t(T,{label:"Username"},{default:n(()=>[t(V,{modelValue:e(h).username,"onUpdate:modelValue":c[3]||(c[3]=i=>e(h).username=i),class:"nc-connection-username"},null,8,["modelValue"])]),_:1})]),_:1}),t(F,{span:12},{default:n(()=>[t(T,{label:"Password"},{default:n(()=>[t(V,{modelValue:e(h).password,"onUpdate:modelValue":c[4]||(c[4]=i=>e(h).password=i),password:"",class:"nc-connection-password"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(W,{gutter:24},{default:n(()=>[t(F,{span:12},{default:n(()=>[t(T,{label:"Database"},{default:n(()=>[t(V,{modelValue:e(h).database,"onUpdate:modelValue":c[5]||(c[5]=i=>e(h).database=i),class:"nc-connection-database"},null,8,["modelValue"])]),_:1})]),_:1}),t(F,{span:12},{default:n(()=>[t(T,{label:"Schema"},{default:n(()=>[t(q,{modelValue:e(I),"onUpdate:modelValue":c[6]||(c[6]=i=>me(I)?I.value=i:null),class:"nc-connection-schema"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})])]),c[16]||(c[16]=s("div",null,null,-1))]),_:1,__:[16]},8,["model"])])):(r(),S(ie,{key:1,"model-value":!0,inline:"",transition:"",class:"!bg-opacity-15"},{default:n(()=>[s("div",ks,[t(re,{size:"large"})])]),_:1}))])])])):(r(),y("div",_s,[c[10]||(c[10]=s("img",{src:ps,class:"!w-full !max-w-[864px] flex-none",alt:"NocoDb X Pg integration"},null,-1)),c[11]||(c[11]=s("span",{class:"text-base font-bold"},"Connect with your favorite tools",-1)),c[12]||(c[12]=s("span",{class:"text-sm text-nc-content-gray-subtle2"},"Integrate with your favourite tools by bypassing our APIs",-1)),t(Y,{size:"small",type:"primary",onClick:e(B)},{default:n(()=>c[9]||(c[9]=[oe(" Get connection details ")])),_:1,__:[9]},8,["onClick"]),c[13]||(c[13]=s("div",null,null,-1))]))],2)]),_:2},[e($)?{name:"headerRightExtra",fn:n(()=>[t(Y,{type:"danger",size:"small",onClick:e(Z)},{default:n(()=>c[8]||(c[8]=[oe("Disable connection")])),_:1,__:[8]},8,["onClick"])]),key:"0"}:void 0,e($)?void 0:{name:"rightPanel",fn:n(()=>[]),key:"1"}]),1040)}}}),Cs=Object.assign(Ue(Is,[["__scopeId","data-v-06491d16"]]),{__name:"WorkspaceIntegrationsConnect"}),As={class:"flex items-center gap-2"},Us={key:2},Ts=xe({__name:"index",props:{open:{type:Boolean},integrationType:{},integrationSubType:{}},emits:["update:open"],setup(w,{emit:O}){var re;const g=w,h=Ge(g,"open",O),{pageMode:x,IntegrationsPageMode:D,activeIntegration:I,activeIntegrationItem:B,saveIntegration:_,updateIntegration:Z,testConnection:$}=Qe(),N=R(()=>x.value===D.EDIT),c=M(null),Y=M(!1),G=M({type:g.integrationType,sub_type:g.integrationSubType}),{form:T,formState:F,isLoading:W,initialState:V,submit:q}=Ao({formSchema:(re=B.value)==null?void 0:re.form,initialState:G,onSubmit:async()=>{var ie,o;if(!(N.value&&!((ie=I.value)!=null&&ie.id))){W.value=!0;try{x.value===D.ADD?await _(F.value):await Z({id:(o=I.value)==null?void 0:o.id,...F.value})}catch(v){console.error(v)}finally{W.value=!1}}},onChange:()=>{c.value=null}});Ke(async()=>{var ie,o;if(W.value=!0,x.value===D.ADD)F.value.title=((ie=I.value)==null?void 0:ie.title)||"";else{if(!I.value)return;F.value={title:I.value.title||"",config:I.value.config,is_private:!!((o=I.value)!=null&&o.is_private),...G.value},V.value=JSON.parse(JSON.stringify(F.value))}qe(()=>{setTimeout(()=>{var i,m;const v=(m=(i=T.value)==null?void 0:i.$el)==null?void 0:m.querySelector("input[type=text]");v==null||v.setSelectionRange(0,F.value.title.length),v==null||v.focus()},500)}),W.value=!1});const ue=async()=>{Y.value=!0,c.value=await $(F.value)||null,Y.value=!1};return(ie,o)=>{var ee;const v=Oe,i=nt,m=Re,b=Xo,L=es,te=Ht,ce=Cs;return r(),y(de,null,[e(I)&&((ee=e(B))!=null&&ee.dynamic)?(r(),S(te,le({key:0},g,{"onUpdate:open":o[0]||(o[0]=fe=>h.value=fe)}),{headerRight:n(()=>{var fe,Ie;return[e(B).type==="auth"?(r(),S(m,{key:0,size:"small",type:(fe=e(c))!=null&&fe.success?"ghost":"primary",disabled:e(Y),loading:e(Y),class:"nc-extdb-btn-test-connection",onClick:ue},{default:n(()=>{var he,we;return[s("div",As,[((he=e(c))==null?void 0:he.success)===!0?(r(),S(v,{key:0,icon:"circleCheckSolid",class:"text-success w-4 h-4 bg-white-500"})):k("",!0),((we=e(c))==null?void 0:we.success)===!1?(r(),S(i,{key:1,placement:"top"},{title:n(()=>{var be;return[oe(A((be=e(c))==null?void 0:be.message),1)]}),default:n(()=>[t(v,{icon:"alertTriangleSolid",class:"text-warning w-4 h-4 bg-white-500"})]),_:1})):k("",!0),o[2]||(o[2]=oe(" Test connection "))])]}),_:1},8,["type","disabled","loading"])):k("",!0),t(m,{size:"small",type:"primary",disabled:e(W)||!((Ie=e(c))!=null&&Ie.success)&&e(B).type==="auth",loading:e(W),class:"nc-extdb-btn-submit",onClick:e(q)},{default:n(()=>[oe(A(e(x)===e(D).ADD?"Create integration":"Update integration"),1)]),_:1},8,["disabled","loading","onClick"])]}),leftPanel:n(({class:fe})=>[s("div",{class:Se(fe)},[t(b,{class:"px-2"}),e(B).type==="sync"?(r(),S(L,{key:0,class:"px-2"})):k("",!0),o[3]||(o[3]=s("div",{class:"mt-10"},null,-1))],2)]),_:1},16)):k("",!0),e(I)&&e(I).sub_type===e(Fe).NOCODB?(r(),S(ce,le({key:1},g,{"onUpdate:open":o[1]||(o[1]=fe=>h.value=fe)}),null,16)):(r(),y("div",Us))],64)}}}),Es=Object.assign(Ue(Ts,[["__scopeId","data-v-9b20fd01"]]),{__name:"WorkspaceIntegrationsFormsEditOrAddCommon"}),Os={key:0,class:"h-full"},Ds={key:1,class:"h-full"},Ns=xe({__name:"EditOrAdd",props:{loadDatasourceInfo:{type:Boolean},baseId:{}},setup(w){const O=w,{loadDatasourceInfo:g,baseId:U}=Nn(O),{pageMode:h,IntegrationsPageMode:x,integrationType:D,activeIntegrationItem:I,activeIntegration:B}=Qe(),_=R({get:()=>h.value===x.ADD||h.value===x.EDIT,set:N=>{N||(h.value=null)}}),Z=R(()=>{var N,c,Y,G;return h.value===x.EDIT?((N=B.value)==null?void 0:N.sub_type)||((Y=(c=B.value)==null?void 0:c.config)==null?void 0:Y.client):(G=B.value)==null?void 0:G.type}),$=R(()=>{var N;switch(Z.value){case D.PostgreSQL:return We.DATABASE;case D.MySQL:return We.DATABASE;case D.SQLITE:return We.DATABASE;default:return(N=I.value)==null?void 0:N.type}});return(N,c)=>{const Y=yo,G=Es,T=ct;return r(),S(T,{visible:e(_),"onUpdate:visible":c[2]||(c[2]=F=>me(_)?_.value=F:null),size:"large","wrap-class-name":"nc-modal-edit-or-add-integration",onKeydown:c[3]||(c[3]=ut(F=>_.value=!1,["esc"]))},{default:n(()=>{var F,W,V;return[e($)===e(We).DATABASE&&((F=e(B))==null?void 0:F.sub_type)!==e(Fe).NOCODB?(r(),y("div",Os,[t(Y,{open:e(_),"onUpdate:open":c[0]||(c[0]=q=>me(_)?_.value=q:null),"connection-type":e(Z),"load-datasource-info":e(g),"base-id":e(U)},null,8,["open","connection-type","load-datasource-info","base-id"])])):(r(),y("div",Ds,[t(G,{open:e(_),"onUpdate:open":c[1]||(c[1]=q=>me(_)?_.value=q:null),"integration-type":(W=e(I))==null?void 0:W.type,"integration-sub-type":(V=e(I))==null?void 0:V.sub_type,"load-datasource-info":e(g),"base-id":e(U)},null,8,["open","integration-type","integration-sub-type","load-datasource-info","base-id"])]))]}),_:1},8,["visible"])}}}),Fs=Object.assign(Ns,{__name:"WorkspaceIntegrationsEditOrAdd"});export{Aa as _,Fs as a,Xo as b,Io as d,Ao as u,Hn as v};
