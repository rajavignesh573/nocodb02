import{e as q,a9 as Z,G as m,r as v,fQ as ee,aG as ae,g as J,c as k,o as s,ad as te,ao as oe,K as x,af as se,L as e,ag as N,b as f,ap as ne,w as t,N as U,d as R,t as u,a as i,by as re,I as h,M as A,hA as le,j1 as ce,kk as de,kL as ie,fO as ue,n as w,bd as pe,gz as me,kl as fe,aF as _e,j9 as ve,gX as z,b9 as be,j as ye,Q as ge,bU as we,bK as xe,an as he,fW as ke,fX as Ce,fV as Ie,_ as Be}from"./DRA9KN5F.js";import{u as je,d as $e,a as Fe}from"./D0nVnAxk.js";import{u as Se}from"./BJUOFlKy.js";import"./CbX26EBz.js";const Ee={class:"relative"},Re={key:1,class:"flex justify-end gap-2 py-2 px-3"},Oe={class:"flex children:flex-none relative h-4 w-4"},Ve=q({__name:"JsBarcodeWrapper",props:{barcodeValue:{type:String,required:!0},barcodeFormat:{type:String,required:!0},customStyle:{type:Object,required:!1},showDownload:{type:Boolean,required:!1,default:!1}},emits:["onClickBarcode"],setup(O,{emit:V}){const r=O,B=V,{t:p}=Z(),o=m(ee,v(!1)),l=v(),b=v(!1),C=()=>{try{if(le(l.value,String(r.barcodeValue),{format:r.barcodeFormat,displayValue:!1,margin:0}),r.customStyle&&l.value)for(const a in r.customStyle)l.value.style.setProperty(a,r.customStyle[a]);b.value=!1}catch(a){console.log("e",a),b.value=!0}},c=()=>{l.value&&$e(l.value,`${r.barcodeValue}.png`)},{isCopied:F,performCopy:j}=je(),I=async()=>{if(!l.value)return;if(!await Fe(l.value))throw new Error(p("msg.error.notSupported"))},$=a=>{a.stopPropagation(),B("onClickBarcode")};return ae([()=>r.barcodeValue,()=>r.barcodeFormat,()=>r.customStyle],C),J(C),(a,_)=>{const y=A,S=U,g=ne;return s(),k("div",Ee,[te((s(),k("svg",{ref_key:"barcodeSvgRef",ref:l,class:N({"w-full":!e(o),"w-auto":e(o),"mt-8 mb-4":O.showDownload}),"data-testid":"barcode",onClick:$},null,2)),[[se,!e(b)]]),e(b)?oe(a.$slots,"barcodeRenderError",{key:0}):x("",!0),r.showDownload?(s(),k("div",Re,[f(g,null,{title:t(()=>[R(u(a.$t("labels.clickToCopy")),1)]),default:t(()=>[f(S,{size:"small",type:"secondary",onClick:_[0]||(_[0]=M=>e(j)(I))},{icon:t(()=>[i("div",Oe,[f(re,{name:"icon-fade",duration:200},{default:t(()=>[e(F)?(s(),h(y,{key:0,icon:"check",class:"h-4 w-4 opacity-80"})):(s(),h(y,{key:1,icon:"copy",class:"h-4 w-4 opacity-80"}))]),_:1})])]),default:t(()=>[R(" "+u(e(F)?a.$t("general.copied"):a.$t("general.copy")),1)]),_:1})]),_:1}),f(g,null,{title:t(()=>[R(u(a.$t("labels.clickToDownload")),1)]),default:t(()=>[f(S,{size:"small",type:"secondary",onClick:c},{icon:t(()=>[f(y,{icon:"download",class:"w-4 h-4"})]),default:t(()=>[R(" "+u(a.$t("general.download")),1)]),_:1})]),_:1})])):x("",!0)])}}}),D=Object.assign(Ve,{__name:"VirtualCellBarcodeJsBarcodeWrapper"}),De={class:"flex gap-2 items-center w-full"},Ne={class:"font-weight-700 m-0"},Me={class:"h-5 px-1 bg-nc-bg-gray-medium text-nc-content-gray-subtle2 rounded-md justify-center items-center flex"},Ge={class:"text-sm font-medium"},Le={class:"text-left text-wrap mt-2 text-[#e65100] text-xs","data-testid":"barcode-invalid-input-message"},Te={class:"text-left text-wrap mt-2 text-[#e65100] text-xs","data-testid":"barcode-invalid-input-message"},Pe={key:1,class:"nc-cell-field text-left text-wrap text-[#e65100] text-xs"},We={key:2,class:"nc-cell-field text-left text-wrap mt-2 text-[#e65100] text-xs"},ze=100,qe=q({__name:"Barcode",setup(O){const V=m(ce,!1),r=m(de,v(!1)),B=m(ie),p=m(ue),o=w(()=>String((B==null?void 0:B.value)??"")),l=m(pe),b=w(()=>{var n;return(n=p==null?void 0:p.value.colOptions)==null?void 0:n.fk_barcode_value_column_id}),C=w(()=>o.value.length>ze),c=v(!1),F=m(me,v(!1)),j=m(fe,v(!1)),I=w(()=>F.value&&!j.value),$=w(()=>{var n;return{barcodeFormat:"CODE128",..._e((n=p==null?void 0:p.value)==null?void 0:n.meta)}}),a=()=>c.value=!1,_=w(()=>(o==null?void 0:o.value.length)>0&&!C.value&&(o==null?void 0:o.value)!=="ERR!"),y=()=>{_.value&&(c.value=!0)},{showClearNonEditableFieldWarning:S}=Se({onEnter:y}),g=m(ve,v(void 0)),M=w(()=>I.value?"44px":g.value?`${g.value===1?z[1]-4:z[`${g.value}`]-20}px`:"1.8rem"),H=n=>ye(Ie(n)?ke:Ce,{columnMeta:n});return J(()=>{V&&!r.value&&!I.value&&!j.value&&(c.value=!0)}),(n,d)=>{const K=A,Q=U,X=we,Y=xe;return s(),k(he,null,[f(X,{visible:e(c),"onUpdate:visible":d[1]||(d[1]=E=>ge(c)?c.value=E:null),class:N({active:e(c)}),"wrap-class-name":"nc-barcode-large barcode-modal","body-style":{padding:"0px"},footer:null,closable:!1,onOk:a},{title:t(()=>{var E,G,L,T,P,W;return[i("div",De,[i("h1",Ne,u((E=e(p))==null?void 0:E.title),1),i("div",Me,[(s(),h(be(H((L=(G=e(l))==null?void 0:G.columnsById)==null?void 0:L[e(b)])),{class:"h-4"})),i("div",Ge,u((W=(P=(T=e(l))==null?void 0:T.columnsById)==null?void 0:P[e(b)])==null?void 0:W.title),1)]),d[2]||(d[2]=i("div",{class:"flex-1"},null,-1)),f(Q,{class:"nc-barcode-close !px-1",type:"text",size:"xs",onClick:d[0]||(d[0]=Je=>c.value=!1)},{default:t(()=>[f(K,{class:"text-md text-gray-700 h-4 w-4",icon:"close"})]),_:1})])]}),default:t(()=>[e(_)?(s(),h(D,{key:0,"barcode-value":e(o),"barcode-format":e($).barcodeFormat,"show-download":""},null,8,["barcode-value","barcode-format"])):x("",!0)]),_:1},8,["visible","class"]),e(C)?x("",!0):(s(),k("div",{key:0,class:N(["flex w-full items-center barcode-wrapper",{"justify-start":e(I),"justify-center":!e(I)&&!e(j)}])},[e(_)&&e(g)?(s(),h(D,{key:0,"barcode-value":e(o),tabindex:"-1","barcode-format":e($).barcodeFormat,"custom-style":{height:e(M)},class:"nc-barcode-container",onOnClickBarcode:y},{barcodeRenderError:t(()=>[i("div",Le,u(n.$t("msg.warning.barcode.renderError")),1)]),_:1},8,["barcode-value","barcode-format","custom-style"])):e(_)?(s(),h(D,{key:1,tabindex:"-1","barcode-value":e(o),"barcode-format":e($).barcodeFormat,class:"nc-barcode-container",onOnClickBarcode:y},{barcodeRenderError:t(()=>[i("div",Te,u(n.$t("msg.warning.barcode.renderError")),1)]),_:1},8,["barcode-value","barcode-format"])):!e(_)&&e(o)==="ERR!"?(s(),h(Y,{key:2,placement:"bottom",class:"text-orange-700"},{title:t(()=>d[3]||(d[3]=[i("span",{class:"font-bold"},"Please select a target field!",-1)])),default:t(()=>[d[4]||(d[4]=i("span",null,"ERR!",-1))]),_:1,__:[4]})):x("",!0)],2)),e(C)?(s(),k("div",Pe,u(n.$t("labels.barcodeValueTooLong")),1)):x("",!0),e(S)?(s(),k("div",We,u(n.$t("msg.warning.nonEditableFields.barcodeFieldsCannotBeDirectlyChanged")),1)):x("",!0)],64)}}}),Qe=Object.assign(Be(qe,[["__scopeId","data-v-5f513409"]]),{__name:"VirtualCellBarcode"});export{Qe as default};
