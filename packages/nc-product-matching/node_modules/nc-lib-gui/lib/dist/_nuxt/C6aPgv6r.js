import{e as J,G as w,r as a,b5 as K,bc as X,n as M,gd as Y,dM as Z,fL as tt,J as et,aG as ot,fN as rt,ac as it,I as _,o as i,w as p,b as m,ap as st,L as t,ad as nt,N as lt,ag as v,a as n,K as u,c as F,b9 as at,bo as pt,t as f,d as C,M as mt,Q as x,an as dt,bC as ct,cW as ut,aH as ft,bb as _t,n$ as vt,_ as bt}from"./DRA9KN5F.js";import{u as Ft,_ as ht}from"./DAM89bga.js";import{u as gt}from"./CQa0sIfA.js";import{u as yt}from"./Bw607vNV.js";import{u as wt}from"./Bfaa-xBo.js";import"./C2UaKEE0.js";import"./C_VN1MCC.js";import"./xLIsHrMo.js";import"./D7poRkS0.js";import"./DkDj6Z7Z.js";import"./DCm6TF8M.js";import"./Bj4kMpzI.js";import"./CbSESqy_.js";import"./Bxzk9hCO.js";import"./CbX26EBz.js";import"./Bm6QmuXP.js";import"./CkpISeXq.js";import"./zMMvJhqz.js";import"./GU4raMbz.js";import"./DWLi1ZcL.js";import"./C316Za7m.js";import"./B94p8ToD.js";import"./gAYHr7Gr.js";import"./Cd4chHHL.js";import"./boyBAVNN.js";import"./yMSt-9W5.js";import"./BYKJ-MHf.js";import"./By5RWL3d.js";import"./C2xdh4Xe.js";import"./CI3EriLB.js";import"./owbQkEXm.js";import"./DlXIlcns.js";import"./DP83Cqnl.js";import"./CVZBrAgI.js";import"./LhVKWcKT.js";import"./QeWwuUYP.js";import"./B89wxTuy.js";import"./DjPyxH1k.js";import"./DCa6wpIA.js";import"./B8gs0dG7.js";import"./mXY_vhPu.js";import"./B1qoNiTF.js";import"./CYKJe2Bk.js";import"./DkpDpjnr.js";import"./Dv0nYk-Y.js";import"./CHRPOXXy.js";import"./gByPF8bR.js";import"./BCBMEREK.js";import"./DGFEr0h-.js";import"./DfIS_byq.js";import"./YbUkeyWR.js";import"./lL-0_K96.js";import"./CIOK9Y4w.js";import"./CNwEZGnv.js";import"./BVqTF1QK.js";import"./Ce4xoeky.js";import"./C3FZdmXk.js";import"./DDmv9w84.js";import"./BALLsGq5.js";import"./ytmFgNfN.js";import"./DxC2Oool.js";import"./CC4cUItJ.js";import"./EcM5l_HA.js";import"./BLPDl4Qg.js";import"./CsX17Y_h.js";import"./C_gbauhL.js";import"./BmscXXs6.js";import"./CG-5KGUk.js";import"./CkvAmLZt.js";import"./D7OHpRdS.js";import"./DvtLu3FC.js";import"./D_txg4HT.js";import"./JqUqXTOd.js";import"./I4o4wRE2.js";import"./BMPzbwPk.js";import"./CwPFbl3n.js";import"./C5HnjaiI.js";import"./CBhmoxRW.js";import"./Bc3_tI4-.js";import"./CJAyvGKH.js";import"./D43249YX.js";import"./U3gU45AW.js";import"./BBg0y0zb.js";import"./-iDxnmJF.js";import"./C1XMFoVa.js";import"./C-ZUx0lq.js";import"./YYodiGXA.js";import"./CKrOnbU4.js";const Ct={class:"flex items-center gap-1 min-h-5"},xt={class:"flex items-center gap-2"},kt={key:0,class:"text-capitalize !text-[13px] font-medium"},It={key:0,class:"ml-1 pb-0.6"},Et={class:"px-2 pb-2"},Dt={class:"flex-grow gap-2 flex"},Mt={key:0,class:"bg-[#F0F3FF] px-1 rounded rounded-6px font-medium text-brand-500 h-5"},Tt={class:"p-2"},$t=J({__name:"ColumnFilterMenu",setup(Lt){const V=w(K,a(!1)),h=w(X,a()),T=w(Y,M(()=>!1));w(tt,Z());const{isMobileMode:$}=et(),L=a(),{allFilters:Nt,nestedFilters:A,eventBus:O,filtersFromUrlParams:l,whereQueryFromUrl:j}=gt(),{appearanceConfig:k}=yt(),{nonDeletedFilters:R,loadFilters:G}=Ft(h,void 0,M(()=>!0),()=>!1,A.value,!0),I=a(0);ot(()=>{var o;return(o=h==null?void 0:h.value)==null?void 0:o.id},async o=>{o&&(await G({hookId:void 0,isWebhook:!1,loadAllFilters:!0}),I.value=R.value.length||0)},{immediate:!0});const r=a(!1),q=a({});_t(vt,q),wt(r);const g=a({}),d=a(!1);O.on(async(o,e)=>{e&&o===rt.FILTER_ADD&&(g.value={fk_column_id:e.id},r.value=!0)});const E=M(()=>{var o,e;return I.value+(((e=(o=l.value)==null?void 0:o.filters)==null?void 0:e.length)||0)}),N=a(!1);return(o,e)=>{const y=st,D=mt,z=lt,U=ht,H=ct,P=ut,Q=ft,W=it("e");return i(),_(Q,{visible:t(r),"onUpdate:visible":e[6]||(e[6]=c=>x(r)?r.value=c:null),"overlay-class-name":"nc-dropdown-filter-menu nc-toolbar-dropdown overflow-hidden",class:"!xs:hidden"},{overlay:p(()=>{var c,b,B,S;return[n("div",null,[m(U,{ref_key:"filterComp",ref:L,"draft-filter":t(g),"onUpdate:draftFilter":e[0]||(e[0]=s=>x(g)?g.value=s:null),"is-open":t(r),"onUpdate:isOpen":e[1]||(e[1]=s=>x(r)?r.value=s:null),class:"nc-table-toolbar-menu","auto-save":!0,"data-testid":"nc-filter-menu","is-view-filter":!0,"onUpdate:filtersLength":e[2]||(e[2]=s=>I.value=s)},null,8,["draft-filter","is-open"]),t(l)?(i(),F(dt,{key:0},[m(H,{class:"!my-1"}),n("div",Et,[n("div",{class:v(["leading-5 font-semibold inline-flex w-full items-center cursor-pointer px-2",{"pb-0":!t(d)}]),onClick:e[3]||(e[3]=s=>d.value=!t(d))},[n("div",Dt,[C(f(o.$t("title.urlFilters"))+" ",1),(b=(c=t(l))==null?void 0:c.filters)!=null&&b.length?(i(),F("div",Mt,f(t(l).filters.length),1)):u("",!0),n("div",null,[m(y,{title:o.$t("msg.urlFilter"),placement:"top"},{default:p(()=>[m(D,{icon:"ncInfo",class:"nc-info-icon !w-3.5 !h-3.5"})]),_:1},8,["title"])])]),n("div",Tt,[m(D,{icon:"ncChevronDown",class:v(["nc-chevron-icon transition-all cursor-pointer w-4 h-4",{"transform rotate-180":t(d)}])},null,8,["class"])])],2),n("div",{class:v(["overflow-hidden transition-all duration-300 mt-1",{"max-h-0":!t(d),"max-h-[1000px] overflow-auto":t(d)}])},[t(l).filters?(i(),_(U,{key:t(j),ref_key:"filterComp",ref:L,modelValue:t(l).filters,"onUpdate:modelValue":e[4]||(e[4]=s=>t(l).filters=s),"is-open":t(r),"onUpdate:isOpen":e[5]||(e[5]=s=>x(r)?r.value=s:null),class:"nc-query-filter readonly px-2 pb-2","auto-save":!1,"is-view-filter":!1,"read-only":"","query-filter":""},null,8,["modelValue","is-open"])):(S=(B=t(l))==null?void 0:B.errors)!=null&&S.length?(i(),F("div",{key:1,class:v(["px-2 transition-margin duration-500",{"mb-2":t(d)}])},[m(P,{type:"error",message:"Error",description:o.$t("msg.urlFilterError")},null,8,["description"])],2)):u("",!0)],2)])],64)):u("",!0)])]}),default:p(()=>[m(y,{disabled:!t($)&&!t(T)},{title:p(()=>[C(f(o.$t("activity.filter")),1)]),default:p(()=>[nt((i(),_(z,{class:v(["nc-filter-menu-btn nc-toolbar-btn !border-0 !h-7 group",{[t(k).FILTERED.toolbarBgClass]:t(E)}]),size:"small",type:"secondary","show-as-disabled":t(V)},{default:p(()=>{var c,b;return[n("div",Ct,[n("div",xt,[(i(),_(at(("iconMap"in o?o.iconMap:t(pt)).filter),{class:"h-4 w-4"})),!t($)&&!t(T)?(i(),F("span",kt,f(o.$t("activity.filter")),1)):u("",!0)]),t(E)?(i(),_(y,{key:0,disabled:!t(N),class:"flex"},{title:p(()=>[C(f(o.$t("tooltip.filteredByCurrentUser")),1)]),default:p(()=>[n("span",{class:v(["nc-toolbar-btn-chip inline-flex items-center",{[t(k).FILTERED.toolbarChipBgClass]:!0,[t(k).FILTERED.toolbarTextClass]:!0}])},[C(f(t(E))+" ",1),t(N)?(i(),F("span",It,f("@"))):u("",!0)],2)]),_:1},8,["disabled"])):u("",!0),(b=(c=t(l))==null?void 0:c.errors)!=null&&b.length?(i(),_(y,{key:1,title:o.$t("msg.urlFilterError"),placement:"top"},{default:p(()=>[m(D,{icon:"ncAlertCircle",class:"nc-error-icon w-3.5"})]),_:1},8,["title"])):u("",!0)])]}),_:1},8,["show-as-disabled","class"])),[[W,["c:filter"]]])]),_:1},8,["disabled"])]),_:1},8,["visible"])}}}),_o=Object.assign(bt($t,[["__scopeId","data-v-f9d1d3a3"]]),{__name:"SmartsheetToolbarColumnFilterMenu"});export{_o as default};
