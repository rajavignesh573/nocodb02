import{e as R,el as U,n as f,G as X,Y as Z,T as Y,aG as ee,c as h,o as d,a as u,t as g,L as p,an as I,aq as j,ag as y,K as te}from"./DRA9KN5F.js";import{a as ae}from"./15xfm8CF.js";import"./DkDj6Z7Z.js";import"./CQa0sIfA.js";import"./C2xdh4Xe.js";import"./gAYHr7Gr.js";import"./boyBAVNN.js";const se={class:"flex justify-center px-2 nc-date-week-header text-gray-700 text-sm py-2 font-semibold items-center"},ne={class:"px-2.5"},oe={class:"flex border-b-1 justify-between gap-0.5 border-gray-200"},re=["data-date","onClick","onDblclick"],ie={class:"z-2"},ce=R({__name:"Month",props:{size:{default:"medium"},selectedDate:{default:null},pageDate:{default:U()},activeDates:{default:[]},isMondayFirst:{type:Boolean,default:!0}},emits:["dblClick","update:selectedDate","update:pageDate"],setup(B,{emit:A}){const i=B,c=A,{timezoneDayjs:l,viewMetaProperties:K}=ae(),m=f(()=>{var e;return(e=K.value)!=null&&e.hide_weekend?5:7}),s=X("sharedCalendarCache",Z({dateComparisonCache:new Map,monthComparisonCache:new Map,activeDateCache:new Map,datesCache:new Map,activeDatesByMonth:new Map,clearAllCaches(){this.dateComparisonCache.clear(),this.monthComparisonCache.clear(),this.activeDateCache.clear(),this.datesCache.clear(),this.activeDatesByMonth.clear()},isActiveDateInMonth(e){const t=e.format("YYYY-MM");this.activeDatesByMonth.has(t)||this.activeDatesByMonth.set(t,new Set);const a=this.activeDatesByMonth.get(t);return a?a.has(e.format("YYYY-MM-DD")):!1}})),r=Y(i,"pageDate",c),M=Y(i,"selectedDate",c),b=Y(i,"activeDates",c),$=(e,t)=>`${e==null?void 0:e.format("YYYY-MM-DD")}_${t==null?void 0:t.format("YYYY-MM-DD")}`,w=e=>{var t;return`${e==null?void 0:e.format("YYYY-MM")}_${(t=r.value)==null?void 0:t.format("YYYY-MM")}`},V=()=>{var e,t;return`${(e=r.value)==null?void 0:e.format("YYYY-MM")}_${(t=M.value)==null?void 0:t.format("YYYY-MM-DD")}_${b.value.length}-${m.value}`},F=f(()=>{let e=[];return i.isMondayFirst?e=["Mo","Tu","We","Th","Fr","Sa","Su"]:e=["Su","Mo","Tu","We","Th","Fr","Sa"],m.value===5&&(e=e.filter(t=>t!=="Sa"&&t!=="Su")),e}),O=f(()=>l.dayjsTz(r.value).format("MMMM")),x=(e,t)=>{if(!e||!t)return!1;const a=$(e,t);if(s.dateComparisonCache.has(a))return s.dateComparisonCache.get(a);const n=e.isSame(t,"day");return s.dateComparisonCache.set(a,n),n},W=e=>{if(!M.value)return!1;const t=l.dayjsTz(M.value);return i.selectedDate?x(t,e):!1},S=e=>{const t=w(e);if(s.monthComparisonCache.has(t))return s.monthComparisonCache.get(t);const a=e.month()===l.dayjsTz(r.value).month();return s.monthComparisonCache.set(t,a),a},E=e=>{const t=w(e);if(s.monthComparisonCache.has(t))return s.monthComparisonCache.get(t);const a=e.month()===l.dayjsTz(r.value).month();return s.monthComparisonCache.set(t,a),a},G=e=>s.isActiveDateInMonth(e),L=f(()=>{const e=V();if(s.datesCache.has(e))return s.datesCache.get(e);const t=l.timezonize(r.value.startOf("month")),a=+i.isMondayFirst,n=t.day(),D=t.subtract((n-a+7)%7,"day"),C=[];for(let v=0;v<42;v++){const o=D.add(v,"day"),z=W(o),k=E(o),q=z&&S(o),T=x(o,l.dayjsTz()),H=T&&k,_=o.get("day")===0||o.get("day")===6,J=G(o),Q=o.get("date");m.value===5&&_||C.push({date:o,isSelected:z,isDayInCurrentMonth:k,isSelectedAndIsInCurrentMonth:q,isToday:T,isTodayInCurrentMonth:H,isWeekend:_,isActive:J,dayVal:Q})}return s.datesCache.set(e,C),C}),N=e=>{S(e)||(r.value=e,c("update:pageDate",e)),M.value=e,c("update:selectedDate",e)},P=e=>{c("dblClick",e)};return ee(b,e=>{s.clearAllCaches(),e.forEach(t=>{const a=t.format("YYYY-MM");s.activeDatesByMonth.has(a)||s.activeDatesByMonth.set(a,new Set);const n=s.activeDatesByMonth.get(a);n&&n.add(t.format("YYYY-MM-DD"))})}),(e,t)=>(d(),h("div",null,[u("div",se,g(p(O)),1),u("div",{class:y([{"rounded-lg":e.size==="small","rounded-y-xl":e.size!=="small"},"max-w-[320px]"])},[u("div",ne,[u("div",oe,[(d(!0),h(I,null,j(p(F),(a,n)=>(d(),h("span",{key:n,class:y([{"w-8 h-8 text-sm":e.size==="medium","text-xs w-6 h-6":e.size==="small"},"flex items-center uppercase py-1 font-medium justify-center text-gray-500"])},g(a[0]),3))),128))])]),u("div",{class:y([{"grid-cols-7 gap-x-0.5 ":p(m)===7,"grid-cols-5 gap-x-4 ":p(m)===5},"grid gap-y-2 px-2.5 py-1 nc-date-week-grid-wrapper"])},[(d(!0),h(I,null,j(p(L),(a,n)=>(d(),h("span",{key:n,class:y([{"bg-gray-300 border-1 !font-semibold":a.isSelectedAndIsInCurrentMonth,"hover:border-1 hover:border-gray-200 hover:bg-gray-100":!a.isSelected,"text-gray-400":!a.isDayInCurrentMonth,"text-brand-500 !font-semibold nc-calendar-today":a.isTodayInCurrentMonth,"text-gray-500":a.isWeekend,"h-8 w-8 text-sm":e.size==="medium","h-6 w-6 text-xs":e.size==="small"},"px-1 py-1.5 relative rounded border-transparent transition border-1 font-medium flex text-gray-700 items-center cursor-pointer justify-center"]),"data-testid":"nc-calendar-date","data-date":a.date.format("DD MMM YYYY"),onClick:D=>N(a.date),onDblclick:D=>P(a.date)},[a.isActive?(d(),h("span",{key:0,class:y([{"h-1.25 w-1.25 top-0.5 right-0.5":e.size==="small","h-1.5 w-1.5 top-1 right-1":e.size==="medium","!border-white":a.isDateSelected,"!border-brand-50":a.isToday},"absolute z-2 transition border-1 rounded-full border-white bg-brand-500"])},null,2)):te("",!0),u("span",ie,g(a.dayVal),1)],42,re))),128))],2)],2)]))}}),Me=Object.assign(ce,{__name:"SmartsheetCalendarYearViewMonth"});export{Me as default};
