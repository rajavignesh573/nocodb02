const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DRA9KN5F.js","./entry.CNP42Mi6.css","./DzI8hkox.js","./gAYHr7Gr.js","./PlainCell.CJha1QXQ.css","./Xx6o57R-.js","./QeWwuUYP.js","./index._6B72PDH.css","./BUnSBgDC.js","./i1vswrRY.js","./VRecordCard.CsyjeVpL.css","./Bw607vNV.js","./CQa0sIfA.js","./DkDj6Z7Z.js","./B94p8ToD.js","./Cd4chHHL.js","./boyBAVNN.js","./yMSt-9W5.js","./BYKJ-MHf.js","./By5RWL3d.js","./D7poRkS0.js","./C2xdh4Xe.js","./CI3EriLB.js","./C2UaKEE0.js","./Item.GTPiKSkc.css","./C_VN1MCC.js","./index.CMurbi1o.css","./owbQkEXm.js","./DivDataCell.3R8zfazT.css","./DlXIlcns.js","./DP83Cqnl.js","./CVZBrAgI.js","./LhVKWcKT.js","./B89wxTuy.js","./DjPyxH1k.js","./Markdown.CUPXKfeQ.css","./DCa6wpIA.js","./B8gs0dG7.js","./mXY_vhPu.js","./Comments.DTONmK0N.css","./B1qoNiTF.js","./CbX26EBz.js","./TimeSelector.DAR2lbHN.css","./CYKJe2Bk.js","./DkpDpjnr.js","./Dv0nYk-Y.js","./Cell.BBaBjsLL.css","./CHRPOXXy.js","./gByPF8bR.js","./Modal.CB1oWLel.css","./BCBMEREK.js","./DGFEr0h-.js","./DfIS_byq.js","./YbUkeyWR.js","./lL-0_K96.js","./CIOK9Y4w.js","./CNwEZGnv.js","./BVqTF1QK.js","./Ce4xoeky.js","./C3FZdmXk.js","./index.C8L8AhJa.css","./DDmv9w84.js","./DWLi1ZcL.js","./LockView.BWC8JyQk.css","./BALLsGq5.js","./DCm6TF8M.js","./Bj4kMpzI.js","./CbSESqy_.js","./Bxzk9hCO.js","./Bm6QmuXP.js","./CkpISeXq.js","./index.N-A1gxk9.css","./zMMvJhqz.js","./FilterInput.7KjqjE1F.css","./ytmFgNfN.js","./Pagination.Cmvjwryu.css","./DxC2Oool.js","./VirtualCell.6f0pX0MN.css","./CC4cUItJ.js","./EcM5l_HA.js","./BLPDl4Qg.js","./CsX17Y_h.js","./C_gbauhL.js","./BmscXXs6.js","./ColumnMenu.tCfxYPwr.css","./CG-5KGUk.js","./CkvAmLZt.js","./D7OHpRdS.js","./DvtLu3FC.js","./D_txg4HT.js","./SelectOptions.BDAXdwVJ.css","./JqUqXTOd.js","./I4o4wRE2.js","./BMPzbwPk.js","./CwPFbl3n.js","./C5HnjaiI.js","./CBhmoxRW.js","./Bc3_tI4-.js","./CJAyvGKH.js","./D43249YX.js","./U3gU45AW.js","./BBg0y0zb.js","./-iDxnmJF.js","./EditOrAddProvider.C1S70ahv.css","./C1XMFoVa.js","./C-ZUx0lq.js","./YYodiGXA.js","./C316Za7m.js","./CKrOnbU4.js","./index.DA-8lYYb.css"])))=>i.map(i=>d[i]);
import{e as it,f as ut,r as H,fq as ct,as as dt,G as he,bd as mt,gg as ft,bX as vt,n as le,el as ee,g as wt,bQ as pt,bz as _t,o6 as yt,o5 as ht,aG as He,ac as Mt,c as T,o as z,I as $,K as J,a as E,L as i,cf as Pe,t as se,an as U,aq as te,ag as Me,w as Y,b as G,N as gt,b9 as Le,bo as Ae,d as zt,aX as ie,aH as kt,aj as Be,bZ as Dt,b_ as bt,ad as xt,O as Rt,ba as Tt,a_ as ue,_ as Ct}from"./DRA9KN5F.js";import{_ as Yt}from"./DC2mN-gQ.js";import{_ as St}from"./C2UaKEE0.js";import{_ as Et}from"./C_VN1MCC.js";import{_ as Ot}from"./CI3EriLB.js";import{i as $e,e as W}from"./gAYHr7Gr.js";import{a as jt}from"./15xfm8CF.js";import{u as It}from"./CQa0sIfA.js";import{u as Vt}from"./D7poRkS0.js";import"./DkDj6Z7Z.js";import"./C2xdh4Xe.js";import"./boyBAVNN.js";const Ht=ie(()=>ue(()=>import("./DRA9KN5F.js").then(x=>x.oV),__vite__mapDeps([0,1]),import.meta.url).then(x=>x.default||x)),Pt=ie(()=>ue(()=>import("./DzI8hkox.js"),__vite__mapDeps([2,0,1,3,4]),import.meta.url).then(x=>x.default||x)),Lt=ie(()=>ue(()=>import("./Xx6o57R-.js"),__vite__mapDeps([5,0,1,6,7,8]),import.meta.url).then(x=>x.default||x)),At=ie(()=>ue(()=>import("./i1vswrRY.js"),__vite__mapDeps([9,0,1,8,10]),import.meta.url).then(x=>x.default||x)),Bt=ie(()=>ue(()=>import("./Bw607vNV.js").then(x=>x.R),__vite__mapDeps([11,0,1,12,13,14,3,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,6,7,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109]),import.meta.url).then(x=>x.default||x)),$t={class:"h-[calc(100vh-5.3rem)] overflow-y-auto nc-scrollbar-md"},Ft={class:"flex w-full items-center"},Nt=["onClick","onDblclick"],Zt={class:"w-16 border-b-0 pr-2 pl-2 text-right text-xs text-gray-400 font-semibold h-13"},Ut={class:"w-full"},qt=["onClick","onDblclick"],Gt={class:"flex items-center gap-1"},Wt={class:"ml-1"},Kt={class:"text-xs"},Xt={class:"bg-nc-bg-default px-4 gap-3 flex flex-col py-4 max-h-70 overflow-y-auto"},Jt={key:1,class:"text-gray-500"},Qt={class:"absolute inset-0 pointer-events-none"},eo={class:"relative !ml-[68px] !mr-1 z-2 nc-calendar-day-record-container","data-testid":"nc-calendar-day-record-container"},to=["data-testid","data-unique-id","onMousedown","onMouseover"],oo={class:"text-xs font-medium text-gray-400"},ao=it({__name:"DateTimeField",emits:["expandRecord","newRecord"],setup(x,{emit:Fe}){const oe=Fe,{calDataType:Ne,selectedDate:P,selectedTime:K,formattedData:I,calendarRange:L,formattedSideBarData:ce,updateRowProperty:me,displayField:ae,sideBarFilterOption:ge,showSideMenu:Ze,updateFormat:ze,timezoneDayjs:r,timezone:Ue,isSyncedFromColumn:qe}=jt(),{isSyncedTable:ke}=It(),{$e:De}=ut(),b=H(null),{width:Ge}=ct(b),{isUIAllowed:F}=dt(),N=he(mt,H()),We=he(ft,H()),fe=he(vt,H(!1)),{fields:be}=Vt(),Ke=le(()=>be.value?new Map(be.value.map(e=>[e.fk_column_id,{underline:e.underline,bold:e.bold,italic:e.italic}])):new Map),ve=e=>Ke.value.get(e.id),xe=le(()=>{const e=[],o=ee(P.value).format("YYYY-MM-DD"),s=r.dayjsTz(o,"YYYY-MM-DD").hour(0).minute(0).second(0);for(let u=0;u<24;u++)e.push(s.clone().add(u,"hour"));return e}),Q=H(r.dayjsTz()),Xe=le(()=>{const o=Q.value.minute()+Q.value.hour()*60;return 52/60*o-9}),Je=le(()=>!fe.value&&r.dayjsTz().isSame(P.value,"day"));wt(()=>{const e=pt(()=>{Q.value=r.dayjsTz()},1e4);_t(()=>{clearInterval(e)})});const ne=yt(({endDate:e,startDate:o,scheduleStart:s,scheduleEnd:u})=>(e.isValid()||(e=o.clone().add(15,"minutes")),e.diff(o,"minute")<15&&(e=o.clone().add(15,"minutes")),e.diff(o,"minute")===60&&(e=o.clone().add(59,"minutes")),o.isSameOrBefore(s)&&(o=s),e.isAfter(u)&&(e=u),{endDate:e,startDate:o})),Re=(e,o=!1)=>{const s=e.hour()*60+e.minute();return o?Math.ceil(s):Math.floor(s)},Te=(e,o)=>({from:Re(e,!1),to:Re(o,!0)-1}),Qe=(e,o)=>{var c,v,d;const{fromDate:s,toDate:u}=o;if(!s||!u)return!1;for(const w of e){const h=(c=w.rowMeta.range)==null?void 0:c.fk_from_col,_=(v=w.rowMeta.range)==null?void 0:v.fk_to_col;if(!h)return!1;const{startDate:M,endDate:g}=ne({startDate:r.timezonize(w.row[h.title]),endDate:_&&((d=ee(w.row[_.title]))!=null&&d.isValid())?r.timezonize(w.row[_.title]):r.timezonize(w.row[h.title]).add(1,"hour").subtract(1,"minute"),scheduleStart:r.dayjsTz(P.value).startOf("day"),scheduleEnd:r.dayjsTz(P.value).endOf("day")});if(s.isBetween(M,g,null,"[]")||u.isBetween(M,g,null,"[]"))return!1}return!0},et=({row:e,columnArray:o,graph:s})=>{const u=new Set,c=w=>{u.add(w);let h=1;const _=s.get(w);if(_)for(const M of _){if(h>=o.length)return h;u.has(M)||(h=Math.min(Math.max(h,c(M)+1),o.length))}return h},v=e.rowMeta.id;s.has(v)&&c(v);const d=[];return o.flat().filter(w=>u.has(w.rowMeta.id)).forEach(w=>{d.push(w.rowMeta.overLapIteration)}),Math.max(...d)},k=H(null),re=H(!1),Z=H(null),de=H(),R=H(null),we=H(),pe=H(null),A=le(()=>{var h,_,M,g,V,O,j,n;if(!L.value||!I.value)return{record:[],count:{}};const e=r.dayjsTz(P.value).startOf("day"),o=r.dayjsTz(P.value).endOf("day"),s=52,u=[[]],c=new Map,v=[],d=[];L.value.forEach(t=>{var y;const{fk_from_col:l,fk_to_col:a}=t,p=[...I.value].filter(m=>{const D=l!=null&&l.title&&m.row[l.title]?r.timezonize(m.row[l.title]):null;if(l&&a){const f=m.row[a.title]?r.timezonize(m.row[a.title]):null;return D!=null&&D.isValid()&&(f!=null&&f.isValid())?D.isSame(f,"day")?D.isSameOrBefore(f):(d.push(m),!1):!0}return l?!!D:!1}).sort((m,D)=>r.timezonize(m.row[l.title]).isBefore(r.timezonize(D.row[l.title]))?1:-1);for(const m of p){const D=m.rowMeta.id??ht();if(l&&a){const{endDate:f,startDate:S}=ne({endDate:(y=ee(m.row[a.title]))!=null&&y.isValid()?r.timezonize(m.row[a.title]):ee(m.row[a.title]),startDate:r.timezonize(m.row[l.title]),scheduleStart:e,scheduleEnd:o}),B=(S.minute()/60+S.hour())*s,q={height:`${Math.max(f.diff(S,"minute")/60*52,s)-2}px`,top:`${B+1}px`};v.push({...m,rowMeta:{...m.rowMeta,style:q,id:D,range:t}})}else if(l){const{startDate:f,endDate:S}=ne({startDate:r.timezonize(m.row[l.title]),endDate:r.timezonize(m.row[l.title]).add(1,"hour").subtract(1,"minute"),scheduleStart:e,scheduleEnd:o});let B={};const C=(f.minute()/60+f.hour())*s,q=Math.max(S.diff(f,"minute")/60*52,s);B={...B,top:`${C+1}px`,height:`${q-2}px`},v.push({...m,rowMeta:{...m.rowMeta,range:t,style:B,id:D}})}}}),v.sort((t,l)=>{var y,m;const a=(y=t.rowMeta.range)==null?void 0:y.fk_from_col,p=(m=l.rowMeta.range)==null?void 0:m.fk_from_col;return!a||!p?0:r.timezonize(t.row[a.title]).isBefore(r.timezonize(l.row[p.title]))?-1:1});for(const t of v){const l=(h=t.rowMeta.range)==null?void 0:h.fk_from_col,a=(_=t.rowMeta.range)==null?void 0:_.fk_to_col;if(!l)continue;const{startDate:p,endDate:y}=ne({startDate:r.timezonize(t.row[l.title]),endDate:a&&((M=ee(t.row[a.title]))!=null&&M.isValid())?r.timezonize(t.row[a.title]):r.timezonize(t.row[l.title]).add(1,"hour").subtract(1,"minute"),scheduleStart:e,scheduleEnd:o}),m=Te(p,y);for(let f=m.from;f<=m.to;f++)c.has(f)?c.set(f,{count:c.get(f).count+1,id:[...c.get(f).id,t.rowMeta.id],overflowRecords:[]}):c.set(f,{count:1,id:[t.rowMeta.id],overflowRecords:[]});let D=!1;for(const f in u)if(Qe(u[f],{fromDate:p,toDate:y})){u[f].push(t),D=!0;break}D||u.push([t])}for(const t in u)for(const l of u[t])l.rowMeta.overLapIteration=parseInt(t)+1;const w=new Map;for(const[t,{id:l}]of c)for(const a of l){w.has(a)||w.set(a,new Set);for(const p of l)a!==p&&w.get(a).add(p)}for(const t of v){const l=et({row:t,columnArray:u,graph:w});t.rowMeta.numberOfOverlaps=l;let a,p=100,y="block";if(t.rowMeta.id===((g=k.value)==null?void 0:g.rowMeta.id)||t.rowMeta.id===((V=R.value)==null?void 0:V.rowMeta.id)||!l||l<=0)t.rowMeta.style={...t.rowMeta.style,zIndex:10},p=0,a="100%";else{const D=t.rowMeta.overLapIteration;if(D>8){y="none";const f=(O=t.rowMeta.range)==null?void 0:O.fk_from_col,S=(j=t.rowMeta.range)==null?void 0:j.fk_to_col;if(f){const{startDate:B,endDate:C}=ne({startDate:r.timezonize(t.row[f.title]),endDate:S&&((n=ee(t.row[S.title]))!=null&&n.isValid())?r.timezonize(t.row[S.title]):r.timezonize(t.row[f.title]).add(1,"hour").subtract(1,"minute"),scheduleStart:e,scheduleEnd:o}),q=Te(B,C);for(let X=q.from;X<=q.to;X++)if(c.has(X)){const ye=c.get(X);ye.overflowRecords.some(st=>st.rowMeta.id===t.rowMeta.id)||(ye.overflowRecords.push(t),c.set(X,ye))}}}else{const f=Ge.value-70;a=Math.max(f/Math.min(l,8),180);const S=(f-a*Math.min(l,8))/Math.max(Math.min(l,8)-1,1);p=(a+S)*(D-1),p+a>f&&(a=Math.max(f-p-1.5,180))}}t.rowMeta.style={...t.rowMeta.style,display:y,width:typeof a=="number"?`${a}px`:a,left:`${p}px`}}return{gridTimeMap:c,record:v,spanningRecords:d}}),tt=Tt((e,o,s)=>{me(e,o,s)},500),Ce=(e,o)=>{var j,n;if(!b.value||!k.value)return{newRow:null,updateProperty:[]};const{top:s}=b.value.getBoundingClientRect(),{scrollHeight:u}=b.value,c=(e.clientY-s+b.value.scrollTop)/u,v=(j=k.value.rowMeta.range)==null?void 0:j.fk_from_col,d=(n=k.value.rowMeta.range)==null?void 0:n.fk_to_col,w=Math.max(Math.floor(c*23),0),h=Math.min(Math.max(Math.round(Math.floor((c*23-w)*60)/15)*15,0),60),_=r.timezonize(P.value.startOf("day")).add(w,"hour").add(h,"minute");if(!_||!v)return{newRow:null,updateProperty:[]};let M;const g={...k.value,row:{...k.value.row,[v.title]:r.dayjsTz(_).format(ze.value)}},V=[v.title];if(d){const t=k.value.row[v.title]?r.timezonize(k.value.row[v.title]):null,l=k.value.row[d.title]?r.timezonize(k.value.row[d.title]):null;t&&l?M=r.dayjsTz(_).add(l.diff(t,"hour"),"hour"):t&&!l||!t&&l?M=r.dayjsTz(_).endOf("hour"):M=_.clone(),g.row[d.title]=r.dayjsTz(M).format(ze.value),V.push(d.title)}if(k.value.row[v.title]===g.row[v.title]&&!o)return{newRow:null,updateProperty:[]};if(!g)return{newRow:null,updateProperty:[]};const O=W(g.row,N.value.columns);return Z.value?I.value=I.value.map(t=>W(t.row,N.value.columns)===O?g:t):(I.value=[...I.value,g],ce.value=ce.value.filter(t=>W(t.row,N.value.columns)!==O),k.value={...k.value,row:g.row}),{newRow:g,updateProperty:V}},Ye=e=>{var O,j,n;if(!F("dataEdit")||!b.value||!R.value||(O=R.value.rowMeta.range)!=null&&O.is_readonly)return;const{top:o,bottom:s}=b.value.getBoundingClientRect(),{scrollHeight:u}=b.value;e.clientY>s-20?b.value.scrollTop+=10:e.clientY<o+20&&(b.value.scrollTop-=10);const c=(e.clientY-o+b.value.scrollTop)/u,v=(j=R.value.rowMeta.range)==null?void 0:j.fk_from_col,d=(n=R.value.rowMeta.range)==null?void 0:n.fk_to_col;if(!v||!d)return;const w=r.timezonize(R.value.row[d.title]),h=r.timezonize(R.value.row[v.title]),_=Math.round(c*24*60/15)*15;let M=null,g=[];if(de.value==="right"){let t=r.timezonize(P.value.startOf("day")).add(_,"minute");if(g=[d.title],r.dayjsTz(t).isBefore(h.add(1,"hour"))&&(t=h.clone().add(1,"hour")),!t.isValid())return;M={...R.value,row:{...R.value.row,[d.title]:t.format("YYYY-MM-DD HH:mm:ssZ")}}}else if(de.value==="left"){let t=r.dayjsTz(P.value).startOf("day").add(_,"minute");if(g=[v.title],r.dayjsTz(t).isAfter(w.subtract(1,"hour"))&&(t=r.dayjsTz(w).clone().add(-1,"hour")),!t)return;M={...R.value,row:{...R.value.row,[v.title]:r.dayjsTz(t).format("YYYY-MM-DD HH:mm:ssZ")}}}if(!M)return;const V=W(M.row,N.value.columns);I.value=I.value.map(t=>W(t.row,N.value.columns)===V?M:t),tt(M,g,!1)},Se=()=>{de.value=null,R.value=null,document.removeEventListener("mousemove",Ye),document.removeEventListener("mouseup",Se)},ot=(e,o,s)=>{var u;F("dataEdit")&&((u=s.rowMeta.range)!=null&&u.is_readonly||(de.value=e,R.value=s,document.addEventListener("mousemove",Ye),document.addEventListener("mouseup",Se)))},Ee=e=>{if(!F("dataEdit")||!b.value||!k.value)return;const{top:o,bottom:s}=b.value.getBoundingClientRect();e.clientY>s-20?b.value.scrollTop+=10:e.clientY<o+20&&(b.value.scrollTop-=10),Ce(e)},Oe=e=>{if(e.preventDefault(),clearTimeout(we.value),!F("dataEdit")||!re.value||!b.value||!k.value)return;const{newRow:o,updateProperty:s}=Ce(e,!0);!o&&!s||(Z.value&&(Z.value.style.boxShadow="none",Z.value=null),k.value&&(k.value=null),o&&(me(o,s,!1),De("c:calendar:day:drag-record"),document.removeEventListener("mousemove",Ee),document.removeEventListener("mouseup",Oe)))},at=(e,o)=>{if(qe.value)return;let s=e.target;re.value=!1,we.value=setTimeout(()=>{var c;if(F("dataEdit")&&!((c=o.rowMeta.range)!=null&&c.is_readonly)){for(re.value=!0;!s.classList.contains("draggable-record");)s=s.parentElement;k.value=o,Z.value=s,document.addEventListener("mousemove",Ee),document.addEventListener("mouseup",Oe)}},200);const u=()=>{clearTimeout(we.value),document.removeEventListener("mouseup",u),re.value||oe("expandRecord",o)};document.addEventListener("mouseup",u)},nt=e=>{var s,u,c,v;if(!F("dataEdit")||!b.value)return;e.preventDefault();const o=(s=e.dataTransfer)==null?void 0:s.getData("text/plain");if(o){const{record:d,isWithoutDates:w}=JSON.parse(o);if((u=d.rowMeta.range)!=null&&u.is_readonly)return;const h=(c=d.rowMeta.range)==null?void 0:c.fk_from_col,_=(v=d.rowMeta.range)==null?void 0:v.fk_to_col;if(!h)return;const{top:M}=b.value.getBoundingClientRect(),{scrollHeight:g}=b.value,V=(e.clientY-M+b.value.scrollTop)/g,O=Math.max(Math.floor(V*23),0),j=Math.min(Math.max(Math.round(Math.floor((V*23-O)*60)/15)*15,0),60),n=r.dayjsTz(P.value).startOf("day").add(O,"hour").add(j,"minute");let t;const l={...d,row:{...d.row,[h.title]:r.dayjsTz(n).format("YYYY-MM-DD HH:mm:ssZ")}},a=[h.title];if(_){const y=d.row[h.title]?r.timezonize(d.row[h.title]):null,m=d.row[_.title]?r.timezonize(d.row[_.title]):null;y&&m?t=r.dayjsTz(n).add(m.diff(y,"day"),"day"):y&&!m||!y&&m?t=r.dayjsTz(n).endOf("day"):t=n.clone(),l.row[_.title]=r.dayjsTz(t).format("YYYY-MM-DD HH:mm:ssZ"),a.push(_.title)}if(!l)return;const p=W(l.row,N.value.columns);Z.value&&!w?I.value=I.value.map(y=>W(y.row,N.value.columns)===p?l:y):(I.value=[...I.value,l],ge.value!=="allRecords"&&(ce.value=ce.value.filter(y=>W(y.row,N.value.columns)!==p))),Z.value&&(Z.value.style.boxShadow="none",Z.value=null),me(l,a,!1),De("c:calendar:day:drag-record")}},je=e=>{var v;if(!A.value||!A.value.gridTimeMap)return{isOverflow:!1,overflowCount:0};const{gridTimeMap:o}=A.value,s=e.hour()*60+e.minute(),u=e.hour()*60+e.minute()+59;let c=0;for(let d=s;d<=u;d++){const w=((v=o.get(d))==null?void 0:v.count)??0;c=Math.max(c,w)}return{isOverflow:c-8>0,overflowCount:c-8}},rt=e=>{var d,w,h;if(!A.value||!A.value.gridTimeMap)return{isOverflow:!1,overflowCount:0};const{gridTimeMap:o}=A.value,s=e.hour()*60+e.minute(),u=e.hour()*60+e.minute()+59,c=[],v=new Set;for(let _=s;_<=u;_++){const M=((d=o==null?void 0:o.get(_))==null?void 0:d.overflowRecords)??[];for(const g of M)v.has((w=g.rowMeta)==null?void 0:w.id)||(c.push(g),v.add((h=g.rowMeta)==null?void 0:h.id))}return c},lt=e=>{ge.value="selectedHours",K.value=e,Ze.value=!0},Ie=e=>{K.value=e,k.value=null},_e=e=>{var s;if(!F("dataEdit")||!((s=L.value)!=null&&s.length)||ke.value)return;const o={row:{[L.value[0].fk_from_col.title]:e.format("YYYY-MM-DD HH:mm:ssZ")}};oe("newRecord",o)};He(()=>A.value,()=>{setTimeout(()=>{var o,s;if(re.value)return;const e=document.querySelectorAll(".draggable-record");e.length?(o=e.item(0))==null||o.scrollIntoView({behavior:"smooth",block:"center"}):(s=document.querySelectorAll(".nc-calendar-day-hour").item(9))==null||s.scrollIntoView({behavior:"smooth",block:"center"})},100)},{immediate:!0}),He([()=>Ue],()=>{Q.value=r.dayjsTz()});const Ve=e=>{oe("expandRecord",e)};return(e,o)=>{var j;const s=Yt,u=gt,c=St,v=Ht,d=Et,w=kt,h=Ot,_=Pt,M=Lt,g=At,V=Bt,O=Mt("e");return z(),T("div",$t,[i(L).some(n=>n.fk_to_col!==null&&n.fk_to_col!==void 0)&&((j=i(A).spanningRecords)!=null&&j.length)?(z(),$(s,{key:0,records:i(A).spanningRecords,onExpandRecord:Ve},null,8,["records"])):J("",!0),E("div",{ref_key:"container",ref:b,class:"w-full flex relative no-selection","data-testid":"nc-calendar-day-view",onDrop:nt},[i(Je)?(z(),T("div",{key:0,class:"absolute ml-0.5 pointer-events-none w-full z-4",style:Pe({top:`${i(Xe)}px`})},[E("div",Ft,[E("span",{class:"text-nc-content-inverted-primary bg-nc-content-brand text-xs font-bold rounded-md pointer-events-auto leading-3.5 p-0.5 cursor-pointer",onClick:o[0]||(o[0]=n=>_e(i(Q)))},se(i(Q).format("hh:mm A")),1),o[3]||(o[3]=E("div",{class:"flex-1 relative ml-1 nc-calendar-border-line border-b-2 border-brand-500"},null,-1))])],4)):J("",!0),E("div",null,[(z(!0),T(U,null,te(i(xe),(n,t)=>(z(),T("div",{key:t,class:"flex h-13 relative border-1 group hover:bg-gray-50 border-white","data-testid":"nc-calendar-day-hour",onClick:l=>Ie(n),onDblclick:l=>_e(n)},[E("div",Zt,se(i(r).dayjsTz(n).format("hh a")),1)],40,Nt))),128))]),E("div",Ut,[(z(!0),T(U,null,te(i(xe),(n,t)=>{var l;return z(),T("div",{key:t,class:Me([{"selected-hour":n.isSame(i(K))},"flex w-full border-l-gray-100 h-13 transition nc-calendar-day-hour relative border-1 group hover:bg-gray-50 border-white border-b-gray-100"]),"data-testid":"nc-calendar-day-hour",onClick:a=>Ie(n),onDblclick:a=>_e(n)},[i(L).length>1&&!i(fe)?(z(),$(w,{key:0,class:Me({"!block":n.isSame(i(K)),"!hidden":!n.isSame(i(K))}),"auto-close":""},{overlay:Y(()=>[G(d,{class:"w-64"},{default:Y(()=>[G(c,null,{default:Y(()=>o[4]||(o[4]=[zt(" Select date field to add ")])),_:1,__:[4]}),(z(!0),T(U,null,te(i(L),(a,p)=>(z(),T(U,{key:p},[a.is_readonly?J("",!0):(z(),$(c,{key:0,class:"text-gray-800 font-semibold text-sm",onClick:()=>{let y={row:{[a.fk_from_col.title]:n.format("YYYY-MM-DD HH:mm:ssZ")}};a.fk_to_col&&(y={row:{...y.row,[a.fk_to_col.title]:n.add(1,"hour").format("YYYY-MM-DD HH:mm:ssZ")}}),oe("newRecord",y)}},{default:Y(()=>[E("div",Gt,[G(v,{"column-meta":a.fk_from_col},null,8,["column-meta"]),E("span",Wt,se(a.fk_from_col.title),1)])]),_:2},1032,["onClick"]))],64))),128))]),_:2},1024)]),default:Y(()=>[G(u,{class:"!group-hover:block mr-10 my-auto ml-auto z-10 top-0 bottom-0 !group-hover:block absolute",size:"xsmall",type:"secondary"},{default:Y(()=>[(z(),$(Le(("iconMap"in e?e.iconMap:i(Ae)).plus),{class:"h-4 w-4"}))]),_:1})]),_:2},1032,["class"])):!i(fe)&&i(F)("dataEdit")&&[i(Be).DateTime,i(Be).Date].includes(i(Ne))&&!i(ke)?(z(),T("div",{key:1,class:Me([{"!block":n.isSame(i(K)),"!hidden":!n.isSame(i(K))},"!group-hover:block mr-10 my-auto ml-auto z-10 top-0 bottom-0 !group-hover:block relative"])},[G(h,{entity:i(bt).TABLE,"entity-id":(l=i(N))==null?void 0:l.id,permission:i(Dt).TABLE_RECORD_ADD,placement:"left"},{default:Y(({isAllowed:a})=>[G(u,{size:"xsmall",type:"secondary",disabled:!a,onClick:()=>{let p={row:{[i(L)[0].fk_from_col.title]:n.format("YYYY-MM-DD HH:mm:ssZ")}};i(L)[0].fk_to_col&&(p={row:{...p.row,[i(L)[0].fk_to_col.title]:n.add(1,"hour").format("YYYY-MM-DD HH:mm:ssZ")}}),oe("newRecord",p)}},{default:Y(()=>[(z(),$(Le(("iconMap"in e?e.iconMap:i(Ae)).plus),{class:"h-4 w-4"}))]),_:2},1032,["disabled","onClick"])]),_:2},1032,["entity","entity-id","permission"])],2)):J("",!0),je(n).isOverflow?(z(),$(w,{key:2},{overlay:Y(()=>[E("div",Xt,[(z(!0),T(U,null,te(rt(n),(a,p)=>{var y,m,D;return z(),$(M,{key:p,draggable:!1,class:"w-64","from-date":i(r).timezonize(a.row[a.rowMeta.range.fk_from_col.title]).format("D MMM • h:mm A"),invalid:!1,row:a,"to-date":(D=(m=(y=a==null?void 0:a.rowMeta)==null?void 0:y.range)==null?void 0:m.fk_to_col)!=null&&D.title&&a.row[a.rowMeta.range.fk_to_col.title]?i(r).timezonize(a.row[a.rowMeta.range.fk_to_col.title]).format("DD MMM • HH:mm A"):null,"data-testid":"nc-sidebar-record-card",onClick:f=>Ve(a)},{default:Y(()=>[("isRowEmpty"in e?e.isRowEmpty:i($e))(a,i(ae))?(z(),T("span",Jt," - ")):(z(),$(_,{key:0,modelValue:a.row[i(ae).title],"onUpdate:modelValue":f=>a.row[i(ae).title]=f,column:i(ae)},null,8,["modelValue","onUpdate:modelValue","column"]))]),_:2},1032,["from-date","row","to-date","onClick"])}),128))])]),default:Y(()=>[xt((z(),$(u,{class:"!absolute bottom-2 text-center w-15 mx-auto inset-x-0 z-3 text-gray-500",size:"xxsmall",type:"secondary",onClick:a=>lt(n)},{default:Y(()=>[E("span",Kt," + "+se(je(n).overflowCount)+" more ",1)]),_:2},1032,["onClick"])),[[O,"['c:calendar:week-view-more']"]])]),_:2},1024)):J("",!0)],42,qt)}),128))]),E("div",Qt,[E("div",eo,[(z(!0),T(U,null,te(i(A).record,n=>{var t,l,a;return z(),T(U,{key:n.rowMeta.id},[((t=n.rowMeta.style)==null?void 0:t.display)!=="none"?(z(),T("div",{key:0,"data-testid":`nc-calendar-day-record-${n.row[i(ae).title]}`,"data-unique-id":n.rowMeta.id,style:Pe({...n.rowMeta.style,opacity:(i(k)===null||n.rowMeta.id===((l=i(k))==null?void 0:l.rowMeta.id))&&(i(R)===null||n.rowMeta.id===((a=i(R))==null?void 0:a.rowMeta.id))?1:.3}),class:"absolute draggable-record transition group cursor-pointer pointer-events-auto",onMousedown:p=>at(p,n),onMouseleave:o[1]||(o[1]=p=>pe.value=null),onMouseover:p=>pe.value=n.rowMeta.id,onDragover:o[2]||(o[2]=Rt(()=>{},["prevent"]))},[G(V,{row:n},{default:Y(()=>{var p,y,m,D,f,S,B;return[G(g,{hover:i(pe)===n.rowMeta.id,selected:n.rowMeta.id===((y=(p=i(k))==null?void 0:p.rowMeta)==null?void 0:y.id),record:n,dragging:n.rowMeta.id===((D=(m=i(k))==null?void 0:m.rowMeta)==null?void 0:D.id)||n.rowMeta.id===((S=(f=i(R))==null?void 0:f.rowMeta)==null?void 0:S.id),resize:!!((B=n.rowMeta.range)!=null&&B.fk_to_col)&&i(F)("dataEdit"),onResizeStart:ot},{time:Y(()=>{var C;return[E("div",oo,se(i(r).timezonize(n.row[(C=n.rowMeta.range)==null?void 0:C.fk_from_col.title]).format("h:mm a")),1)]}),default:Y(()=>[(z(!0),T(U,null,te(i(We),(C,q)=>(z(),T(U,{key:q},[("isRowEmpty"in e?e.isRowEmpty:i($e))(n,C)?J("",!0):(z(),$(_,{key:0,modelValue:n.row[C.title],"onUpdate:modelValue":X=>n.row[C.title]=X,class:"text-xs font-medium",bold:ve(C).bold,column:C,italic:ve(C).italic,underline:ve(C).underline},null,8,["modelValue","onUpdate:modelValue","bold","column","italic","underline"]))],64))),128))]),_:2},1032,["hover","selected","record","dragging","resize"])]}),_:2},1032,["row"])],44,to)):J("",!0)],64)}),128))])])],544)])}}}),_o=Object.assign(Ct(ao,[["__scopeId","data-v-2d164e95"]]),{__name:"SmartsheetCalendarDayViewDateTimeField"});export{_o as default};
