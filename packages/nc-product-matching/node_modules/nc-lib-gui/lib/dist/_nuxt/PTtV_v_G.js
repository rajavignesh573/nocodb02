const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DRA9KN5F.js","./entry.CNP42Mi6.css","./BALLsGq5.js","./DCm6TF8M.js","./Bj4kMpzI.js","./CbSESqy_.js","./Bxzk9hCO.js","./CbX26EBz.js","./TimeSelector.DAR2lbHN.css","./Bm6QmuXP.js","./CkpISeXq.js","./index.N-A1gxk9.css","./zMMvJhqz.js","./FilterInput.7KjqjE1F.css","./CI3EriLB.js","./ytmFgNfN.js","./Pagination.Cmvjwryu.css","./gAYHr7Gr.js","./DkDj6Z7Z.js","./CQa0sIfA.js","./DxC2Oool.js","./By5RWL3d.js","./Cd4chHHL.js","./boyBAVNN.js","./B94p8ToD.js","./DfIS_byq.js","./BVqTF1QK.js","./DP83Cqnl.js","./CNwEZGnv.js","./DlXIlcns.js","./Ce4xoeky.js","./VirtualCell.6f0pX0MN.css","./B1qoNiTF.js","./CYKJe2Bk.js","./DkpDpjnr.js","./Dv0nYk-Y.js","./Cell.BBaBjsLL.css","./CfTpfQ4B.js","./VirtualCell.krPvGNjk.css","./CDTi0oRk.js","./Cell.DrFrP4_9.css","./Bw607vNV.js","./yMSt-9W5.js","./BYKJ-MHf.js","./D7poRkS0.js","./C2xdh4Xe.js","./C2UaKEE0.js","./Item.GTPiKSkc.css","./C_VN1MCC.js","./index.CMurbi1o.css","./owbQkEXm.js","./DivDataCell.3R8zfazT.css","./CVZBrAgI.js","./LhVKWcKT.js","./QeWwuUYP.js","./index._6B72PDH.css","./B89wxTuy.js","./DjPyxH1k.js","./Markdown.CUPXKfeQ.css","./DCa6wpIA.js","./B8gs0dG7.js","./mXY_vhPu.js","./Comments.DTONmK0N.css","./CHRPOXXy.js","./gByPF8bR.js","./Modal.CB1oWLel.css","./BCBMEREK.js","./DGFEr0h-.js","./YbUkeyWR.js","./lL-0_K96.js","./CIOK9Y4w.js","./C3FZdmXk.js","./index.C8L8AhJa.css","./DDmv9w84.js","./DWLi1ZcL.js","./LockView.BWC8JyQk.css","./CC4cUItJ.js","./EcM5l_HA.js","./BLPDl4Qg.js","./CsX17Y_h.js","./C_gbauhL.js","./BmscXXs6.js","./ColumnMenu.tCfxYPwr.css","./CG-5KGUk.js","./CkvAmLZt.js","./D7OHpRdS.js","./DvtLu3FC.js","./D_txg4HT.js","./SelectOptions.BDAXdwVJ.css","./JqUqXTOd.js","./I4o4wRE2.js","./BMPzbwPk.js","./CwPFbl3n.js","./C5HnjaiI.js","./CBhmoxRW.js","./Bc3_tI4-.js","./CJAyvGKH.js","./D43249YX.js","./U3gU45AW.js","./BBg0y0zb.js","./-iDxnmJF.js","./EditOrAddProvider.C1S70ahv.css","./C1XMFoVa.js","./C-ZUx0lq.js","./YYodiGXA.js","./C316Za7m.js","./CKrOnbU4.js","./index.DA-8lYYb.css"])))=>i.map(i=>d[i]);
import{e as kt,ak as ro,G as q,r as f,bd as xt,S as co,I as s,o as n,X as uo,L as e,Q as ne,w as l,b as m,bc as mo,fL as po,g8 as fo,dM as vo,g9 as _o,b5 as yo,bX as wo,bb as ge,j9 as go,u as bo,fS as ho,a8 as ko,am as xo,as as Ro,J as Co,W as So,bm as Eo,ef as Io,fQ as Ao,j7 as Lo,gu as Mo,n as G,gg as Vo,ja as Do,aF as Ge,jb as qe,$ as yt,i as To,aG as wt,b1 as $o,ac as jo,c as w,an as Q,a as i,cf as fe,aq as Ke,aH as Bo,aw as Je,ad as Y,K as b,d as k,b9 as D,bo as T,t as p,aA as zo,bZ as Me,b_ as Ve,M as Fo,ag as I,cS as Oo,N as No,b3 as Po,bN as Uo,aL as oe,ap as Ho,aX as ae,iu as We,fV as Xe,ik as Go,O as gt,fg as bt,ba as qo,a_ as le,_ as Ko}from"./DRA9KN5F.js";import{b as Jo,_ as Wo}from"./CkvAmLZt.js";import{_ as Xo}from"./C2UaKEE0.js";import{_ as Qo}from"./CI3EriLB.js";import{_ as Yo}from"./C_VN1MCC.js";import Zo from"./CHRPOXXy.js";import{e as Qe,_ as en}from"./BUnSBgDC.js";import{i as De,f as Te,e as $e}from"./gAYHr7Gr.js";import{i as tn}from"./BYKJ-MHf.js";import{D as ht}from"./D7OHpRdS.js";import{u as on}from"./D7poRkS0.js";import{u as nn}from"./CQa0sIfA.js";import{a as an,b as ln}from"./C2xdh4Xe.js";import{u as sn}from"./DfIS_byq.js";import{S as rn}from"./DlXIlcns.js";import{_ as dn,a as cn,L as un,b as mn}from"./D8vl_16c.js";import{_ as pn}from"./BBg0y0zb.js";import"./D_txg4HT.js";import"./By5RWL3d.js";import"./gByPF8bR.js";import"./BCBMEREK.js";import"./DvtLu3FC.js";import"./DkDj6Z7Z.js";import"./boyBAVNN.js";import"./DP83Cqnl.js";import"./BMPzbwPk.js";const fn=kt({__name:"EditOrAddStack",props:{column:{},optionId:{},isNewStack:{type:Boolean}},emits:["submit","cancel"],setup(u,{emit:x}){const se=u,ie=x,{column:ve,optionId:Z,isNewStack:R}=ro(se),v=q(xt,f()),{formState:M,addOrUpdate:ee}=Jo(v,ve,void 0,void 0,void 0,f(!0)),{getMeta:be}=co(),te=async()=>{var z;await be((z=v.value)==null?void 0:z.id,!0)};async function re(z=!1,$=!0,K){if(!$&&z){ie("submit");return}const _e=await ee(te);z&&_e&&ie("submit",!0,K)}return(z,$)=>{const K=Wo,_e=uo;return n(),s(_e,{modelValue:e(M),"onUpdate:modelValue":$[1]||($[1]=J=>ne(M)?M.value=J:null),"no-style":"",name:"column-create-or-edit",layout:"vertical","data-testid":"add-or-edit-column",class:"w-full flex"},{default:l(()=>[m(K,{value:e(M),"onUpdate:value":$[0]||($[0]=J=>ne(M)?M.value=J:null),"is-kanban-stack":"","option-id":e(Z),"is-new-stack":e(R),onSaveChanges:re},null,8,["value","option-id","is-new-stack"])]),_:1},8,["modelValue"])}}}),vn=Object.assign(fn,{__name:"SmartsheetKanbanEditOrAddStack"}),_n=ae(()=>le(()=>import("./DRA9KN5F.js").then(u=>u.oR),__vite__mapDeps([0,1]),import.meta.url).then(u=>u.default||u)),yn=ae(()=>le(()=>import("./BALLsGq5.js").then(u=>u.V),__vite__mapDeps([2,0,1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]),import.meta.url).then(u=>u.default||u)),wn=ae(()=>le(()=>import("./B1qoNiTF.js").then(u=>u.C),__vite__mapDeps([32,0,1,7,8,33,34,35,24,18,17,22,23,36]),import.meta.url).then(u=>u.default||u)),gn=ae(()=>le(()=>import("./CfTpfQ4B.js"),__vite__mapDeps([37,0,1,21,38]),import.meta.url).then(u=>u.default||u)),bn=ae(()=>le(()=>import("./CDTi0oRk.js"),__vite__mapDeps([39,0,1,21,40]),import.meta.url).then(u=>u.default||u)),hn=ae(()=>le(()=>import("./Bw607vNV.js").then(u=>u.R),__vite__mapDeps([41,0,1,19,18,24,17,22,23,42,43,21,44,45,14,46,47,48,49,50,51,29,27,52,53,54,55,56,57,58,59,60,61,62,32,7,8,33,34,35,36,63,64,65,66,67,25,68,69,70,28,26,30,71,72,73,74,75,2,3,4,5,6,9,10,11,12,13,15,16,20,31,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107]),import.meta.url).then(u=>u.default||u)),kn=ae(()=>le(()=>import("./Bw607vNV.js").then(u=>u.i),__vite__mapDeps([41,0,1,19,18,24,17,22,23,42,43,21,44,45,14,46,47,48,49,50,51,29,27,52,53,54,55,56,57,58,59,60,61,62,32,7,8,33,34,35,36,63,64,65,66,67,25,68,69,70,28,26,30,71,72,73,74,75,2,3,4,5,6,9,10,11,12,13,15,16,20,31,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107]),import.meta.url).then(u=>u.default||u)),xn={class:"flex flex-col w-full bg-gray-50 h-full","data-testid":"nc-kanban-wrapper",style:{minHeight:"calc(100% - var(--topbar-height))"}},Rn={key:0,class:"flex flex-row min-h-full gap-x-2"},Cn={class:"flex gap-3"},Sn=["data-testid"],En={key:0,class:"mt-2.5 px-3 !w-full"},In={"data-testid":"nc-kanban-stack-title",class:"text-ellipsis overflow-hidden",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},An={class:"flex gap-2 items-center"},Ln={class:"flex gap-2 items-center"},Mn={class:"flex gap-2 items-center"},Vn={class:"flex gap-2 items-center"},Dn={class:"flex gap-2 items-center"},Tn={class:"flex gap-2 items-center"},$n=["data-stack-title"],jn={class:"nc-kanban-item py-1 first:pt-2 last:pb-2"},Bn={class:"z-10 arrow"},zn={class:"z-10 arrow"},Fn={key:1,class:"h-52 w-full !flex flex-row !border-b-1 !border-gray-200 items-center justify-center bg-white"},On={class:"flex-1 flex content-stretch gap-3 w-full"},Nn=["onClick"],Pn={class:"flex flex-col rounded-lg w-full"},Un={class:"flex flex-row w-full justify-start"},Hn={class:"nc-card-col-header w-full !children:text-gray-500"},Gn={key:0,class:"flex flex-row w-full text-gray-800 items-center justify-start min-h-7 py-1"},qn={key:1,class:"flex flex-row w-full h-7 pl-1 items-center justify-start"},Kn={class:"h-full w-full flex flex-col gap-4 items-center justify-center"},Jn={class:"flex flex-col items-center gap-2 text-gray-600 text-center"},Wn={class:"text-sm font-semibold"},Xn={class:"text-xs font-weight-500"},Qn={class:"flex items-center gap-2"},Yn={class:"flex items-center justify-between"},Zn={class:"flex items-center gap-2"},ea={key:1},ta={class:"nc-kanban-data-count text-gray-500 font-weight-500 px-1"},oa=["onClick"],na={key:0,class:"!w-full !h-full flex items-center justify-center"},aa={key:1,class:"nc-kanban-stack-head w-full flex items-center justify-between gap-2"},la={class:"flex items-center gap-1"},sa={class:"flex-1 flex max-w-[115px]"},ia={"data-testid":"nc-kanban-stack-title",class:"text-ellipsis overflow-hidden",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},ra={class:"flex items-center gap-2 truncate"},da={class:"nc-kanban-data-count px-1 rounded bg-gray-200 text-gray-800 text-sm font-weight-500 truncate",style:{"word-break":"keep-all","white-space":"nowrap"}},ca={key:0,class:"nc-kanban-add-new-stack"},ua={key:0,class:"mt-2.5 px-3 !w-full"},ma={class:"flex items-center gap-2"},pa={class:"flex items-center gap-2 nc-kanban-context-menu-item"},fa={class:"flex items-center gap-2 nc-kanban-context-menu-item"},va={key:0,class:"text-nc-content-gray flex flex-col gap-3"},_a=100,ya=kt({__name:"Kanban",setup(u){const x=q(xt,f()),se=q(mo,f()),ie=q(po),ve=q(fo),Z=q(_o,vo()),R=q(yo,f(!1)),v=q(wo,f(!1)),M=f(!1),ee=f(),be=f();ge(go,f(1));const te=f(!1),re=f(""),z=f(0),$=bo(),K=$.currentRoute,{getPossibleAttachmentSrc:_e}=ho(),{metaColumnById:J}=on(),{isSyncedTable:he}=nn(),{loadKanbanData:Ye,loadMoreKanbanData:Rt,loadKanbanMeta:ke,kanbanMetaData:xe,formattedData:j,updateOrSaveRow:Ct,updateKanbanMeta:St,addEmptyRow:Et,groupingFieldColOptions:C,updateKanbanStackMeta:je,groupingField:Ze,groupingFieldColumn:de,countByStack:S,deleteStack:It,shouldScrollToRight:et,deleteRow:At,moveHistory:tt,addNewStackId:Be,removeRowFromUncategorizedStack:Lt,uncategorizedStackId:Mt}=an(),{isViewDataLoading:Re}=ko(xo()),{isUIAllowed:ze}=Ro(),{appInfo:Vt,isMobileMode:ot}=Co(),{addUndo:Dt,defineViewScope:Tt}=So(),{showRecordPlanLimitExceededModal:$t}=Eo(),{withLoading:jt}=sn();ge(Io,f(!1)),ge(Ao,f(!1)),ge(Lo,f(!1)),ge(Mo,f(!0));const E=G(()=>{var t;return ze("dataEdit")&&(!he.value||!((t=de.value)!=null&&t.readonly))}),nt=q(Vo,f([])),Bt=G(()=>nt.value.filter(t=>!Do(t))),A=G(()=>{var t,o;return((o=(t=x.value)==null?void 0:t.columns)==null?void 0:o.find(r=>r.pv&&nt.value.includes(r)))??null}),ce=G(()=>{var t,o;return(t=x.value)!=null&&t.columnsById?x.value.columnsById[(o=xe.value)==null?void 0:o.fk_cover_image_col_id]:{}}),zt=G(()=>{var o,r;const t=((r=Ge((o=xe.value)==null?void 0:o.meta))==null?void 0:r.fk_cover_image_object_fit)||qe.FIT;if(t===qe.FIT)return"contain";if(t===qe.COVER)return"cover"}),Ft=G(()=>{var t;return!!((t=de.value)!=null&&t.rqd)}),{isRowColouringEnabled:Fe}=ln(),Ce=f(),Oe=f("");ie==null||ie.on(jt(async()=>{await ke(),await Ye()}));const Ne=t=>{var o;if(!((o=ce.value)!=null&&o.title)||!t.row[ce.value.title])return[];try{const r=typeof t.row[ce.value.title]=="string"?JSON.parse(t.row[ce.value.title]):t.row[ce.value.title];return Array.isArray(r)?r.flat().map(_=>typeof _=="string"?JSON.parse(_):_).filter(_=>_&&!Array.isArray(_)&&typeof _=="object"&&Object.keys(_).length):[]}catch{return[]}},Pe=f(!1);ve==null||ve.on(async()=>{await ke(),Pe.value=!0,yt(()=>{Pe.value=!1})});const Se=(t,o)=>{const r=$e(t.row,x.value.columns);be.value=o,r&&!v.value?(ee.value=void 0,$.push({query:{...K.value.query,rowId:r}})):(ee.value=t,M.value=!0)},at=f(!1),ue=G({get:()=>at.value,set:t=>{E.value&&(at.value=t)}}),me=f(null),Ot=(t,o)=>{t.preventDefault(),o&&(me.value=o)},Ee=G({get(){return!!K.value.query.rowId},set(t){t||$.push({query:{...K.value.query,rowId:void 0}})}}),Nt=async(t,o)=>{const r=t.target;r.closest(".arrow")||r.closest(".slick-dots")||t.target&&Se(o)};function Pt(t){if(t.draggedContext.futureIndex===0)return!1}async function Ue(t,o=!1){if(t.moved){const{oldIndex:r,newIndex:_}=t.moved,{fk_grp_col_id:L,meta:V}=xe.value;C.value[r].order=_,C.value[_].order=r;const we=Ge(V)||{};we[L]=C.value,await St({meta:we}),o||Dt({undo:{fn:async B=>{const pe=C.value.splice(B.moved.newIndex,1);C.value.splice(B.moved.oldIndex,0,pe[0]),await Ue(B,!0)},args:[{moved:{oldIndex:r,newIndex:_}}]},redo:{fn:async B=>{const pe=C.value.splice(B.moved.oldIndex,1);C.value.splice(B.moved.newIndex,0,pe[0]),await Ue(B,!0)},args:[{moved:{oldIndex:r,newIndex:_}},!0]},scope:Tt({view:se.value})})}}async function Ut(t,o){if(t.added){const r=t.added.element;tt.value.unshift({op:"added",pk:$e(t.added.element.row,x.value.columns),index:t.added.newIndex,stack:o}),r.row[Ze.value]=o,S.value.set(o,S.value.get(o)+1),await Ct(r)}else t.removed&&(S.value.set(o,S.value.get(o)-1),tt.value.unshift({op:"removed",pk:$e(t.removed.element.row,x.value.columns),index:t.removed.oldIndex,stack:o}))}const lt=qo(async t=>{if(t.target&&t.target.scrollTop+t.target.clientHeight+_a>=t.target.scrollHeight){const o=t.target.getAttribute("data-stack-title"),r=Vt.value.defaultLimit||25,_=j.value.get(o);if(_&&(S.value.get(o)===void 0||_.length<S.value.get(o))){const L=Math.ceil(_.length/r);await Rt(o,{offset:L*r>S.value.get(o)||L*r>_.length?(L-1)*r:L*r})}}}),Ht=t=>{t&&(t.removeEventListener("scroll",lt),t.addEventListener("scroll",lt))},Gt=(t,o)=>{te.value=!0,re.value=t,z.value=o},qt=async()=>{await It(re.value,z.value),te.value=!1},st=async t=>{C.value[t].collapsed=!C.value[t].collapsed,v.value||await je()},Kt=(t,o)=>{We(t)&&o.stopPropagation()},Jt=async()=>{C.value.forEach(t=>{t.id!==Be&&!t.collapsed&&(t.collapsed=!0)}),v.value||await je()},Wt=async()=>{C.value.forEach(t=>{t.id!==Be&&t.collapsed&&(t.collapsed=!1)}),v.value||await je()},it=async()=>{const t=await Et();t.row={[Ze.value]:Oe.value===""?null:Oe.value},S.value.set(null,S.value.get(null)+1),Se(t)};Z==null||Z.on(it),To(()=>Z.off(it)),wt(ue,()=>{ue.value||(me.value=null)}),wt(se,async t=>{if((t==null?void 0:t.type)===$o.KANBAN){Re.value=!0;try{await ke(),Re.value=!1,await Ye(),yt(()=>{et.value&&Ce.value&&(Ce.value.scrollTo({left:Ce.value.scrollWidth,behavior:"smooth"}),et.value=!1)})}catch(o){console.error(o),Re.value=!1}}},{immediate:!0});const Xt=t=>{const o=$e(t.row,x.value.columns);return o?`row-${o}`:""},Qt=G(()=>{var t;return Ge((t=xe.value)==null?void 0:t.meta).hide_empty_stack||!1}),F={id:Be},y=f(null),h=(t,o)=>(t==null?void 0:t.id)&&(o==null?void 0:o.id)&&t.id===o.id,ye=f(null),rt=async(t,o,r)=>{ye.value=y.value,y.value=null,o&&(o!=null&&o.title)&&(o!=null&&o.color)&&r!==void 0&&(C.value[r].title=o.title,C.value[r].color=o.color),t&&await ke(),ye.value=null},Yt=t=>{var o;return(o=t.target)==null?void 0:o.closest(".not-draggable")},Zt=(t,o)=>{const r=t.target,_=r==null?void 0:r.closest(".not-draggable");return!!(r&&o.contains(r)&&_&&(o.contains(_)||_===o))},He=t=>{$t()||(Oe.value=t??"",Z.trigger())};return(t,o)=>{const r=rn,_=Po,L=Fo,V=No,we=vn,B=Ho,pe=Uo,W=Xo,Ie=Qo,dt=zo,ct=Yo,ut=Bo,mt=cn,eo=_n,to=pn,pt=yn,ft=wn,oo=gn,no=bn,Ae=Oo,ao=hn,lo=un,so=mn,vt=dn,_t=kn,io=Zo,X=jo("e");return n(),w(Q,null,[i("div",xn,[i("div",{ref_key:"kanbanContainerRef",ref:Ce,class:"nc-kanban-container flex p-3 overflow-y-hidden w-full nc-scrollbar-x-lg",style:fe({minHeight:e(ot)?"calc(100%  - 2rem)":"calc(100vh - var(--topbar-height) - var(--toolbar-height) - 0.4rem)",maxHeight:e(ot)?"calc(100%  - 2rem)":"calc(100vh - var(--topbar-height) - var(--toolbar-height) - 0.4rem)"})},[e(Re)?(n(),w("div",Rn,[(n(!0),w(Q,null,Ke(Array(20),g=>(n(),s(r,{key:g,class:"!min-w-80 !min-h-full !rounded-xl overflow-hidden"}))),128))])):(n(),s(ut,{key:1,visible:e(ue),"onUpdate:visible":o[13]||(o[13]=g=>ne(ue)?ue.value=g:null),trigger:["contextmenu"],"overlay-class-name":"nc-dropdown-kanban-context-menu"},Je({default:l(()=>{var g;return[i("div",Cn,[m(e(ht),{modelValue:e(C),"onUpdate:modelValue":o[3]||(o[3]=a=>ne(C)?C.value=a:null),class:"flex gap-3","item-key":"id",group:"kanban-stack",draggable:".nc-kanban-stack",handle:".nc-kanban-stack-drag-handler",filter:Yt,move:Pt,onStart:o[4]||(o[4]=a=>a.target.classList.add("grabbing")),onEnd:o[5]||(o[5]=a=>a.target.classList.remove("grabbing")),onChange:o[6]||(o[6]=a=>Ue(a))},{item:l(({element:a,index:O})=>{var Le;return[i("div",{class:I(["nc-kanban-stack",{"w-[44px]":a.collapsed,hidden:e(Qt)&&!((Le=e(j).get(a.title))!=null&&Le.length)||e(Ft)&&a.id===e(Mt)}]),"data-testid":`nc-kanban-stack-${a.title}`},[a.collapsed?(n(),s(Ae,{key:`${a.id}-collapsed`,class:I(["nc-kanban-collapsed-stack flex items-center w-68.5 h-[44px] !rounded-xl cursor-pointer h-full !p-2 overflow-hidden !shadow-none !hover:shadow-none !border-gray-200",{"not-draggable":a.title===null||e(R)||e(v)||!e(E)}]),"body-style":{padding:"0px !important",height:"100%",width:"100%",borderRadius:"0.75rem !important",paddingBottom:"0rem !important"}},{default:l(()=>[i("div",{class:"h-full flex items-center justify-between",onClick:N=>st(O)},[!e(j).get(a.title)||!e(S)?(n(),w("div",na,[m(r,{active:!0,class:"!w-full !h-4 !rounded-lg overflow-hidden"})])):(n(),w("div",aa,[i("div",la,[e(R)||e(v)||!e(E)?b("",!0):(n(),s(V,{key:0,disabled:!a.title,type:"text",size:"xs",class:"nc-kanban-stack-drag-handler !px-1.5 !cursor-move",onClick:o[2]||(o[2]=gt(()=>{},["stop"]))},{default:l(()=>[m(L,{icon:"ncDrag",class:"font-weight-800 flex-none"})]),_:2},1032,["disabled"])),i("div",sa,[m(pe,{class:"max-w-full !rounded-full !px-2 !py-1 h-7 !m-0 !border-none",color:a.color},{default:l(()=>[i("span",{style:fe({color:e(oe).isReadable(a.color||"#ccc","#fff",{level:"AA",size:"large"})?"#fff":e(oe).mostReadable(a.color||"#ccc",["#0b1d05","#fff"]).toHex8String()}),class:"text-sm font-semibold"},[m(B,{class:"truncate max-w-full",placement:"left","show-on-truncate-only":""},{title:l(()=>[k(p(a.title??"Uncategorized"),1)]),default:l(()=>[i("span",ia,p(a.title??"Uncategorized"),1)]),_:2},1024)],4)]),_:2},1032,["color"])])]),i("div",ra,[i("div",da,p(e(j).get(a.title).length)+" "+p(e(S).get(a.title)!==1?t.$t("objects.records"):t.$t("objects.record")),1),m(V,{type:"text",size:"xs",class:"!px-1.5"},{default:l(()=>[(n(),s(D(("iconMap"in t?t.iconMap:e(T)).arrowDown),{class:"text-grey h-4 w-4 flex-none"}))]),_:1})])]))],8,oa)]),_:2},1032,["class"])):(n(),s(Ae,{key:`${a.id}-${O}`,class:I(["flex flex-col w-68.5 h-full !rounded-xl overflow-y-hidden !shadow-none !hover:shadow-none !border-gray-200",{"not-draggable":a.title===null||e(R)||e(v)||!e(E),"!cursor-default":e(R)||!e(E)}]),"head-style":{paddingBottom:"0px"},"body-style":{padding:"0px !important",height:"100%",borderRadius:"0.75rem !important",paddingBottom:"0rem !important"}},{default:l(()=>[!e(j).get(a.title)||!e(S)?(n(),w("div",En,[m(r,{active:!0,class:"!w-full !h-9.75 !rounded-lg overflow-hidden"})])):(n(),s(vt,{key:1},{default:l(()=>[m(mt,{class:I(["border-b-1 border-gray-100 min-h-[49px]",`nc-kanban-stack-header-${a.id}`])},{default:l(()=>{var N,d;return[i("div",{class:I(["nc-kanban-stack-head w-full flex gap-1",{"items-start":h(a,e(y)),"items-center":!h(a,e(y))}])},[i("div",{class:I(["flex-1 flex gap-1 max-w-[calc(100%_-_32px)]",{"items-start":h(a,e(y)),"items-center":!h(a,e(y))}])},[e(R)||e(v)||!e(E)?b("",!0):(n(),s(V,{key:0,disabled:!a.title||h(a,e(ye))||h(a,e(y)),type:"text",size:"xs",class:"nc-kanban-stack-drag-handler !px-1.5 !cursor-move !:disabled:cursor-not-allowed mt-0.5"},{default:l(()=>[h(a,e(ye))?(n(),s(_,{key:0,size:"regular",class:"stack-rename-loader"})):(n(),s(L,{key:1,icon:"ncDrag",class:"!font-weight-800 flex-none"}))]),_:2},1032,["disabled"])),i("div",{class:I(["flex-1 flex max-w-[calc(100%_-_28px)]",{"-ml-1":h(a,e(y))}])},[h(a,e(y))&&e(J)[(N=e(y))==null?void 0:N.fk_column_id]?(n(),s(we,{key:0,column:e(J)[(d=e(y))==null?void 0:d.fk_column_id],"option-id":e(y).id,onSubmit:(P,U)=>rt(P,U,O)},null,8,["column","option-id","onSubmit"])):(n(),s(pe,{key:1,class:"max-w-full !rounded-full !px-2 !py-1 h-7 !m-0 !border-none !mt-0.5",color:a.color,onDblclick:()=>{a.title!==null&&e(E)&&!e(v)&&!e(R)&&(y.value=a)}},{default:l(()=>[i("span",{style:fe({color:e(oe).isReadable(a.color||"#ccc","#fff",{level:"AA",size:"large"})?"#fff":e(oe).mostReadable(a.color||"#ccc",["#0b1d05","#fff"]).toHex8String()}),class:"text-sm font-semibold"},[m(B,{class:"truncate max-w-full",placement:"bottom","show-on-truncate-only":""},{title:l(()=>[k(p(a.title??"Uncategorized"),1)]),default:l(()=>[i("span",In,p(a.title??"Uncategorized"),1)]),_:2},1024)],4)]),_:2},1032,["color","onDblclick"]))],2)],2),m(ut,{placement:"bottomRight","overlay-class-name":"nc-dropdown-kanban-stack-context-menu",class:"bg-white !rounded-lg"},{overlay:l(()=>[m(ct,{variant:"small"},{default:l(()=>{var P;return[e(E)&&!e(v)&&!e(he)?(n(),s(Ie,{key:0,entity:e(Ve).TABLE,"entity-id":(P=e(x))==null?void 0:P.id,permission:e(Me).TABLE_RECORD_ADD,placement:"right"},{default:l(({isAllowed:U})=>[Y((n(),s(W,{"data-testid":"nc-kanban-context-menu-add-new-record",disabled:!U,onClick:c=>He(a.title)},{default:l(()=>[i("div",An,[(n(),s(D(("iconMap"in t?t.iconMap:e(T)).plus),{class:"flex-none w-4 h-4"})),k(" "+p(t.$t("activity.newRecord")),1)])]),_:2},1032,["disabled","onClick"])),[[X,["c:kanban:add-new-record"]]])]),_:2},1032,["entity","entity-id","permission"])):b("",!0),a.title!==null&&e(E)&&!e(v)&&!e(R)?Y((n(),s(W,{key:1,"data-testid":"nc-kanban-context-menu-rename-stack",onClick:()=>{y.value=a}},{default:l(()=>[i("div",Ln,[(n(),s(D(("iconMap"in t?t.iconMap:e(T)).ncEdit),{class:"flex-none w-4 h-4"})),k(" "+p(t.$t("activity.kanban.renameStack")),1)])]),_:2},1032,["onClick"])),[[X,["c:kanban:rename-stack"]]]):b("",!0),Y((n(),s(W,{"data-testid":"nc-kanban-context-menu-collapse-stack",onClick:U=>st(O)},{default:l(()=>[i("div",Mn,[(n(),s(D(("iconMap"in t?t.iconMap:e(T)).minimize),{class:"flex-none w-4 h-4"})),k(" "+p(t.$t("activity.kanban.collapseStack")),1)])]),_:2},1032,["onClick"])),[[X,["c:kanban:collapse-stack"]]]),Y((n(),s(W,{"data-testid":"nc-kanban-context-menu-collapse-all-stack",onClick:Jt},{default:l(()=>[i("div",Vn,[(n(),s(D(("iconMap"in t?t.iconMap:e(T)).minimizeAll),{class:"flex-none w-4 h-4"})),k(" "+p(t.$t("activity.kanban.collapseAll")),1)])]),_:1})),[[X,["c:kanban:collapse-all-stack"]]]),Y((n(),s(W,{"data-testid":"nc-kanban-context-menu-expand-all-stack",onClick:Wt},{default:l(()=>[i("div",Dn,[(n(),s(D(("iconMap"in t?t.iconMap:e(T)).maximizeAll),{class:"flex-none w-4 h-4"})),k(" "+p(t.$t("activity.kanban.expandAll")),1)])]),_:1})),[[X,["c:kanban:expand-all-stack"]]]),a.title!==null&&!e(v)&&e(E)&&!e(R)?(n(),w(Q,{key:2},[m(dt),Y((n(),s(W,{danger:"","data-testid":"nc-kanban-context-menu-delete-stack",onClick:U=>Gt(a.title,O)},{default:l(()=>[i("div",Tn,[(n(),s(D(("iconMap"in t?t.iconMap:e(T)).delete),{class:"flex-none w-4 h-4"})),k(" "+p(t.$t("activity.kanban.deleteStack")),1)])]),_:2},1032,["onClick"])),[[X,["c:kanban:delete-stack"]]])],64)):b("",!0)]}),_:2},1024)]),default:l(()=>[m(V,{disabled:h(a,e(ye)),type:"text",size:"xs",class:"!px-1.5 mt-0.5","data-testid":"nc-kanban-stack-context-menu"},{default:l(()=>[m(L,{icon:"threeDotVertical"})]),_:2},1032,["disabled"])]),_:2},1024)],2)]}),_:2},1032,["class"]),m(lo,{class:"overflow-y-hidden",style:fe({backgroundColor:e(oe).mix(a.color||"#ccc","#ffffff",e(oe)(a.color||"#ccc").isLight()?70:e(oe)(a.color||"#ccc").getBrightness()<=100?80:90).toString()})},{default:l(()=>{var N;return[i("div",{ref:Ht,class:"nc-kanban-list h-full px-2 nc-scrollbar-thin","data-stack-title":a.title},[m(e(ht),{list:e(j).get(a.title),"item-key":"row.Id",draggable:".nc-kanban-item",group:"kanban-card",class:"flex flex-col h-full",filter:Zt,onStart:o[0]||(o[0]=d=>d.target.classList.add("grabbing")),onEnd:o[1]||(o[1]=d=>d.target.classList.remove("grabbing")),onChange:d=>Ut(d,a.title)},Je({item:l(({element:d,index:P})=>[i("div",jn,[m(ao,{row:d},{default:l(()=>{var U;return[(n(),s(Ae,{key:`${Xt(d)}-${P}`,class:I(["!rounded-lg h-full border-gray-200 border-1 group overflow-hidden break-all max-w-[450px] cursor-pointer flex flex-col",{"not-draggable":!e(E)||e(v),"!cursor-default":!e(E)||e(v)}]),"body-style":{padding:"12px !important",flex:1,display:"flex"},"data-stack":a.title,"data-testid":`nc-gallery-card-${d.row.id}`,style:fe({...("extractRowBackgroundColorStyle"in t?t.extractRowBackgroundColorStyle:e(Qe))(d).rowBgColor,...("extractRowBackgroundColorStyle"in t?t.extractRowBackgroundColorStyle:e(Qe))(d).rowBorderColor}),onClick:c=>Nt(c,d),onContextmenu:c=>Ot(c,d)},Je({default:l(()=>[i("div",On,[e(Fe)?(n(),w("div",{key:0,class:"w-1 flex-none min-h-4 rounded-sm",style:fe(("extractRowBackgroundColorStyle"in t?t.extractRowBackgroundColorStyle:e(Qe))(d).rowLeftBorderColor)},null,4)):b("",!0),i("div",{class:I(["flex-1 flex flex-col gap-3 !children:pointer-events-none",{"w-[calc(100%_-_16px)]":e(Fe),"w-full":!e(Fe)}])},[e(A)?(n(),w("h2",{key:0,class:I(["nc-card-display-value-wrapper",{"!children:pointer-events-auto":("isButton"in t?t.isButton:e(We))(e(A))||("isRowEmpty"in t?t.isRowEmpty:e(De))(d,e(A))&&("isAllowToRenderRowEmptyField"in t?t.isAllowToRenderRowEmptyField:e(Te))(e(A))}])},[!("isRowEmpty"in t?t.isRowEmpty:e(De))(d,e(A))||("isAllowToRenderRowEmptyField"in t?t.isAllowToRenderRowEmptyField:e(Te))(e(A))?(n(),w(Q,{key:0},[e(Xe)(e(A))?(n(),s(pt,{key:0,modelValue:d.row[e(A).title],"onUpdate:modelValue":c=>d.row[e(A).title]=c,class:"!text-brand-500",column:e(A),row:d},null,8,["modelValue","onUpdate:modelValue","column","row"])):(n(),s(ft,{key:1,modelValue:d.row[e(A).title],"onUpdate:modelValue":c=>d.row[e(A).title]=c,class:"!text-brand-500",column:e(A),"edit-enabled":!1,"read-only":!0},null,8,["modelValue","onUpdate:modelValue","column"]))],64)):(n(),w(Q,{key:1},[k(" -")],64))],2)):b("",!0),(n(!0),w(Q,null,Ke(e(Bt),c=>(n(),w("div",{key:`record-${d.row.id}-${c.id}`,class:I(["nc-card-col-wrapper",{"!children:pointer-events-auto":("isButton"in t?t.isButton:e(We))(c)||("isRowEmpty"in t?t.isRowEmpty:e(De))(d,c)&&("isAllowToRenderRowEmptyField"in t?t.isAllowToRenderRowEmptyField:e(Te))(c)}]),onClick:H=>Kt(c,H)},[i("div",Pn,[i("div",Un,[i("div",Hn,[e(Xe)(c)?(n(),s(oo,{key:0,column:c,"hide-menu":!0},null,8,["column"])):(n(),s(no,{key:1,column:c,"hide-menu":!0},null,8,["column"]))])]),!("isRowEmpty"in t?t.isRowEmpty:e(De))(d,c)||("isAllowToRenderRowEmptyField"in t?t.isAllowToRenderRowEmptyField:e(Te))(c)||("isPercent"in t?t.isPercent:e(Go))(c)?(n(),w("div",Gn,[e(Xe)(c)?(n(),s(pt,{key:0,modelValue:d.row[c.title],"onUpdate:modelValue":H=>d.row[c.title]=H,column:c,row:d,class:"!text-gray-800"},null,8,["modelValue","onUpdate:modelValue","column","row"])):(n(),s(ft,{key:1,modelValue:d.row[c.title],"onUpdate:modelValue":H=>d.row[c.title]=H,column:c,"edit-enabled":!1,"read-only":!0,class:"!text-gray-800"},null,8,["modelValue","onUpdate:modelValue","column"]))])):(n(),w("div",qn,"-"))])],10,Nn))),128))],2)])]),_:2},[(U=e(ce))!=null&&U.id?{name:"cover",fn:l(()=>[!e(Pe)&&Ne(d).length?(n(),s(to,{key:Ne(d).reduce((c,H)=>c+(H==null?void 0:H.path),""),class:"gallery-carousel !border-b-1 !border-gray-200 !bg-white",arrows:""},{customPaging:l(()=>o[17]||(o[17]=[i("a",null,[i("div",null,[i("div")])],-1)])),prevArrow:l(()=>[i("div",Bn,[m(V,{type:"secondary",size:"xsmall",class:"!absolute !left-1.5 !bottom-[-90px] !opacity-0 !group-hover:opacity-100 !rounded-lg cursor-pointer"},{default:l(()=>[m(L,{icon:"arrowLeft",class:"text-gray-700 w-4 h-4"})]),_:1})])]),nextArrow:l(()=>[i("div",zn,[m(V,{type:"secondary",size:"xsmall",class:"!absolute !right-1.5 !bottom-[-90px] !opacity-0 !group-hover:opacity-100 !rounded-lg cursor-pointer"},{default:l(()=>[m(L,{icon:"arrowRight",class:"text-gray-700 w-4 h-4"})]),_:1})])]),default:l(()=>[(n(!0),w(Q,null,Ke(Ne(d),c=>(n(),w(Q,null,[("isImage"in t?t.isImage:e(tn))(c.title,c.mimetype??c.type)?(n(),s(eo,{key:c.path,class:"h-52","image-class":"!w-full","object-fit":e(zt),srcs:e(_e)(c,"card_cover")},null,8,["object-fit","srcs"])):b("",!0)],64))),256))]),_:2},1024)):(n(),w("div",Fn,o[18]||(o[18]=[i("img",{class:"object-contain w-[48px] h-[48px]",src:en},null,-1)])))]),key:"0"}:void 0]),1032,["data-stack","data-testid","class","style","onClick","onContextmenu"]))]}),_:2},1032,["row"])])]),_:2},[(N=e(j).get(a.title))!=null&&N.length?void 0:{name:"footer",fn:l(()=>{var d;return[i("div",Kn,[i("div",Jn,[i("span",Wn,p(t.$t("general.empty"))+" "+p(t.$t("general.stack").toLowerCase()),1),i("span",Xn,p(t.$t("title.looksLikeThisStackIsEmpty")),1)]),e(ze)("dataInsert")&&!e(he)?(n(),s(Ie,{key:0,entity:e(Ve).TABLE,"entity-id":(d=e(x))==null?void 0:d.id,permission:e(Me).TABLE_RECORD_ADD,placement:"right"},{default:l(({isAllowed:P})=>[m(V,{size:"xs",type:"secondary",disabled:!P,onClick:U=>He(a.title)},{default:l(()=>[i("div",Qn,[!e(v)&&!e(R)?(n(),s(D(("iconMap"in t?t.iconMap:e(T)).plus),{key:0})):b("",!0),k(" "+p(t.$t("activity.newRecord")),1)])]),_:2},1032,["disabled","onClick"])]),_:2},1032,["entity","entity-id","permission"])):b("",!0)])]}),key:"0"}]),1032,["list","onChange"])],8,$n)]}),_:2},1032,["style"]),e(j).get(a.title)?(n(),s(so,{key:0,class:"border-t-1 border-gray-100"},{default:l(()=>{var N;return[i("div",Yn,[e(ze)("dataInsert")&&!e(he)?(n(),s(Ie,{key:0,entity:e(Ve).TABLE,"entity-id":(N=e(x))==null?void 0:N.id,permission:e(Me).TABLE_RECORD_ADD},{default:l(({isAllowed:d})=>[m(V,{size:"xs",type:"secondary",disabled:!d,onClick:P=>He(a.title)},{default:l(()=>[i("div",Zn,[!e(v)&&!e(R)?(n(),s(D(("iconMap"in t?t.iconMap:e(T)).plus),{key:0,class:""})):b("",!0),k(" "+p(t.$t("activity.newRecord")),1)])]),_:2},1032,["disabled","onClick"])]),_:2},1032,["entity","entity-id","permission"])):(n(),w("div",ea," ")),i("div",ta,p(e(j).get(a.title).length)+"/"+p(e(S).get(a.title)??0)+" "+p(e(S).get(a.title)!==1?t.$t("objects.records"):t.$t("objects.record")),1)])]}),_:2},1024)):b("",!0)]),_:2},1024))]),_:2},1032,["class"]))],10,Sn)]}),_:1},8,["modelValue"]),e(E)&&!e(v)&&!e(R)&&((g=e(de))!=null&&g.id)?(n(),w("div",ca,[m(Ae,{class:I(["flex flex-col w-68.5 !rounded-xl overflow-y-hidden !shadow-none !hover:shadow-none border-gray-200 nc-kanban-stack-header-new-stack",[{"!cursor-default":e(R)||!e(E),"!border-none":!h(F,e(y))}]]),"head-style":{paddingBottom:"0px"},"body-style":{padding:"0px !important",height:"100%",borderRadius:"0.75rem !important",paddingBottom:"0rem !important"}},{default:l(()=>[!e(j).get(null)||!e(S)?(n(),w("div",ua,[m(r,{active:!0,class:"!w-full !h-9.75 !rounded-lg overflow-hidden"})])):(n(),s(vt,{key:1},{default:l(()=>[m(mt,{class:I({"!p-0 overflow-hidden":!h(F,e(y))})},{default:l(()=>{var a,O;return[i("div",{class:I(["w-full flex",{"items-start":h(F,e(y)),"cursor-pointer":!h(F,e(y))}]),onClick:o[9]||(o[9]=()=>{h(F,e(y))||(y.value=F)})},[h(F,e(y))?(n(),w("div",{key:1,class:I(["flex-1 flex",{"-ml-1":h(F,e(y))}]),onClick:o[8]||(o[8]=gt(()=>{},["stop"]))},[h(F,e(y))&&e(J)[(a=e(de))==null?void 0:a.id]?(n(),s(we,{key:0,column:e(J)[(O=e(de))==null?void 0:O.id],"is-new-stack":"",onSubmit:o[7]||(o[7]=Le=>rt(Le,void 0))},null,8,["column"])):b("",!0)],2)):(n(),s(V,{key:0,type:"secondary",class:"add-new-stack-btn w-full !rounded-xl min-h-11"},{default:l(()=>[i("div",ma,[!e(v)&&!e(R)?(n(),s(D(("iconMap"in t?t.iconMap:e(T)).plus),{key:0,class:""})):b("",!0),k(" "+p(t.$t("general.new"))+" "+p(t.$t("general.stack").toLowerCase()),1)])]),_:1}))],2)]}),_:1},8,["class"])]),_:1}))]),_:1},8,["class"])])):b("",!0)])]}),_:2},[!e(R)&&!e(v)&&e(E)?{name:"overlay",fn:l(()=>[m(ct,{variant:"small",onClick:o[12]||(o[12]=g=>ue.value=!1)},{default:l(()=>{var g;return[e(me)?Y((n(),s(W,{key:0,onClick:o[10]||(o[10]=a=>Se(e(me)))},{default:l(()=>[i("div",pa,[(n(),s(D(("iconMap"in t?t.iconMap:e(T)).maximize),{class:"flex"})),k(" "+p(t.$t("activity.expandRecord")),1)])]),_:1})),[[X,["a:kanban:expand-record"]]]):b("",!0),m(dt),e(me)?(n(),s(Ie,{key:1,entity:e(Ve).TABLE,"entity-id":(g=e(x))==null?void 0:g.id,permission:e(Me).TABLE_RECORD_DELETE,placement:"right"},{default:l(({isAllowed:a})=>[Y((n(),s(W,{danger:"",disabled:!a,onClick:o[11]||(o[11]=O=>e(At)(e(me)))},{default:l(()=>[i("div",fa,[m(L,{icon:"delete",class:"flex"}),k(" "+p(t.$t("general.deleteEntity",{entity:t.$t("objects.record").toLowerCase()})),1)])]),_:2},1032,["disabled"])),[[X,["a:kanban:delete-record"]]])]),_:1},8,["entity","entity-id","permission"])):b("",!0)]}),_:1})]),key:"0"}:void 0]),1032,["visible"]))],4)]),(n(),s(bt,null,{default:l(()=>[e(ee)&&e(M)?(n(),s(_t,{key:0,modelValue:e(M),"onUpdate:modelValue":o[14]||(o[14]=g=>ne(M)?M.value=g:null),row:e(ee),state:e(be),meta:e(x),"load-row":!e(v),view:e(se),onCancel:e(Lt)},null,8,["modelValue","row","state","meta","load-row","view","onCancel"])):b("",!0)]),_:1})),(n(),s(bt,null,{default:l(()=>{var g;return[e(Ee)&&((g=e(x))!=null&&g.id)?(n(),s(_t,{key:0,modelValue:e(Ee),"onUpdate:modelValue":o[15]||(o[15]=a=>ne(Ee)?Ee.value=a:null),"load-row":!e(v),row:e(ee)??{row:{},oldRow:{},rowMeta:{}},meta:e(x),"expand-form":Se,"row-id":e(K).query.rowId,view:e(se)},null,8,["modelValue","load-row","row","meta","row-id","view"])):b("",!0)]}),_:1})),m(io,{visible:e(te),"onUpdate:visible":o[16]||(o[16]=g=>ne(te)?te.value=g:null),"entity-name":"Stack","show-default-delete-msg":!1,"on-delete":qt},{"entity-preview":l(()=>{var g;return[e(re)?(n(),w("div",va,[i("div",null,[o[19]||(o[19]=k(" This action will also remove the ")),i("b",null,'"'+p(e(re))+'"',1),o[20]||(o[20]=k(" option from the ")),i("b",null,' "'+p(((g=e(de))==null?void 0:g.title)??"Grouping")+'"',1),o[21]||(o[21]=k(" field. "))]),o[22]||(o[22]=i("div",null,"Records will be moved to Uncategorized stack.",-1))])):b("",!0)]}),_:1},8,["visible"])],64)}}}),Ha=Object.assign(Ko(ya,[["__scopeId","data-v-83f483a8"]]),{__name:"SmartsheetKanban"});export{Ha as default};
