import{bJ as m,r as a,f as p,J as w,Y as y,g as M,bz as T,el as v}from"./DRA9KN5F.js";const A=m(()=>{const f=a("recents"),{$api:g}=p(),{appInfo:k}=w(),u=a([]),o=a([]),t=a([]),r=a([]),s=y({youtube:!1,github:!1,social:!1,cloud:!1}),d=async({loadMore:c,type:l})=>{try{let e=1;if(c)switch(l){case"youtube":e=Math.ceil(u.value.length/10)+1;break;case"github":e=Math.ceil(o.value.length/10)+1;break;case"all":e=Math.ceil(t.value.length/10)+1;break;case"cloud":e=Math.ceil(r.value.length/10)+1;break}const n=await g.utils.feed({page:e,per_page:10,type:l});switch(l){case"youtube":u.value=[...u.value,...n];break;case"github":o.value=[...o.value,...n];break;case"all":t.value=[...t.value,...n];break;case"cloud":r.value=[...r.value,...n];break}}catch(e){switch(l){case"youtube":s.youtube=!0;break;case"github":s.github=!0;break;case"all":s.social=!0;break;case"cloud":s.cloud=!0;break}return console.error(e),[]}},b=a(!1),F=async()=>{try{if(await d({type:"all",loadMore:!1}),!t.value.length)return;const[c]=t.value,l=localStorage.getItem("lastFeedPublishedTime"),e=v(l);(!e.isValid()||v(c["Published Time"]).isAfter(e))&&(b.value=!0)}catch(c){console.error("Error while checking new feed",c)}},i=a(),h=async()=>{await F(),i.value=setTimeout(h,3*60*60*1e3)};return M(()=>{k.value.feedEnabled&&h()}),T(()=>{i.value&&(clearTimeout(i.value),i.value=null)}),{isErrorOccurred:s,activeTab:f,youtubeFeed:u,githubFeed:o,socialFeed:t,cloudFeed:r,loadFeed:d,isNewFeedAvailable:b}});export{A as u};
