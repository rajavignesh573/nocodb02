const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CG-5KGUk.js","./DRA9KN5F.js","./entry.CNP42Mi6.css","./BLPDl4Qg.js","./CkvAmLZt.js","./D7OHpRdS.js","./DvtLu3FC.js","./D_txg4HT.js","./CQa0sIfA.js","./DkDj6Z7Z.js","./By5RWL3d.js","./gAYHr7Gr.js","./SelectOptions.BDAXdwVJ.css","./C3FZdmXk.js","./index.C8L8AhJa.css","./JqUqXTOd.js","./I4o4wRE2.js","./BMPzbwPk.js","./CwPFbl3n.js","./YbUkeyWR.js","./D7poRkS0.js","./C5HnjaiI.js","./CBhmoxRW.js","./DjPyxH1k.js","./Bc3_tI4-.js","./CsX17Y_h.js","./BCBMEREK.js","./CJAyvGKH.js","./C2UaKEE0.js","./Item.GTPiKSkc.css","./C_VN1MCC.js","./index.CMurbi1o.css","./QeWwuUYP.js","./index._6B72PDH.css","./Dv0nYk-Y.js","./D43249YX.js","./CNwEZGnv.js","./DP83Cqnl.js","./DlXIlcns.js","./BVqTF1QK.js","./Ce4xoeky.js","./U3gU45AW.js","./BYKJ-MHf.js","./B94p8ToD.js","./Cd4chHHL.js","./boyBAVNN.js","./BBg0y0zb.js","./-iDxnmJF.js","./EditOrAddProvider.C1S70ahv.css"])))=>i.map(i=>d[i]);
import{e as nt,fe as lt,ff as Ot,f as it,a9 as dt,S as rt,G as X,r as b,bd as ut,bc as ct,av as St,n as R,aG as Be,be as pt,gt as Nt,I as _,o as s,aH as vt,w as i,ao as Mt,a as f,O as $,b as p,c as g,L as t,ar as mt,Q as me,b9 as J,bo as fe,t as y,N as ft,by as Rt,aq as Xe,j as _t,d as E,ap as bt,bO as Dt,an as Ne,fW as wt,fX as gt,fV as yt,aj as Te,gN as Vt,a4 as Ue,_ as ht,g8 as jt,fL as Et,J as Tt,as as Bt,b5 as Ut,bX as Gt,g6 as zt,gd as Kt,W as Pt,fN as ot,b1 as m,jb as qe,aF as He,aC as Yt,fZ as qt,ac as Ht,ag as U,ad as at,K as C,M as Xt,es as Jt,eJ as Qt,b3 as Wt,ae as Zt,f2 as el,aX as tl,a5 as ll,aD as st,a_ as ol}from"./DRA9KN5F.js";import{_ as al}from"./C2UaKEE0.js";import{_ as sl}from"./C_VN1MCC.js";import{g as nl}from"./CG-5KGUk.js";import{_ as il}from"./GU4raMbz.js";import{D as dl}from"./D7OHpRdS.js";import{u as rl}from"./D7poRkS0.js";import{u as ul}from"./CQa0sIfA.js";import"./BLPDl4Qg.js";import"./CkvAmLZt.js";import"./D_txg4HT.js";import"./By5RWL3d.js";import"./gAYHr7Gr.js";import"./C3FZdmXk.js";import"./JqUqXTOd.js";import"./I4o4wRE2.js";import"./BMPzbwPk.js";import"./CwPFbl3n.js";import"./YbUkeyWR.js";import"./C5HnjaiI.js";import"./CBhmoxRW.js";import"./DkDj6Z7Z.js";import"./DjPyxH1k.js";import"./Bc3_tI4-.js";import"./CsX17Y_h.js";import"./BCBMEREK.js";import"./CJAyvGKH.js";import"./QeWwuUYP.js";import"./Dv0nYk-Y.js";import"./D43249YX.js";import"./CNwEZGnv.js";import"./DP83Cqnl.js";import"./DlXIlcns.js";import"./BVqTF1QK.js";import"./Ce4xoeky.js";import"./U3gU45AW.js";import"./BYKJ-MHf.js";import"./B94p8ToD.js";import"./Cd4chHHL.js";import"./boyBAVNN.js";import"./BBg0y0zb.js";import"./-iDxnmJF.js";import"./DWLi1ZcL.js";import"./DvtLu3FC.js";const cl={class:"flex flex-col !rounded-t-lg overflow-hidden w-[256px]"},pl={class:"h-[44px] relative"},vl={key:1,class:"flex justify-between items-center pl-4 pr-3 py-1.5 absolute w-full overflow-auto",style:{"scrollbar-gutter":"stable"}},ml={class:"font-weight-600"},fl={class:"border-y-1 h-[310px] border-gray-200 py-1 nc-scrollbar-thin",style:{"scrollbar-gutter":"stable"}},_l=["data-testid","onClick"],bl={class:"flex flex-row items-center w-full cursor-pointer truncate ml-1 py-[2px] pr-2"},wl={class:"flex w-full p-1"},gl=nt({__name:"AddLookupsDropdown",props:lt({column:{},value:{type:Boolean},disabled:{type:Boolean}},{isOpened:{type:Boolean,default:!1},isOpenedModifiers:{}}),emits:lt(["created"],["update:isOpened"]),setup(te,{emit:a}){const le=te,oe=a,G=Ot(te,"isOpened"),{$api:Me}=it(),{t:ae}=dt(),{getMeta:w,metas:Ie}=rt(),z=X(ut,b()),Le=X(ct,b()),se=St(le,"column"),_e=b(!1),O=b(""),re=b([]),K=b({}),ue=d=>_t(yt(d)?wt:gt,{columnMeta:d}),v=R(()=>{var d;return(d=se.value.colOptions)==null?void 0:d.fk_related_model_id}),D=b(),T=R(()=>Object.values(K.value).filter(Boolean).length),be=R(()=>T.value>0),ne=async()=>{var d,h,P,S,ie,ge,ye,k,de,Q,W,Re,Fe,he;if(be.value)try{_e.value=!0;const Y=[],ke=((h=(d=z.value)==null?void 0:d.columns)==null?void 0:h.length)??0;for(const[V]of Object.entries(K.value).filter(([,I])=>I)){const I=Ie.value[(P=D.value)==null?void 0:P.id].columns.find($e=>$e.id===V),De=re.value.findIndex($e=>$e.id===V),q={uidt:Te.Lookup,fk_lookup_column_id:V,fk_relation_column_id:se.value.id,lookupTableTitle:(S=D.value)==null?void 0:S.title,lookupColumnTitle:(I==null?void 0:I.title)||I.column_name,table_name:(ie=z.value)==null?void 0:ie.table_name,title:`${I==null?void 0:I.title} from ${(ge=D.value)==null?void 0:ge.title}`,view_id:(ye=Le.value)==null?void 0:ye.id,order:ke+De,column_name:`${I==null?void 0:I.title} from (${(k=D.value)==null?void 0:k.title})`,column_order:{order:ke+De,view_id:(de=Le.value)==null?void 0:de.id}},pe=Vt({formState:q,metaColumns:(Q=D.value)==null?void 0:Q.columns,tableExplorerColumns:(W=z.value)==null?void 0:W.columns});Y.push({op:"add",column:{...q,title:pe}})}await Me.dbTableColumn.bulk((Re=z.value)==null?void 0:Re.id,{hash:(Fe=z.value)==null?void 0:Fe.columnsHash,ops:Y}),await w((he=z==null?void 0:z.value)==null?void 0:he.id,!0),Ue.success(T.value>1?ae("msg.success.nlookupFieldsCreatedSuccessfullyPlural",{n:T.value}):ae("msg.success.nlookupFieldsCreatedSuccessfully",{n:T.value})),G.value=!1,K.value={},oe("created")}catch(Y){console.error(Y),Ue.error(ae("msg.error.failedToCreateLookupFields"))}finally{_e.value=!1}};Be([D,O],async()=>{var d,h;if(D.value){const P=((h=Ie.value[(d=D.value)==null?void 0:d.id])==null?void 0:h.columns)||[];re.value=P.filter(S=>nl({column:S})&&pt([S==null?void 0:S.title],O.value))}});const we=Nt("refSearchField"),ce=b(!1);function Ge(){ce.value=!0,setTimeout(()=>{var d;(d=we.value)==null||d.focus()},500)}return Be(G,async d=>{d?(D.value=await w(v.value),ce.value=!1,O.value=""):K.value={}}),(d,h)=>{const P=mt,S=ft,ie=bt,ge=Dt,ye=vt;return s(),_(ye,{visible:G.value,"onUpdate:visible":h[3]||(h[3]=k=>G.value=k),disabled:le.disabled,placement:"right","overlay-class-name":"!min-w-[256px]",align:{offset:[8,15]}},{overlay:i(()=>[f("div",cl,[f("div",{onClick:h[2]||(h[2]=$(()=>{},["stop"]))},[f("div",pl,[p(Rt,{name:"slide-out",duration:{enter:500,leave:0}},{default:i(()=>[t(ce)?(s(),_(P,{key:0,ref_key:"refSearchField",ref:we,value:t(O),"onUpdate:value":h[0]||(h[0]=k=>me(O)?O.value=k:null),bordered:!1,class:"w-full !shadow-none !py-3 a-input-without-effect absolute !bg-transparent",placeholder:"Search field to add as lookup"},{prefix:i(()=>[(s(),_(J(("iconMap"in d?d.iconMap:t(fe)).search),{class:"w-3.5 text-gray-500 h-3.5 mr-1 ml-1"}))]),_:1},8,["value"])):(s(),g("div",vl,[f("div",ml,y(t(ae)("general.add"))+" "+y(t(ae)("datatype.Lookup"))+" "+y(t(ae)("objects.fields")),1),p(S,{type:"text",size:"small",onClick:h[1]||(h[1]=k=>Ge())},{default:i(()=>[(s(),_(J(("iconMap"in d?d.iconMap:t(fe)).search),{class:"w-4 h-4"}))]),_:1})]))]),_:1})]),f("div",fl,[(s(!0),g(Ne,null,Xe(t(re),k=>(s(),g("div",{key:k.id},[(s(),g("div",{key:k.id,"data-testid":`nc-lookup-add-menu-${k.title}`,class:"px-1 py-0.75 mx-1 flex flex-row items-center rounded-md hover:bg-gray-100",onClick:$(de=>t(K)[k.id]=!t(K)[k.id],["stop"])},[f("div",bl,[(s(),_(J(ue(k)),{class:"!w-3.5 !h-3.5 !text-gray-500"})),p(ie,{class:"flex-1 pl-1 pr-2 truncate","show-on-truncate-only":""},{title:i(()=>[E(y(k.title),1)]),default:i(()=>[E(y(k.title),1)]),_:2},1024),p(ge,{checked:t(K)[k.id],"onUpdate:checked":de=>t(K)[k.id]=de,size:"default"},null,8,["checked","onUpdate:checked"])]),h[4]||(h[4]=f("div",{class:"flex-1"},null,-1))],8,_l))]))),128))]),f("div",wl,[p(S,{loading:t(_e),size:"small",type:"text",class:"nc-add-lookup-button",disabled:!t(be),onClick:ne},{default:i(()=>[E(y(t(T)>1?d.$t("general.addLookupFieldPlural",{count:t(T)}):d.$t("general.addLookupField",{count:t(T)||""})),1)]),_:1},8,["loading","disabled"])])])])]),default:i(()=>[Mt(d.$slots,"default",{isOpened:G.value},void 0,!0)]),_:3},8,["visible","disabled"])}}}),yl=Object.assign(ht(gl,[["__scopeId","data-v-844d767b"]]),{__name:"SmartsheetToolbarAddLookupsDropdown"}),hl=tl(()=>ol(()=>import("./CG-5KGUk.js").then(te=>te.E),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48]),import.meta.url).then(te=>te.default||te)),kl={class:"flex items-center gap-1"},xl={class:"flex items-center gap-2 min-h-5"},Cl={key:2,class:"text-capitalize !text-small1 font-medium"},Al={key:0,class:"bg-brand-50 text-brand-500 nc-toolbar-btn-chip"},Il={key:0,class:"flex items-center gap-2 p-2 w-80 border-b-1 border-gray-100"},Ll={class:"pl-2 flex text-sm select-none text-gray-600"},Fl={class:"w-full flex gap-2 items-center justify-between max-w-[400px]"},$l=["disabled"],Ol={class:"pl-2 flex items-center gap-2"},Sl={class:"flex flex-col nc-scrollbar-thin max-h-[315px] min-h-[240px] p-2 overflow-y-auto border-t-1 border-nc-border-gray-medium",style:{"scrollbar-gutter":"stable !important"}},Nl={class:"nc-fields-list"},Ml={key:0,class:"px-2 py-6 text-gray-500 flex flex-col items-center gap-6 text-center"},Rl=["data-testid"],Dl=["onClick"],Vl={key:0,class:"flex-1 flex ml-1 mr-3"},jl={key:1,class:"flex-1 flex mr-3"},El={class:"px-1 text-nc-content-gray-subtle2"},Tl={key:2,class:"flex mr-2"},Bl={key:0,class:"bg-primary w-1.25 h-1.25 rounded-full absolute top-0.25 right-0.5 border-1 border-white"},Ul={key:0,class:"bg-primary w-1.25 h-1.25 rounded-full absolute top-0.25 right-0.5 border-1 border-white"},Gl={key:0,class:"bg-primary w-1.25 h-1.25 rounded-full absolute top-0.25 right-0.5 border-1 border-white"},zl=["onClick"],Kl={key:1,class:"flex px-2 gap-1 py-2 border-t-1 justify-between border-nc-border-gray-medium"},Pl={class:"nc-edit-or-add-provider-wrapper"},Yl=nt({__name:"FieldsMenu",setup(te){const a=X(ct,b()),le=X(ut,b()),oe=X(jt,void 0),G=X(Et,void 0),{isMobileMode:Me}=Tt(),{isUIAllowed:ae}=Bt(),w=X(Ut,b(!1)),Ie=X(Gt,b(!1)),z=X(zt,b(!1)),Le=X(Kt,R(()=>!1)),{$api:se,$e:_e}=it(),{t:O}=dt(),{metas:re,getMeta:K}=rt(),{showSystemFields:ue,fields:v,filteredFieldList:D,searchBasisIdMap:T,numberOfHiddenFields:be,filterQuery:ne,showAll:we,hideAll:ce,saveOrUpdate:Ge,metaColumnById:d,loadViewColumns:h,toggleFieldStyles:P,toggleFieldVisibility:S,isLocalMode:ie}=rl(),{eventBus:ge,isDefaultView:ye,isSqlView:k}=ul(),de=R(()=>!z.value&&ae("fieldAdd")&&!k.value),{addUndo:Q,defineViewScope:W}=Pt();ge.on(e=>{(e===ot.FIELD_RELOAD||e===ot.MAPPED_BY_COLUMN_CHANGE)&&h()});const Re=R(()=>{var l,n,u,r;if(((l=a.value)==null?void 0:l.type)!==m.GRID&&((n=a.value)==null?void 0:n.type)!==m.CALENDAR)return null;const e=(u=Object.values(d.value))==null?void 0:u.find(x=>x==null?void 0:x.pv);return(r=D.value)==null?void 0:r.find(x=>x.fk_column_id===(e==null?void 0:e.id))}),Fe=R(()=>D.value.filter(e=>{var l;return((l=a.value)==null?void 0:l.type)!==m.CALENDAR?e!==Re.value:!0})),he=async(e,l=!1)=>{try{if(!v.value||(l||Q({undo:{fn:()=>{if(!v.value)return;const r=v.value[e.moved.newIndex];v.value[e.moved.newIndex]=v.value[e.moved.oldIndex],v.value[e.moved.oldIndex]=r,he({moved:{newIndex:e.moved.oldIndex,oldIndex:e.moved.newIndex}},!0)},args:[]},redo:{fn:()=>{if(!v.value)return;const r=v.value[e.moved.oldIndex];v.value[e.moved.oldIndex]=v.value[e.moved.newIndex],v.value[e.moved.newIndex]=r,he(e,!0)},args:[]},scope:W({view:a.value})}),v.value.length<2))return;const n=v.value[e.moved.newIndex];if(!n)return;let u;if(e.moved.newIndex===0)u=v.value[1].order/2;else if(e.moved.newIndex===v.value.length-1)u=v.value[v.value.length-2].order+1e3;else{const r=v.value[e.moved.newIndex-1],x=v.value[e.moved.newIndex+1];u=(r.order+x.order)/2}n.order=u,await Ge(n,e.moved.newIndex,!0,!!ye.value),await h(),G.trigger(),_e("a:fields:reorder")}catch(n){Ue.error(await ll(n))}},Y=b([]),ke=async e=>{var l,n,u,r,x,j,c,F,H,L,B,N,ve;(((l=a.value)==null?void 0:l.type)===m.GALLERY||((n=a.value)==null?void 0:n.type)===m.KANBAN||((u=a.value)==null?void 0:u.type)===m.CALENDAR)&&((r=a.value)!=null&&r.id)&&((x=a.value)!=null&&x.view)&&(((j=a.value)==null?void 0:j.type)===m.GALLERY?(await se.dbView.galleryUpdate((c=a.value)==null?void 0:c.id,{fk_cover_image_col_id:e}),a.value.view.fk_cover_image_col_id=e):((F=a.value)==null?void 0:F.type)===m.KANBAN?(await se.dbView.kanbanUpdate((H=a.value)==null?void 0:H.id,{fk_cover_image_col_id:e}),a.value.view.fk_cover_image_col_id=e):((L=a.value)==null?void 0:L.type)===m.CALENDAR&&(await se.dbView.calendarUpdate((B=a.value)==null?void 0:B.id,{fk_cover_image_col_id:e}),a.value.view.fk_cover_image_col_id=e),await(oe==null?void 0:oe.trigger()),e&&!((ve=(N=v.value)==null?void 0:N.find(Ce=>Ce.fk_column_id===e))!=null&&ve.show)&&await(G==null?void 0:G.trigger({shouldShowLoading:!1})))},V=R({get:()=>{var l,n,u,r,x;const e=(((l=a.value)==null?void 0:l.type)===m.GALLERY||((n=a.value)==null?void 0:n.type)===m.KANBAN)&&((u=a.value)!=null&&u.view)?((r=a.value)==null?void 0:r.view).fk_cover_image_col_id:void 0;return(x=Y.value)!=null&&x.find(j=>j.value===e)?e:e===null?null:void 0},set:async e=>{e!==V.value&&(Q({undo:{fn:await ke,args:[V.value]},redo:{fn:await ke,args:[e]},scope:W({view:a.value})}),await ke(e))}}),I=async e=>{var l,n,u,r,x,j,c,F,H,L,B;if(!(![m.GALLERY,m.KANBAN].includes((l=a.value)==null?void 0:l.type)||!((n=a.value)!=null&&n.id)||!((u=a.value)!=null&&u.view))){if(((r=a.value)==null?void 0:r.type)===m.GALLERY){const N={...He((j=(x=a.value)==null?void 0:x.view)==null?void 0:j.meta),fk_cover_image_object_fit:e};await se.dbView.galleryUpdate((c=a.value)==null?void 0:c.id,{meta:N}),a.value.view.meta=N}else if(((F=a.value)==null?void 0:F.type)===m.KANBAN){const N={...He((L=(H=a.value)==null?void 0:H.view)==null?void 0:L.meta),fk_cover_image_object_fit:e};await se.dbView.kanbanUpdate((B=a.value)==null?void 0:B.id,{meta:N}),a.value.view.meta=N}await(oe==null?void 0:oe.trigger())}},De=[{value:qe.FIT,label:O("labels.fitImage")},{value:qe.COVER,label:O("labels.coverImageArea")}],q=b({isOpen:!1,isSaving:null}),pe=R({get:()=>{var e,l,n,u,r;return[m.GALLERY,m.KANBAN].includes((e=a.value)==null?void 0:e.type)&&((l=a.value)!=null&&l.view)?((r=He((u=(n=a.value)==null?void 0:n.view)==null?void 0:u.meta))==null?void 0:r.fk_cover_image_object_fit)||qe.FIT:void 0},set:async e=>{e!==pe.value&&(q.value.isSaving=e,Q({undo:{fn:I,args:[pe.value]},redo:{fn:I,args:[e]},scope:W({view:a.value})}),await I(e)),q.value.isSaving=null,q.value.isOpen=!1}}),$e=async()=>{Q({undo:{fn:async()=>{await ce()},args:[]},redo:{fn:async()=>{await we()},args:[]},scope:W({view:a.value})}),await we()},kt=async()=>{Q({undo:{fn:async()=>{await we()},args:[]},redo:{fn:async()=>{await ce()},args:[]},scope:W({view:a.value})}),await ce()},xt=R(()=>{var e;return((e=v.value)==null?void 0:e.filter(l=>{var n,u,r;return!(!l.initialShow&&ie.value||(u=(n=d==null?void 0:d.value)==null?void 0:n[l.fk_column_id])!=null&&u.pv||!ue.value&&Yt((r=d==null?void 0:d.value)==null?void 0:r[l.fk_column_id]))}))||[]}),Ve=b(!1),Ct=R(()=>{var e;return!pt((e=v.value)==null?void 0:e.map(l=>l.title),ne.value)||w.value}),ze=R({get:()=>{var e;return(e=xt.value)==null?void 0:e.every(l=>l==null?void 0:l.show)},set:async e=>{Ve.value=!0;try{e?await $e():await kt()}finally{Ve.value=!1}}}),Je=e=>_t(yt(e)?wt:gt,{columnMeta:e}),xe=b(!1),Ke=R({get:()=>ue.value,set:e=>{Q({undo:{fn:l=>{ue.value=!l},args:[e]},redo:{fn:l=>{ue.value=l},args:[e]},scope:W({view:a.value})}),ue.value=e}}),Pe=b(!1),Qe=b();Be(xe,e=>{e&&(ne.value="",setTimeout(()=>{var l;(l=Qe.value)==null||l.focus()},100))}),Be(v,async e=>{var j;if(!e||Ie.value||![m.GALLERY,m.KANBAN].includes((j=a.value)==null?void 0:j.type))return;const l=e.filter(c=>c.fk_column_id&&d.value[c.fk_column_id].uidt===Te.Attachment).map(c=>({value:c.fk_column_id,label:c.title}))??[];Y.value=[{value:null,label:O("labels.noImage")},...l];const n=e.filter(c=>c.fk_column_id&&d.value[c.fk_column_id].uidt===Te.Lookup).map(c=>d.value[c.fk_column_id]),u=new Set,r=async(c,F,H)=>{var B,N,ve,Ce,Ee,Oe,M;const L=H||(B=le.value)!=null&&B.id?(Ce=(ve=re.value[H||((N=le.value)==null?void 0:N.id)])==null?void 0:ve.columns)==null?void 0:Ce.find(A=>{var o;return A.id===((o=F==null?void 0:F.colOptions)==null?void 0:o.fk_relation_column_id)}):void 0;if((Ee=L==null?void 0:L.colOptions)!=null&&Ee.fk_related_model_id){await K(L.colOptions.fk_related_model_id);const A=(M=(Oe=re.value[L.colOptions.fk_related_model_id])==null?void 0:Oe.columns)==null?void 0:M.find(o=>{var ee;return o.id===((ee=F==null?void 0:F.colOptions)==null?void 0:ee.fk_lookup_column_id)});A&&qt(A)?u.add(c.id):A&&(A==null?void 0:A.uidt)===Te.Lookup&&await r(c,A,L.colOptions.fk_related_model_id)}};await Promise.allSettled(n.map(c=>r(c,c)));const x=n.filter(c=>u.has(c==null?void 0:c.id)).map(c=>({value:c.id,label:c.title}));Y.value=[...Y.value,...x]},{immediate:!0});const Z=b(!1),We=b(0),Ze=b(0);function At(){setTimeout(()=>{var e;(e=document.querySelector(".nc-fields-menu-item:last-child"))==null||e.scrollIntoView({behavior:"smooth"})},500)}const je=e=>{var l,n;return e.fk_column_id?!!(de.value&&!ie.value&&st((n=(l=le.value)==null?void 0:l.columnsById)==null?void 0:n[e.fk_column_id])):!1};function et(e){je(e)||w.value||(e.show=!e.show,S(e.show,e))}function It(e){var l,n;st((n=(l=le.value)==null?void 0:l.columnsById)==null?void 0:n[e.fk_column_id])&&(e.show=!e.show,S(e.show,e))}function Lt(){Ue.success(O("msg.toast.createField")),Z.value=!1,At()}const Ye=b(),Ft=e=>{!e&&Z.value&&(xe.value=!0)},$t=()=>{var e;Z.value=!0,Ye.value&&!((e=Ye.value)!=null&&e.shouldKeepModalOpen())&&(Z.value=!1)};return(e,l)=>{const n=Xt,u=ft,r=bt,x=Qt,j=Jt,c=Wt,F=al,H=sl,L=vt,B=Zt,N=mt,ve=yl,Ce=hl,Ee=il,Oe=Ht("e");return s(),_(L,{visible:t(xe),"onUpdate:visible":l[23]||(l[23]=M=>me(xe)?xe.value=M:null),trigger:["click"],class:"!xs:hidden","overlay-class-name":"nc-dropdown-fields-menu nc-toolbar-dropdown overflow-hidden","auto-close":t(We)===0,onVisibleChange:Ft},{overlay:i(()=>{var M,A;return[f("div",{class:"w-[320px] rounded-lg nc-table-toolbar-menu","data-testid":"nc-fields-menu",onClick:l[22]||(l[22]=$(()=>{},["stop"]))},[!t(Ie)&&(((M=t(a))==null?void 0:M.type)===t(m).GALLERY||((A=t(a))==null?void 0:A.type)===t(m).KANBAN)?(s(),g("div",Il,[f("div",Ll,y(e.$t("labels.coverImageField")),1),f("div",{class:U(["flex-1 nc-dropdown-cover-image-wrapper flex items-stretch border-1 border-gray-200 rounded-lg transition-all duration-0.3s max-w-[206px]",{"nc-disabled":t(w)}])},[p(j,{value:t(V),"onUpdate:value":l[0]||(l[0]=o=>me(V)?V.value=o:null),class:"flex-1 max-w-[calc(100%_-_33px)]","dropdown-class-name":"nc-dropdown-cover-image !rounded-lg",bordered:!1,disabled:t(w),onClick:l[1]||(l[1]=$(()=>{},["stop"]))},{suffixIcon:i(()=>[p(n,{class:"text-gray-700",icon:"arrowDown"})]),default:i(()=>[(s(!0),g(Ne,null,Xe(t(Y),o=>(s(),_(x,{key:o.value,value:o.value},{default:i(()=>[f("div",Fl,[f("div",{class:U(["flex-1 flex items-center gap-1",{"max-w-[calc(100%_-_20px)]":t(V)===o.value,"max-w-full":t(V)!==o.value}])},[o.value?(s(),_(J(Je(t(d)[o.value])),{key:0,class:"!w-3.5 !h-3.5 !text-gray-700 !ml-0"})):C("",!0),p(r,{class:"flex-1 max-w-[calc(100%_-_20px)] truncate","show-on-truncate-only":""},{title:i(()=>[E(y(o.label),1)]),default:i(()=>[E(y(o.label),1)]),_:2},1024)],2),t(V)===o.value?(s(),_(n,{key:0,id:"nc-selected-item-icon",icon:"check",class:"flex-none text-primary w-4 h-4"})):C("",!0)])]),_:2},1032,["value"]))),128))]),_:1},8,["value","disabled"]),t(pe)?(s(),_(L,{key:0,visible:t(q).isOpen,"onUpdate:visible":l[2]||(l[2]=o=>t(q).isOpen=o),disabled:t(w),placement:"bottomRight"},{overlay:i(()=>[p(H,{class:"nc-cover-image-object-fit-dropdown-menu min-w-[168px]"},{default:i(()=>[(s(),g(Ne,null,Xe(De,o=>p(F,{key:o.value,class:"!children:w-full",onClick:$(ee=>pe.value=o.value,["stop"])},{default:i(()=>[f("span",null,y(o.label),1),o.value===t(q).isSaving?(s(),_(c,{key:0,size:"regular",class:"flex-none"})):o.value===t(pe)?(s(),_(n,{key:1,icon:"check",class:"flex-none text-primary w-4 h-4"})):C("",!0)]),_:2},1032,["onClick"])),64))]),_:1})]),default:i(()=>[f("button",{class:"flex items-center px-2 border-l-1 border-gray-200 disabled:cursor-not-allowed disabled:opacity-80",disabled:t(w)},[p(n,{icon:"settings",class:U(["h-4 w-4",{"!text-brand-500":t(q).isOpen}])},null,8,["class"])],8,$l)]),_:1},8,["visible","disabled"])):C("",!0)],2)])):C("",!0),f("div",{class:"py-2",onClick:l[5]||(l[5]=$(()=>{},["stop"]))},[p(N,{ref_key:"fieldsMenuSearchRef",ref:Qe,value:t(ne),"onUpdate:value":l[4]||(l[4]=o=>me(ne)?ne.value=o:null),placeholder:e.$t("placeholder.searchFields"),class:"nc-toolbar-dropdown-search-field-input !border-none !shadow-none !h-8"},{prefix:i(()=>[p(n,{icon:"search",class:"nc-search-icon h-3.5 w-3.5 mr-1 ml-2"})]),suffix:i(()=>[f("div",Ol,[p(B,{checked:t(ze),"onUpdate:checked":l[3]||(l[3]=o=>me(ze)?ze.value=o:null),disabled:t(Ct),loading:t(Ve),size:"xsmall",class:"!mr-1 nc-fields-toggle-show-all-fields"},null,8,["checked","disabled","loading"])])]),_:1},8,["value","placeholder"])]),f("div",Sl,[f("div",Nl,[t(Fe).length?C("",!0):(s(),g("div",Ml,[l[24]||(l[24]=f("img",{src:el,class:"!w-[164px] flex-none",alt:"No search results found"},null,-1)),E(" "+y(e.$t("title.noResultsMatchedYourSearch")),1)])),p(t(dl),{modelValue:t(v),"onUpdate:modelValue":l[11]||(l[11]=o=>me(v)?v.value=o:null),"item-key":"id","ghost-class":"nc-fields-menu-items-ghost",disabled:t(w),onChange:l[12]||(l[12]=o=>he(o)),onStart:l[13]||(l[13]=o=>Pe.value=!0),onEnd:l[14]||(l[14]=o=>Pe.value=!1)},{item:i(({element:o})=>{var ee,tt;return[t(Fe).includes(o)?(s(),g("div",{key:o.id,"data-testid":`nc-fields-menu-${o.title}`,class:U(["nc-fields-menu-item pl-2 flex flex-row items-center rounded-md",{"hover:bg-gray-100":!t(w)}]),onClick:l[10]||(l[10]=$(()=>{},["stop"]))},[(s(),_(J(("iconMap"in e?e.iconMap:t(fe)).drag),{class:U(["!h-3.75 text-gray-600 mr-1",{"cursor-not-allowed":t(w),"cursor-move":!t(w)}])},null,8,["class"])),t(re)?(s(),_(ve,{key:t(Ze),column:(tt=(ee=t(le))==null?void 0:ee.columnsById)==null?void 0:tt[o.fk_column_id],disabled:!je(o),onCreated:l[8]||(l[8]=Se=>Ze.value++),"onUpdate:isOpened":l[9]||(l[9]=Se=>We.value+=Se===!0?1:-1)},{default:i(({isOpened:Se})=>[at((s(),g("div",{class:U(["flex flex-row items-center w-full truncate ml-1 py-[5px] pr-2",{"cursor-pointer":!t(w),"is-opened-add-lookup":Se}]),onClick:Ae=>et(o)},[(s(),_(J(Je(t(d)[o.fk_column_id])),{class:"!w-3.5 !h-3.5 !text-gray-600",onClick:l[6]||(l[6]=$(()=>{},["stop"]))})),p(r,{class:U(["pl-1 truncate",{"mr-3 flex-1":!je(o)&&!t(T)[o.fk_column_id]}]),"show-on-truncate-only":"",disabled:t(Pe)},{title:i(()=>[E(y(o.title),1)]),default:i(()=>[E(y(o.title),1)]),_:2},1032,["class","disabled"]),t(T)[o.fk_column_id]?(s(),g("div",Vl,[p(r,{title:t(T)[o.fk_column_id],class:"flex cursor-help"},{default:i(()=>[p(n,{icon:"info",class:"h-3.5 w-3.5 opacity-80 text-nc-content-gray-muted"})]),_:2},1032,["title"])])):C("",!0),je(o)?(s(),g("div",jl,[p(r,{disabled:Se},{title:i(()=>[E(y(e.$t("tooltip.addLookupFields")),1)]),default:i(()=>[f("div",El,[p(n,{icon:"chevronRight",class:"flex-none !w-3.5 !h-3.5"})])]),_:2},1032,["disabled"])])):C("",!0),t(a).type===t(m).CALENDAR?(s(),g("div",Tl,[p(u,{class:U([{"!text-primary !bg-brand-50 hover:!bg-brand-100 active:!bg-brand-200":o.bold,"!rounded-r-none":o.italic},"!w-5 !h-5 hover:!bg-gray-200 active:!bg-gray-300 relative"]),size:"xsmall",type:"text",disabled:t(w),onClick:$(Ae=>t(P)(o,"bold",!o.bold),["stop"])},{default:i(()=>[(s(),_(J(("iconMap"in e?e.iconMap:t(fe)).bold),{class:"!w-3.5 !h-3.5"})),o.bold?(s(),g("div",Bl)):C("",!0)]),_:2},1032,["class","disabled","onClick"]),p(u,{class:U([{"!text-primary !bg-brand-50 hover:!bg-brand-100 active:!bg-brand-200":o.italic,"!rounded-l-none":o.bold,"!rounded-r-none":o.underline},"!w-5 !h-5 hover:!bg-gray-200 active:!bg-gray-300 relative"]),size:"xsmall",type:"text",disabled:t(w),onClick:$(Ae=>t(P)(o,"italic",!o.italic),["stop"])},{default:i(()=>[(s(),_(J(("iconMap"in e?e.iconMap:t(fe)).italic),{class:"!w-3.5 !h-3.5"})),o.italic?(s(),g("div",Ul)):C("",!0)]),_:2},1032,["class","disabled","onClick"]),p(u,{class:U([{"!text-primary !bg-brand-50 hover:!bg-brand-100 active:!bg-brand-200":o.underline,"!rounded-l-none":o.italic},"!w-5 !h-5 hover:!bg-gray-200 active:!bg-gray-300 relative"]),size:"xsmall",type:"text",disabled:t(w),onClick:$(Ae=>t(P)(o,"underline",!o.underline),["stop"])},{default:i(()=>[(s(),_(J(("iconMap"in e?e.iconMap:t(fe)).underline),{class:"!w-3.5 !h-3.5"})),o.underline?(s(),g("div",Gl)):C("",!0)]),_:2},1032,["class","disabled","onClick"])])):C("",!0),f("span",{class:"flex children:flex-none",onClick:$(Ae=>et(o),["stop"])},[p(B,{checked:o.show,disabled:o.isViewEssentialField||t(w)||t(Ve),size:"xxsmall",onChange:l[7]||(l[7]=Ae=>t(_e)("a:fields:show-hide")),onClick:Ae=>It(o)},null,8,["checked","disabled","onClick"])],8,zl)],10,Dl)),[[Oe,["a:fields:show-hide"]]])]),_:2},1032,["column","disabled"])):C("",!0),l[25]||(l[25]=f("div",{class:"flex-1"},null,-1))],10,Rl)):C("",!0)]}),_:1},8,["modelValue","disabled"])])]),!t(ie)&&!t(ne)?(s(),g("div",Kl,[p(u,{class:"nc-fields-show-system-fields !px-2 !font-semibold",size:"small",type:"text",disabled:t(w),onClick:l[15]||(l[15]=o=>Ke.value=!t(Ke))},{default:i(()=>[p(n,{icon:t(Ke)?"eyeSlash":"eye",class:"!w-4 !h-4 mr-2"},null,8,["icon"]),f("span",null,y(e.$t("title.systemFields")),1)]),_:1},8,["disabled"]),t(de)?(s(),_(L,{key:0,visible:t(Z),"onUpdate:visible":l[20]||(l[20]=o=>me(Z)?Z.value=o:null),trigger:["click"],"overlay-class-name":"nc-dropdown-add-column !bg-transparent !border-none !shadow-none",placement:"right",onVisibleChange:$t},{overlay:i(()=>[f("div",Pl,[t(Z)?(s(),_(Ce,{key:0,ref_key:"editOrAddProviderRef",ref:Ye,onSubmit:l[16]||(l[16]=o=>Lt()),onCancel:l[17]||(l[17]=o=>Z.value=!1),onClick:l[18]||(l[18]=$(()=>{},["stop"])),onKeydown:l[19]||(l[19]=$(()=>{},["stop"]))},null,512)):C("",!0)])]),default:i(()=>[p(u,{class:"nc-fields-add-new-field !font-semibold !px-2",size:"small",type:"text"},{default:i(()=>[p(n,{icon:"ncPlus",class:"!w-4 !h-4 mr-1"}),f("span",null,y(t(O)("general.new"))+" "+y(t(O)("objects.field")),1)]),_:1})]),_:1},8,["visible"])):C("",!0)])):C("",!0),t(w)?(s(),_(Ee,{key:2,onOnOpen:l[21]||(l[21]=o=>xe.value=!1)})):C("",!0)])]}),default:i(()=>[p(r,{disabled:!t(Me)&&!t(Le),class:U({"nc-active-btn":t(be)})},{title:i(()=>{var M,A;return[E(y(((M=t(a))==null?void 0:M.type)===t(m).KANBAN||((A=t(a))==null?void 0:A.type)===t(m).GALLERY?e.$t("title.editCards"):e.$t("objects.fields")),1)]}),default:i(()=>[at((s(),_(u,{class:"nc-fields-menu-btn nc-toolbar-btn !h-7 !border-0",size:"small",type:"secondary","show-as-disabled":t(w)},{default:i(()=>{var M,A,o,ee;return[f("div",kl,[f("div",xl,[((M=t(a))==null?void 0:M.type)===t(m).KANBAN||((A=t(a))==null?void 0:A.type)===t(m).GALLERY?(s(),_(n,{key:0,class:"h-4 w-4",icon:"creditCard"})):(s(),_(J(("iconMap"in e?e.iconMap:t(fe)).fields),{key:1,class:"h-4 w-4"})),!t(Me)&&!t(Le)?(s(),g("span",Cl,[((o=t(a))==null?void 0:o.type)===t(m).KANBAN||((ee=t(a))==null?void 0:ee.type)===t(m).GALLERY?(s(),g(Ne,{key:0},[E(y(e.$t("title.editCards")),1)],64)):(s(),g(Ne,{key:1},[E(y(e.$t("objects.fields")),1)],64))])):C("",!0)]),t(be)?(s(),g("span",Al,y(t(be)),1)):C("",!0)])]}),_:1},8,["show-as-disabled"])),[[Oe,["c:fields"]]])]),_:1},8,["disabled","class"])]),_:1},8,["visible","auto-close"])}}}),Eo=Object.assign(ht(Yl,[["__scopeId","data-v-fb428fe2"]]),{__name:"SmartsheetToolbarFieldsMenu"});export{Eo as default};
