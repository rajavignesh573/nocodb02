const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BALLsGq5.js","./DRA9KN5F.js","./entry.CNP42Mi6.css","./DCm6TF8M.js","./Bj4kMpzI.js","./CbSESqy_.js","./Bxzk9hCO.js","./CbX26EBz.js","./TimeSelector.DAR2lbHN.css","./Bm6QmuXP.js","./CkpISeXq.js","./index.N-A1gxk9.css","./zMMvJhqz.js","./FilterInput.7KjqjE1F.css","./CI3EriLB.js","./ytmFgNfN.js","./Pagination.Cmvjwryu.css","./gAYHr7Gr.js","./DkDj6Z7Z.js","./CQa0sIfA.js","./DxC2Oool.js","./By5RWL3d.js","./Cd4chHHL.js","./boyBAVNN.js","./B94p8ToD.js","./DfIS_byq.js","./BVqTF1QK.js","./DP83Cqnl.js","./CNwEZGnv.js","./DlXIlcns.js","./Ce4xoeky.js","./VirtualCell.6f0pX0MN.css"])))=>i.map(i=>d[i]);
import{e as Ie,G as n,fO as Ce,kM as he,kL as ke,dM as ge,gf as je,r as i,ef as be,gz as Le,gx as Ee,mj as Re,g6 as Ve,kk as Me,j9 as ze,j1 as Te,Y,iZ as Ae,j2 as Pe,iw as Oe,gA as Ue,as as Ne,ki as De,n as g,kn as Z,aG as J,g as Be,iU as Se,kN as Q,bz as $e,I as x,o as u,w as I,a as W,c as j,K as _,cf as Fe,L as o,gX as Ke,ag as ee,an as te,aq as Ge,O as b,b as L,N as He,M as Xe,ap as qe,aX as B,bw as Ye,hL as Ze,a_ as S,_ as Je}from"./DRA9KN5F.js";import{_ as Qe}from"./DAm3lfXS.js";import{a as We}from"./B94p8ToD.js";import{u as et}from"./BALLsGq5.js";import{u as tt}from"./CbX26EBz.js";import"./YYodiGXA.js";import"./DkDj6Z7Z.js";import"./gAYHr7Gr.js";import"./Cd4chHHL.js";import"./boyBAVNN.js";import"./DCm6TF8M.js";import"./Bj4kMpzI.js";import"./CbSESqy_.js";import"./Bxzk9hCO.js";import"./Bm6QmuXP.js";import"./CkpISeXq.js";import"./zMMvJhqz.js";import"./CI3EriLB.js";import"./ytmFgNfN.js";import"./CQa0sIfA.js";import"./DxC2Oool.js";import"./By5RWL3d.js";import"./DfIS_byq.js";import"./BVqTF1QK.js";import"./DP83Cqnl.js";import"./CNwEZGnv.js";import"./DlXIlcns.js";import"./Ce4xoeky.js";const nt=B(()=>S(()=>import("./BALLsGq5.js").then(a=>a.L),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]),import.meta.url).then(a=>a.default||a)),at=B(()=>S(()=>import("./BALLsGq5.js").then(a=>a.U),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]),import.meta.url).then(a=>a.default||a)),ot=B(()=>S(()=>import("./BALLsGq5.js").then(a=>a.b),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]),import.meta.url).then(a=>a.default||a)),lt={class:"nc-cell-field flex items-center gap-1 w-full chips-wrapper min-h-6.5 relative"},st=Ie({__name:"ManyToMany",async setup(a){let $,F;const y=n(Ce),ne=n(he),c=n(ke),ae=n(je,ge()),E=n(be,i(!1)),R=n(Le,i(!1)),p=n(Ee,null),f=n(Re,null),oe=n(Ve,i(!1)),C=n(Me,i(!1)),l=i(!1),s=i(!1),m=i(!1),h=i(!1),K=n(ze,i()),le=n(Te,!1),V=n(Pe,Y(Ae)),se=n(Oe,Y({})),d=n(Ue,null),{isUIAllowed:ie}=Ne(),{state:M,isNew:z,removeLTARRef:re}=We(),{relatedTableMeta:ue,loadRelatedTableMeta:me,relatedTableDisplayValueProp:T,unlink:ce}=et(y,ne,z,ae.trigger);[$,F]=De(()=>me()),await $,F();const A=g(()=>!oe.value&&ie("dataEdit")&&!C.value||E.value),G=g(()=>{var e;return c!=null&&c.value?(c==null?void 0:c.value)??[]:z.value?((e=M==null?void 0:M.value)==null?void 0:e[y==null?void 0:y.value.title])??[]:[]}),P=g(()=>G.value.reduce((e,t)=>{if(!T.value)return e;const w=t[T.value];return[...e,{value:w,item:t}]},[])),pe=async e=>{z.value?await re(e,y.value):await ce(e)},fe=()=>{s.value=!1,l.value=!0,h.value=!1},de=()=>{l.value=!1,s.value=!0},v=()=>{C.value||(s.value=!0,l.value=!1,m.value=!0,h.value=!1)},O=()=>{A.value&&(l.value=!0,s.value=!1,m.value=!0,h.value=!0)};tt(n(Z,i(!1)),e=>{switch(e.key){case"Enter":l.value=!0,e.stopPropagation();break}});const U=g(()=>{var e,t;return(t=(e=ue.value)==null?void 0:e.columns)==null?void 0:t.find(w=>w.title===T.value)});J([s,l],()=>{m.value=s.value||l.value}),J(m,e=>{e||(l.value=!1,s.value=!1)},{flush:"post"});const H=n(Z,i(!1));function k(e){e.type==="click"&&(R.value||E.value||H.value)&&v()}const N=e=>{if(!(!(e instanceof KeyboardEvent)||!e.target||Ye(e))&&Ze(e))return s.value?(l.value=!1,s.value=!1):v(),!0};return Be(()=>{f==null||f.on(k),p==null||p.on(k),d==null||d.on(N),!(C.value||!le||R.value||!V)&&Se(()=>{N(se.event)||(Q(".nc-canvas-table-editable-cell-wrapper .nc-many-to-many-plus-icon",V)?O():Q(".nc-canvas-table-editable-cell-wrapper .nc-many-to-many-maximize-icon",V)?v():A.value?O():v())})}),$e(()=>{f==null||f.off(k),p==null||p.off(k),d==null||d.off(N)}),(e,t)=>{const w=Qe,X=Xe,q=He,ve=qe,_e=nt,ye=at,we=ot;return u(),x(we,{"is-open":m.value,"onUpdate:isOpen":t[5]||(t[5]=r=>m.value=r)},{overlay:I(()=>[s.value?(u(),x(_e,{key:0,modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=r=>s.value=r),"cell-value":o(G),column:o(U),onAttachRecord:fe,onEscape:t[2]||(t[2]=r=>m.value=!1)},null,8,["modelValue","cell-value","column"])):_("",!0),l.value?(u(),x(ye,{key:1,modelValue:l.value,"onUpdate:modelValue":t[3]||(t[3]=r=>l.value=r),column:o(U),"hide-back-btn":h.value,onAttachLinkedRecord:de,onEscape:t[4]||(t[4]=r=>m.value=!1)},null,8,["modelValue","column","hide-back-btn"])):_("",!0)]),default:I(()=>{var r;return[W("div",lt,[W("div",{class:ee(["chips flex items-center img-container flex-1 hm-items min-w-0 overflow-y-auto overflow-x-hidden",{"flex-wrap":o(K)!==1}]),style:Fe({maxHeight:`${("rowHeightInPx"in e?e.rowHeightInPx:o(Ke))[o(K)]}px`})},[o(P)?(u(),j(te,{key:0},[(u(!0),j(te,null,Ge(o(P),(D,xe)=>(u(),x(w,{key:xe,item:D.item,value:D.value,column:o(U),"show-unlink-button":!1,truncate:!1,onUnlink:it=>pe(D.item)},null,8,["item","value","column","onUnlink"]))),128)),((r=o(P))==null?void 0:r.length)===10?(u(),j("span",{key:0,class:"caption pointer ml-1 grey--text",onClick:b(v,["stop"])}," more... ")):_("",!0)],64)):_("",!0)],6),!o(C)||o(E)?(u(),j("div",{key:0,class:ee(["flex justify-end gap-[2px] min-h-4 items-center absolute right-0 top-0 bottom-0 many-to-many-actions",{active:o(H)}]),onClick:t[0]||(t[0]=b(()=>{},["stop"]))},[o(A)?(u(),x(q,{key:0,size:"xxsmall",type:"secondary",class:"nc-action-icon nc-many-to-many-plus-icon !h-5 !w-5",onClick:b(O,["stop"])},{default:I(()=>[L(X,{icon:"plus",class:"text-sm nc-plus h-3 w-3"})]),_:1})):_("",!0),L(ve,{title:e.$t("tooltip.expandShiftSpace"),disabled:o(R),class:"flex"},{default:I(()=>[L(q,{size:"xxsmall",type:"secondary",class:"nc-action-icon nc-many-to-many-maximize-icon !h-5 !w-5",onClick:b(v,["stop"])},{default:I(()=>[L(X,{icon:"maximize",class:"!h-3 !w.3"})]),_:1})]),_:1},8,["title","disabled"])],2)):_("",!0)])]}),_:1},8,["is-open"])}}}),Ot=Object.assign(Je(st,[["__scopeId","data-v-3a036ef3"]]),{__name:"VirtualCellManyToMany"});export{Ot as default};
