const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CtCRqrd3.js","./DRA9KN5F.js","./entry.CNP42Mi6.css","./boyBAVNN.js","./Editor.C6FZ3q1a.css","./BGGftOd4.js"])))=>i.map(i=>d[i]);
import{e as se,J as le,G as o,r as i,kU as oe,kn as ie,gA as re,Y as ue,iw as ce,gy as de,k5 as pe,ef as fe,g6 as me,T as ve,h8 as ye,gz as Ee,j9 as ke,n as _e,aG as b,eI as ge,k3 as we,j1 as Ie,kk as Ce,g as be,iU as je,bz as Ne,I as S,o as c,w as v,c as j,b as _,L as t,O as d,a as Le,K as xe,N as Se,b9 as M,bo as D,d as K,t as N,aX as T,a3 as he,fA as R,fB as Oe,ot as ze,ap as Ve,ag as Je,Q as Me,P as Ke,bw as Pe,hL as Ue,a_ as $,_ as Ae}from"./DRA9KN5F.js";import{u as Be}from"./CbX26EBz.js";const De=T(()=>$(()=>import("./CtCRqrd3.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url).then(p=>p.default||p)),Re=T(()=>$(()=>import("./BGGftOd4.js"),__vite__mapDeps([5,1,2]),import.meta.url).then(p=>p.default||p)),Te={key:0,class:"flex gap-2"},$e={key:1},Fe={key:0,class:"nc-cell-field text-xs w-full py-1 text-red-500"},Ge={key:1,class:"nc-cell-field nc-null uppercase"},We=se({__name:"Json",props:{modelValue:{}},emits:["update:modelValue"],setup(p,{emit:F}){const G=p,W=F,{showNull:q}=le(),g=o(oe,i(!1)),Q=o(ie,i(!1)),y=o(re,null),X=o(ce,ue({})),h=o(de,null),P=o(pe,i(!1)),U=o(fe,i(!1)),w=o(me,i(!1)),r=ve(G,"modelValue",W),A=i(),f=i(),Y=o(ye,i(!1)),a=i(!1),B=o(Ee,i(!1)),H=o(ke,i(void 0)),I=e=>e??null,s=_e({get:()=>A.value,set:e=>{A.value=I(e)===null?null:typeof e=="object"?JSON.stringify(e,null,2):e,U.value&&!a.value&&(r.value=I(e)===null?null:e)}});function u(e){var l;const n=e==null?void 0:e.target;(l=n==null?void 0:n.classList)!=null&&l.contains("default-value-clear")||(a.value=!0)}function C(){a.value=!1}const Z=e=>{try{return JSON.stringify(JSON.parse(e))}catch(n){return console.log(n),e}};function O(e){try{s.value=I(e)===null?null:typeof e=="string"?JSON.stringify(JSON.parse(e),null,2):e}catch{s.value=I(e)===null?null:e}}const ee=()=>{f.value=void 0,C(),g.value=!1,O(r.value)},ne=()=>{if(C(),g.value=!1,f.value||s.value===r.value)return!1;r.value=I(s.value)===null?null:Z(s.value)};b(r,e=>{O(e)},{immediate:!0}),b([s,g],()=>{try{JSON.parse(s.value),f.value=void 0}catch(e){if(s.value===void 0||s.value===null)return;f.value=e}}),b(g,()=>{C(),O(r.value)}),Be(Q,e=>{if(!w.value)switch(!0){case e.key==="Enter":if(e.preventDefault(),e.stopPropagation(),e.shiftKey)return!0;u();break;case e.metaKey:case e.altKey:case e.ctrlKey:case e.key==="Backspace":case(e.key==="Spacebar"||e.key===" "):case[...e.key].length>1:break;default:typeof s.value=="string"?s.value+=e.key:s.value||(s.value=e.key),u()}});const z=i(null);ge(z,e=>{var n;(n=e.target)!=null&&n.closest(".nc-json-action")||(g.value=!1)}),b(a,(e,n)=>{Y.value=a.value,n&&!e&&(h==null||h.trigger())});const E=e=>{e.stopPropagation()};b(z,()=>{if(!P.value)return;const e=document.querySelector(".nc-json-expanded-modal");a.value&&(e!=null&&e.parentElement)?(e.parentElement.addEventListener("click",E),e.parentElement.addEventListener("mousedown",E),e.parentElement.addEventListener("mouseup",E)):e!=null&&e.parentElement&&(e.parentElement.removeEventListener("click",E),e.parentElement.removeEventListener("mousedown",E),e.parentElement.removeEventListener("mouseup",E))});const V=e=>{if(!(!(e instanceof KeyboardEvent)||!e.target||Pe(e))&&Ue(e))return a.value?C():u(),!0},L=we(),te=o(Ie,!1),ae=o(Ce,i(!1));return be(()=>{var l,m;y==null||y.on(V),!ae.value&&te&&!a.value&&!P.value&&!U.value&&!B.value&&je(()=>{V(X.event)||u()});const e=(l=L.value)==null?void 0:l.closest("td");if(e&&!w.value){e.addEventListener("dblclick",u);return}const n=(m=L.value)==null?void 0:m.closest(".nc-data-cell, .nc-default-value-wrapper");n&&n.addEventListener("click",u)}),Ne(()=>{var l,m,k,x;y==null||y.off(V);const e=(m=(l=L.value)==null?void 0:l.closest)==null?void 0:m.call(l,"td");if(e&&!w.value){e.removeEventListener("dblclick",u);return}const n=(x=(k=L.value)==null?void 0:k.closest)==null?void 0:x.call(k,".nc-data-cell, .nc-default-value-wrapper");n&&n.removeEventListener("click",u)}),(e,n)=>{const l=Se,m=De,k=Re,x=Ve;return c(),S(M(t(a)?Ke:"div"),{visible:t(a),"onUpdate:visible":n[7]||(n[7]=J=>Me(a)?a.value=J:null),width:"auto",closable:!1,centered:"",footer:null,"wrap-class-name":t(a)?"!z-1051 nc-json-expanded-modal":null,class:Je(["relative",{"json-modal min-w-80":t(a),"min-h-6 flex items-center":!t(a)}])},{default:v(()=>[t(a)?(c(),j("div",{key:0,class:"flex flex-col w-full",onMousedown:n[4]||(n[4]=d(()=>{},["stop"])),onMouseup:n[5]||(n[5]=d(()=>{},["stop"])),onClick:n[6]||(n[6]=d(()=>{},["stop"]))},[Le("div",{class:"flex flex-row justify-between items-center -mt-2 pb-3 nc-json-action",onMousedown:n[0]||(n[0]=d(()=>{},["stop"]))},[_(l,{type:"secondary",size:"xsmall",class:"!w-7 !h-7 !min-w-[fit-content]",onClick:d(C,["stop"])},{default:v(()=>[(c(),S(M(("iconMap"in e?e.iconMap:t(D)).minimize),{class:"w-4 h-4"}))]),_:1}),t(w)?(c(),j("div",$e)):(c(),j("div",Te,[_(l,{type:"secondary",size:"small",onClick:ee},{default:v(()=>[K(N(e.$t("general.cancel")),1)]),_:1}),_(l,{type:"primary",size:"small",disabled:!!t(f)||t(s)===t(r),onClick:ne},{default:v(()=>[K(N(e.$t("general.save")),1)]),_:1},8,["disabled"])]))],32),_(m,{ref_key:"inputWrapperRef",ref:z,"model-value":t(s)??null,class:"min-w-full w-[40rem] resize overflow-auto expanded-editor","hide-minimap":!0,"disable-deep-compare":!0,"auto-focus":!0,"read-only":t(w),"onUpdate:modelValue":n[1]||(n[1]=J=>s.value=J),onKeydown:[n[2]||(n[2]=he(d(()=>{},["stop"]),["enter"])),n[3]||(n[3]=d(()=>{},["alt","stop"]))]},null,8,["model-value","read-only"]),t(f)?(c(),j("span",Fe,N(t(f).toString()),1)):xe("",!0)],32)):("ncIsNull"in e?e.ncIsNull:t(R))(t(r))&&t(q)?(c(),j("span",Ge,N(e.$t("general.null")),1)):(c(),S(k,{key:2,value:!("ncIsUndefined"in e?e.ncIsUndefined:t(Oe))(t(r))&&!("ncIsNull"in e?e.ncIsNull:t(R))(t(r))?("stringifyProp"in e?e.stringifyProp:t(ze))(t(r)):"",lines:t(H),class:"nc-cell-field"},null,8,["value","lines"])),_(x,{placement:"bottom",class:"nc-json-expand-btn hidden absolute top-0 bottom-0 right-0"},{title:v(()=>[K(N(t(B)?e.$t("title.expand"):e.$t("tooltip.expandShiftSpace")),1)]),default:v(()=>[_(l,{type:"secondary",size:"xsmall",class:"!w-5 !h-5 !min-w-[fit-content]",onClick:d(u,["stop"])},{default:v(()=>[(c(),S(M(("iconMap"in e?e.iconMap:t(D)).maximize),{class:"w-3 h-3"}))]),_:1})]),_:1})]),_:1},40,["visible","wrap-class-name","class"])}}}),Xe=Object.assign(Ae(We,[["__scopeId","data-v-1a36ce18"]]),{__name:"CellJson"});export{Xe as default};
