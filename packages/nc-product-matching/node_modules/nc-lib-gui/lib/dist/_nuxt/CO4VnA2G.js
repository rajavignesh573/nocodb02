const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BBf_5B_6.js","./DRA9KN5F.js","./entry.CNP42Mi6.css","./DCa6wpIA.js","./D9Lj0wrL.js","./BCBMEREK.js","./UsersModal.BeRwRDWg.css"])))=>i.map(i=>d[i]);
import{bi as ee,c as d,o as n,a as r,e as Re,a6 as Ie,f as Le,a9 as Be,J as qe,aR as De,r as w,n as X,Y as Ne,g as Oe,ba as Se,eL as Z,b as l,w as o,t as i,M as je,I as m,L as s,Q as D,ar as Ee,b9 as C,bo as T,d as x,N as Ve,K as f,ap as ze,an as N,ad as Ae,bB as Pe,aq as Ge,eJ as Fe,af as We,ah as Ye,ag as He,aH as Je,oF as Ke,aA as Qe,aX as Xe,a4 as v,a5 as R,a_ as Ze,_ as et}from"./DRA9KN5F.js";import{_ as tt}from"./C6valJX6.js";import{_ as st}from"./C2UaKEE0.js";import{_ as ot}from"./C_VN1MCC.js";import{_ as nt}from"./BhKW-HeQ.js";import at from"./CHRPOXXy.js";import{u as rt}from"./DCa6wpIA.js";import{u as lt}from"./HY0lXmUV.js";import{_ as it}from"./I4o4wRE2.js";import"./ytmFgNfN.js";import"./gByPF8bR.js";import"./BCBMEREK.js";import"./BMPzbwPk.js";import"./CwPFbl3n.js";const ct={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ut(b,p){return n(),d("svg",ct,p[0]||(p[0]=[r("path",{fill:"currentColor",d:"M7 21q-.825 0-1.412-.587T5 19V6q-.425 0-.712-.288T4 5t.288-.712T5 4h4q0-.425.288-.712T10 3h4q.425 0 .713.288T15 4h4q.425 0 .713.288T20 5t-.288.713T19 6v13q0 .825-.587 1.413T17 21zM17 6H7v13h10zm-7 11q.425 0 .713-.288T11 16V9q0-.425-.288-.712T10 8t-.712.288T9 9v7q0 .425.288.713T10 17m4 0q.425 0 .713-.288T15 16V9q0-.425-.288-.712T14 8t-.712.288T13 9v7q0 .425.288.713T14 17M7 6v13z"},null,-1)]))}const dt=ee({name:"material-symbols-delete-outline-rounded",render:ut}),pt={class:"nc-icon",viewBox:"0 0 256 256",width:"1.2em",height:"1.2em"};function _t(b,p){return n(),d("svg",pt,p[0]||(p[0]=[r("path",{fill:"currentColor",d:"M232.49 215.51L185 168a92.12 92.12 0 1 0-17 17l47.53 47.54a12 12 0 0 0 17-17ZM44 112a68 68 0 1 1 68 68a68.07 68.07 0 0 1-68-68"},null,-1)]))}const mt=ee({name:"ph-magnifying-glass-bold",render:_t}),vt=""+new URL("invite-team.Bc8QnPYB.png",import.meta.url).href,yt=Xe(()=>Ze(()=>import("./BBf_5B_6.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url).then(b=>b.default||b)),ft={class:"flex flex-col","data-testid":"nc-super-user-list"},gt={"data-rec":"true"},ht={class:"nc-content-max-w p-6 h-[calc(100vh_-_100px)] flex flex-col gap-6 overflow-auto nc-scrollbar-thin"},wt={class:"h-full"},xt={class:"max-w-195 mx-auto h-full"},bt={class:"flex gap-4 items-center justify-between"},kt={class:"flex gap-3 items-center justify-center"},Ut={class:"flex items-center gap-1","data-rec":"true"},$t={key:0,class:"w-full"},Mt={key:0,class:"font-weight-bold","data-rec":"true"},Ct={class:"w-full flex items-start gap-1"},Tt={class:"flex-1"},Rt={class:"nc-select-hide-item text-gray-500 text-xs whitespace-normal","data-rec":"true"},It={key:2,class:"font-weight-bold","data-rec":"true"},Lt={"data-rec":"true"},Bt={"data-rec":"true"},qt={key:0,class:"w-full pt-12 pb-4 px-2 flex flex-col items-center gap-6 text-center"},Dt={class:"text-2xl text-gray-800 font-bold"},Nt={class:"text-sm text-gray-700"},Ot={key:0,class:"px-4 py-2 flex items-center justify-center"},St={class:"flex flex-row items-center py-2.25 px-2.5 bg-gray-50 rounded-lg text-gray-700 mb-4"},jt={class:"text-ellipsis overflow-hidden select-none w-full pl-1.75",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},Et=Re({__name:"UserList",setup(b){const{api:p,isLoading:z}=Ie();z.value=!0;const{$e:k}=Le(),{t:g}=Be(),{dashboardUrl:te}=rt(),{user:A}=qe(),{copy:P}=De(),{sorts:se,sortDirection:oe,loadSorts:ne,handleGetSortedData:ae,saveOrUpdate:G}=lt("Org"),I=w([]),F=X(()=>ae(I.value,se.value)),y=w(1),O=w(10),S=w(!1),W=w(0),U=w(!1),$=w(""),M=Ne({total:0,pageSize:10,position:["bottomCenter"]}),h=Se(async(e=y.value,t=O.value)=>{y.value=e;try{const u=await p.orgUsers.list({query:{limit:t,offset:$.value.length===0?(e-1)*t:0,query:$.value}});if(!u)return;M.total=u.pageInfo.totalRows??0,M.pageSize=10,I.value=u.list}catch(u){v.error(await R(u))}},500);Oe(()=>{h(),ne()});const re=async(e,t)=>{try{await p.orgUsers.update(e,{roles:t}),v.success(g("msg.success.roleUpdated")),I.value.forEach(u=>{u.id===e&&(u.roles=t)}),k("a:org-user:role-updated",{role:t})}catch(u){v.error(await R(u))}},L=w(null),le=async()=>{var e;try{await p.orgUsers.delete((e=L.value)==null?void 0:e.id),v.success(g("msg.success.userDeleted")),await h(),!I.value.length&&y.value!==1&&(y.value--,h(y.value)),k("a:org-user:user-deleted")}catch(t){v.error(await R(t))}finally{U.value=!1,L.value=null}},ie=async e=>{try{await p.orgUsers.resendInvite(e.id),v.success(g("msg.success.inviteEmailSent")),await h()}catch(t){v.error(await R(t))}k("a:org-user:resend-invite")},ce=async e=>{if(e.invite_token){try{await P(`${te.value}#/signup/${e.invite_token}`),v.success(g("msg.success.inviteURLCopied"))}catch(t){v.error(t.message)}k("c:user:copy-url")}},ue=async e=>{try{const{reset_password_url:t}=await p.orgUsers.generatePasswordResetToken(e.id);await P(t),v.success(g("msg.success.passwordResetURLCopied")),k("c:user:copy-url")}catch(t){v.error(await R(t))}},de=()=>{S.value=!0,W.value++},pe=e=>{L.value=e,U.value=!0},j=X({get:()=>oe.value,set:e=>{if(Object.keys(e).length===0){G({});return}const[t,u]=Object.entries(e)[0];G({field:t,direction:u})}}),_e=[{key:"email",title:g("objects.users"),minWidth:220,dataIndex:"email",showOrderBy:!0},{key:"role",title:g("general.access"),basis:"30%",minWidth:272,dataIndex:"roles",showOrderBy:!0},{key:"action",title:g("labels.actions"),width:110,minWidth:110,justify:"justify-end"}],me=[{title:"objects.roleType.orgLevelCreator",subtitle:"msg.info.roles.orgCreator",value:Z.CREATOR},{title:"objects.roleType.orgLevelViewer",subtitle:"msg.info.roles.orgViewer",value:Z.VIEWER}];return(e,t)=>{const u=je,ve=tt,ye=mt,fe=Ee,Y=Ve,E=ze,ge=Fe,he=Pe,we=Ke,B=st,xe=Qe,be=dt,ke=ot,Ue=Je,$e=it,Me=nt,Ce=at,Te=yt;return n(),d("div",ft,[l(ve,null,{icon:o(()=>[l(u,{icon:"users",class:"flex-none h-5 w-5"})]),title:o(()=>[r("span",gt,i(e.$t("title.userManagement")),1)]),_:1}),r("div",ht,[r("div",wt,[r("div",xt,[r("div",bt,[l(fe,{value:s($),"onUpdate:value":t[0]||(t[0]=c=>D($)?$.value=c:null),class:"!max-w-90 !rounded-md",placeholder:e.$t("title.searchMembers"),onChange:t[1]||(t[1]=c=>s(h)())},{prefix:o(()=>[l(ye,{class:"!h-3.5 text-gray-500"})]),_:1},8,["value","placeholder"]),r("div",kt,[(n(),m(C(("iconMap"in e?e.iconMap:s(T)).reload),{class:"cursor-pointer",onClick:t[2]||(t[2]=c=>s(h)(s(y),s(O)))})),l(Y,{"data-testid":"nc-super-user-invite",size:"small",type:"primary",onClick:de},{default:o(()=>[r("div",Ut,[(n(),m(C(("iconMap"in e?e.iconMap:s(T)).plus))),x(" "+i(e.$t("activity.inviteUser")),1)])]),_:1})])]),l(Me,{"order-by":s(j),"onUpdate:orderBy":t[5]||(t[5]=c=>D(j)?j.value=c:null),columns:_e,data:s(F),"is-data-loading":s(z),class:"h-[calc(100%-58px)] max-w-250 mt-6"},{bodyCell:o(({column:c,record:a})=>{var H,J,K;return[c.key==="email"?(n(),d("div",$t,[a.display_name?(n(),m(E,{key:0,class:"truncate max-w-full"},{title:o(()=>[x(i(a.email),1)]),default:o(()=>[x(" "+i(a.display_name),1)]),_:2},1024)):(n(),m(E,{key:1,class:"truncate max-w-full","show-on-truncate-only":""},{title:o(()=>[x(i(a.email),1)]),default:o(()=>[x(" "+i(a.email),1)]),_:2},1024))])):f("",!0),c.key==="role"?(n(),d(N,{key:1},[(H=a==null?void 0:a.roles)!=null&&H.includes("super")?(n(),d("div",Mt,i(e.$t("labels.superAdmin")),1)):a.id!==((J=s(A))==null?void 0:J.id)?Ae((n(),m(he,{key:1,value:a.roles,"onUpdate:value":_=>a.roles=_,class:"w-55 nc-user-roles","dropdown-match-select-width":!1,"dropdown-class-name":"max-w-64",onChange:_=>re(a.id,a.roles)},{default:o(()=>[(n(),d(N,null,Ge(me,(_,q)=>l(ge,{key:q,class:"nc-users-list-role-option",value:_.value},{default:o(()=>[r("div",Ct,[r("div",Tt,[l(E,{"show-on-truncate-only":"",class:"truncate","data-rec":"true"},{title:o(()=>[x(i(e.$t(_.title)),1)]),default:o(()=>[x(" "+i(e.$t(_.title)),1)]),_:2},1024),r("div",Rt,i(e.$t(_.subtitle)),1)]),a.roles===_.value?(n(),m(u,{key:0,id:"nc-selected-item-icon",icon:"check",class:"w-4 h-4 text-primary"})):f("",!0)])]),_:2},1032,["value"])),64))]),_:2},1032,["value","onUpdate:value","onChange"])),[[We,!("isEeUI"in e?e.isEeUI:s(Ye))]]):(n(),d("div",It,i(e.$t("objects.roleType.orgLevelCreator")),1))],64)):f("",!0),c.key==="action"?(n(),d("div",{key:2,class:He(["flex items-center gap-2",{"opacity-0 pointer-events-none":(K=a.roles)==null?void 0:K.includes("super")}])},[l(Ue,{trigger:["click"]},{overlay:o(()=>[l(ke,{variant:"small"},{default:o(()=>{var _,q,Q;return[(_=a.roles)!=null&&_.includes("super")?f("",!0):(n(),d(N,{key:0},[l(B,{onClick:V=>ie(a)},{default:o(()=>[(n(),m(C(("iconMap"in e?e.iconMap:s(T)).email),{class:"flex text-gray-600"})),r("div",Lt,i(e.$t("activity.resendInvite")),1)]),_:2},1032,["onClick"]),l(B,{onClick:V=>ce(a)},{default:o(()=>[(n(),m(C(("iconMap"in e?e.iconMap:s(T)).copy),{class:"flex text-gray-600"})),r("div",Bt,i(e.$t("activity.copyInviteURL")),1)]),_:2},1032,["onClick"]),l(B,{onClick:V=>ue(a)},{default:o(()=>[(n(),m(C(("iconMap"in e?e.iconMap:s(T)).copy),{class:"flex text-gray-600"})),r("div",null,i(e.$t("activity.copyPasswordResetURL")),1)]),_:2},1032,["onClick"])],64)),a.id!==((q=s(A))==null?void 0:q.id)?(n(),d(N,{key:1},[(Q=a.roles)!=null&&Q.includes("super")?f("",!0):(n(),m(xe,{key:0})),l(B,{"data-rec":"true",danger:"",onClick:V=>pe(a)},{default:o(()=>[l(be),x(" "+i(e.$t("general.remove"))+" "+i(e.$t("objects.user")),1)]),_:2},1032,["onClick"])],64)):f("",!0)]}),_:2},1024)]),default:o(()=>[l(Y,{size:"xsmall",type:"ghost"},{default:o(()=>[l(we,{class:"text-gray-600 h-5.5 w-5.5 rounded outline-0 p-0.5 nc-workspace-menu transform transition-transform !text-gray-400 cursor-pointer !hover:text-gray-500 hover:bg-gray-100"})]),_:1})]),_:2},1024)],2)):f("",!0)]}),extraRow:o(()=>[s(M).total===1&&s(F).length===1?(n(),d("div",qt,[r("div",Dt,i(e.$t("placeholder.inviteYourTeam")),1),r("div",Nt,i(e.$t("placeholder.inviteYourTeamLabel")),1),t[8]||(t[8]=r("img",{src:vt,class:"!w-[30rem] flex-none"},null,-1))])):f("",!0)]),tableFooter:o(()=>[s(M).total>10?(n(),d("div",Ot,[l($e,{current:s(y),"onUpdate:current":t[3]||(t[3]=c=>D(y)?y.value=c:null),total:s(M).total,"show-less-items":"",onChange:t[4]||(t[4]=c=>s(h)(s(y),s(O)))},null,8,["current","total"])])):f("",!0)]),_:1},8,["order-by","data","is-data-loading"]),l(Ce,{visible:s(U),"onUpdate:visible":t[6]||(t[6]=c=>D(U)?U.value=c:null),"entity-name":"User","on-delete":()=>le()},{"entity-preview":o(()=>{var c;return[r("span",null,[r("div",St,[l(u,{icon:"account",class:"nc-view-icon"}),r("div",jt,i((c=s(L))==null?void 0:c.email),1)])])]}),_:1},8,["visible","on-delete"]),(n(),m(Te,{key:s(W),show:s(S),onClosed:t[7]||(t[7]=c=>S.value=!1),onReload:s(h)},null,8,["show","onReload"]))])])])])}}}),es=Object.assign(et(Et,[["__scopeId","data-v-dfdd3080"]]),{__name:"AccountUserList"});export{es as default};
