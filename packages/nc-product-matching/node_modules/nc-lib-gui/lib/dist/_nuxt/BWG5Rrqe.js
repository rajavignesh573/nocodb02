const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BVfn5qW6.js","./DRA9KN5F.js","./entry.CNP42Mi6.css"])))=>i.map(i=>d[i]);
import{bi as q,c as f,o as l,a,e as F,a9 as G,f as J,r as g,g as K,b as c,w as n,I as p,K as A,L as o,aX as Q,a1 as X,Q as I,bU as H,t as d,N as W,d as _,M as Y,an as Z,aq as ee,at as te,b9 as z,bo as P,cf as se,ag as ae,cS as le,a4 as b,a5 as j,a_ as ne,_ as oe}from"./DRA9KN5F.js";import{T as ie}from"./D9Lj0wrL.js";import{_ as re}from"./BCBMEREK.js";const ce={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function de(m,v){return l(),f("svg",ce,v[0]||(v[0]=[a("path",{fill:"currentColor",d:"M3 17.46v3.04c0 .28.22.5.5.5h3.04c.13 0 .26-.05.35-.15L17.81 9.94l-3.75-3.75L3.15 17.1q-.15.15-.15.36M20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83l3.75 3.75z"},null,-1)]))}const pe=q({name:"ic-round-edit",render:de}),ue=Q(()=>ne(()=>import("./BVfn5qW6.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(m=>m.default||m)),_e={class:"flex flex-col h-full"},fe={class:"flex flex-row justify-center mt-2 text-center w-full text-base"},me={class:"flex mt-6 justify-center space-x-2"},ve={class:"mb-5"},ge={class:"flex flex-row items-center gap-3"},we={class:"flex flex-wrap w-full gap-5"},ye={class:"install-btn flex flex-row justify-end space-x-1"},xe={class:"flex flex-row justify-center items-center caption capitalize nc-app-store-card-edit"},he={class:"flex flex-row justify-center items-center caption capitalize nc-app-store-card-reset"},be={class:"flex ml-0.5"},ke={class:"flex flex-row justify-center items-center caption capitalize nc-app-store-card-install"},Ce={class:"flex flex-row space-x-2 items-center justify-start w-full"},Se={class:"flex w-[68px]"},$e=["src"],Me={key:1},Ae={class:"flex flex-col flex-1 w-3/5 pl-3"},Ie=F({__name:"AppStore",setup(m){const{t:v}=G(),{$api:k,$e:w}=J(),y=g(null),u=g(!1),r=g(!1),i=g(null),x=async()=>{try{const t=(await k.plugin.list()).list??[];y.value=t.filter(e=>!["email","storage"].includes(e.category.toLowerCase())).map(e=>({...e,tags:e.tags?e.tags.split(","):[],parsedInput:e.input&&JSON.parse(e.input)}))}catch(t){b.error(await j(t))}},N=async()=>{try{await k.plugin.update(i.value.id,{input:null,active:!1}),b.success(v("msg.success.pluginUninstalled")),u.value=!1,await x()}catch(t){b.error(await j(t))}w("a:appstore:reset",{app:i.value.title})},B=async()=>{r.value=!1,await x(),w("a:appstore:install",{app:i.value.title})},C=async t=>{r.value=!0,i.value=t,w("c:appstore:install",{app:t.title})},E=async t=>{u.value=!0,i.value=t};return K(async()=>{y.value===null&&await x()}),(t,e)=>{const L=ue,S=H,$=W,R=Y,D=re,T=pe,h=te,U=ie,V=le;return l(),f("div",null,[c(S,X({visible:o(r),"onUpdate:visible":e[2]||(e[2]=s=>I(r)?r.value=s:null),class:{active:o(r)},closable:!1,centered:"","min-height":"300",footer:null,"wrap-class-name":"nc-modal-plugin-install"},t.$attrs),{default:n(()=>[o(i)&&o(r)?(l(),p(L,{key:0,id:o(i).id,onClose:e[0]||(e[0]=s=>r.value=!1),onSaved:e[1]||(e[1]=s=>B())},null,8,["id"])):A("",!0)]),_:1},16,["visible","class"]),c(S,{visible:o(u),"onUpdate:visible":e[4]||(e[4]=s=>I(u)?u.value=s:null),closable:!1,width:"24rem",centered:"",footer:null,"wrap-class-name":"nc-modal-plugin-uninstall"},{default:n(()=>[a("div",_e,[a("div",fe,d(`Click on confirm to reset ${o(i)&&o(i).title}`),1),a("div",me,[c($,{type:"secondary",onClick:e[3]||(e[3]=s=>u.value=!1)},{default:n(()=>[_(d(t.$t("general.cancel")),1)]),_:1}),c($,{type:"danger",onClick:N},{default:n(()=>[_(d(t.$t("general.confirm")),1)]),_:1})])])]),_:1},8,["visible"]),a("div",ve,[c(D,{type:"warning",border:""},{message:n(()=>[a("div",ge,[c(R,{icon:"ncAlertCircle",class:"text-orange-500 w-6 h-6"}),e[5]||(e[5]=a("span",{class:"font-weight-bold"},"App Store Deprecation",-1))])]),description:n(()=>e[6]||(e[6]=[a("span",{class:"text-gray-500 ml-9"}," App store will soon be removed. Email & Storage plugins are now available in Accounts/Setup page. Rest of the plugins here will be moved to integrations. ",-1)])),_:1})]),a("div",we,[(l(!0),f(Z,null,ee(o(y),(s,O)=>(l(),p(V,{key:O,class:ae(["sm:w-100 md:w-130",`relative flex overflow-x-hidden app-item-card !shadow-sm rounded-md w-full nc-app-store-card-${s.title}`])},{default:n(()=>[a("div",ye,[s.parsedInput?(l(),p(h,{key:0,size:"small",type:"primary",onClick:M=>C(s)},{default:n(()=>[a("div",xe,[c(T,{class:"pr-0.5",height:12}),_(" "+d(t.$t("general.edit")),1)])]),_:2},1032,["onClick"])):A("",!0),s.parsedInput?(l(),p(h,{key:1,size:"small",outlined:"",onClick:M=>E(s)},{default:n(()=>[a("div",he,[(l(),p(z(("iconMap"in t?t.iconMap:o(P)).closeCircle))),a("div",be,d(t.$t("general.reset")),1)])]),_:2},1032,["onClick"])):(l(),p(h,{key:2,size:"small",type:"primary",onClick:M=>C(s)},{default:n(()=>[a("div",ke,[(l(),p(z(("iconMap"in t?t.iconMap:o(P)).plus))),_(" "+d(t.$t("general.install")),1)])]),_:2},1032,["onClick"]))]),a("div",Ce,[a("div",Se,[s.title!=="SMTP"?(l(),f("img",{key:0,class:"avatar",alt:"logo",style:se({backgroundColor:s.title==="SES"?"#242f3e":""}),src:s.logo},null,12,$e)):(l(),f("div",Me))]),a("div",Ae,[c(U,{level:5},{default:n(()=>[_(d(s.title),1)]),_:2},1024),_(" "+d(s.description),1)])])]),_:2},1032,["class"]))),128))])])}}}),Ne=Object.assign(oe(Ie,[["__scopeId","data-v-b4a8d684"]]),{__name:"DashboardSettingsAppStore"});export{Ne as default};
