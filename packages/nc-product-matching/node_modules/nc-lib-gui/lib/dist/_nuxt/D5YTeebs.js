const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BWG5Rrqe.js","./DRA9KN5F.js","./entry.CNP42Mi6.css","./D9Lj0wrL.js","./BCBMEREK.js","./AppStore.CxFWjIMq.css"])))=>i.map(i=>d[i]);
import{_ as $e}from"./C6valJX6.js";import{e as re,r as f,n as J,c as g,o as i,an as ie,I as C,a as n,L as t,ap as Te,w as l,t as d,ao as le,a6 as Pe,f as De,aR as Ge,a9 as Ce,Y as Oe,b as c,K as P,b9 as Q,bo as te,N as Ie,ag as Ue,ar as Ee,d as $,eP as ce,aq as ke,Q as q,M as ue,a4 as F,a5 as ne,kh as Re,i4 as b,T as be,fS as ze,$ as je,kj as Fe,fr as Be,aG as we,aH as Ve,a1 as qe,da as Je,db as He,mA as We,b3 as Ke,O as Ae,_ as Me,J as Xe,mB as Qe,gj as Ye,aF as xe,bV as Ze,a0 as et,X as tt,gT as nt,aX as ot,a_ as at,g7 as se,ah as st}from"./DRA9KN5F.js";import{_ as lt}from"./QeWwuUYP.js";import it from"./CHRPOXXy.js";import{_ as ct}from"./6VLKQIvS.js";import{_ as rt}from"./I4o4wRE2.js";import ut from"./Cd54tGtH.js";import{_ as dt}from"./BYP-poBO.js";import{E as pt,d as mt,P as _t}from"./BaxyS14b.js";import{U as ft,a as vt}from"./phJnKPvr.js";import{u as gt}from"./DgFxZClV.js";import"./gByPF8bR.js";import"./BCBMEREK.js";import"./BMPzbwPk.js";import"./CwPFbl3n.js";import"./DVsD9aaJ.js";import"./CkpISeXq.js";const ht={class:"w-full"},yt={key:1,class:"w-full","data-testid":"truncate-label"},bt=re({__name:"TruncateText",props:{placement:{default:"bottom"},length:{default:20}},setup(y){const m=f(),k=J(()=>{var r,s,h,w;return((s=(r=m.value)==null?void 0:r.textContent)==null?void 0:s.length)&&((w=(h=m.value)==null?void 0:h.textContent)==null?void 0:w.length)>y.length}),x=J(()=>{var r,s,h,w,I,v;return(s=(r=m.value)==null?void 0:r.textContent)!=null&&s.length&&((h=m.value)==null?void 0:h.textContent.length)>y.length?`${(I=(w=m.value)==null?void 0:w.textContent)==null?void 0:I.substr(0,y.length-3)}...`:(v=m.value)==null?void 0:v.textContent});return(r,s)=>{const h=Te;return i(),g(ie,null,[t(k)?(i(),C(h,{key:0,placement:r.placement},{title:l(()=>[le(r.$slots,"default")]),default:l(()=>[n("div",ht,d(t(x)),1)]),_:3},8,["placement"])):(i(),g("div",yt,[le(r.$slots,"default")])),n("div",{ref_key:"text",ref:m,class:"hidden"},[le(r.$slots,"default")],512)],64)}}}),xt=Object.assign(bt,{__name:"GeneralTruncateText"}),kt=""+new URL("api-tokens.DEwwjpuX.png",import.meta.url).href,wt={class:"flex flex-col"},$t={"data-rec":"true"},Tt={class:"nc-content-max-w p-6 h-[calc(100vh_-_100px)] flex flex-col gap-6 overflow-auto nc-scrollbar-thin"},Ct={class:"max-w-202 mx-auto h-full w-full","data-testid":"nc-token-list"},It={class:"flex gap-4 items-baseline justify-between"},Et={class:"text-xl text-left font-bold my-0","data-rec":"true"},Mt={class:"hidden md:block","data-rec":"true"},St={class:"flex items-center justify-center md:hidden","data-rec":"true"},Nt={"data-rec":"true"},Ot={key:0,class:"mt-6 h-full max-h-[calc(100%-80px)]"},jt={class:"h-full w-full overflow-y-auto rounded-md"},At={class:"flex w-full pl-5 bg-gray-50 border-1 rounded-t-md"},Ut={class:"py-3.5 text-gray-500 font-medium text-3.5 w-2/9","data-rec":"true"},Lt={class:"py-3.5 text-gray-500 font-medium text-3.5 w-2/9 text-start","data-rec":"true"},Pt={class:"py-3.5 text-gray-500 font-medium text-3.5 w-3/9 text-start","data-rec":"true"},Dt={class:"py-3.5 pl-19 text-gray-500 font-medium text-3.5 w-2/9 text-start","data-rec":"true"},Gt={class:"nc-scrollbar-md !overflow-y-auto flex flex-col h-[calc(100%-52px)]"},Rt={key:0},zt={class:"flex w-full"},Ft={key:0,class:"text-red-500 text-xs font-light mt-1.5 ml-1","data-rec":"true"},Bt={class:"flex gap-2 justify-start"},Vt={key:1,class:"border-l-1 border-r-1 border-b-1 rounded-b-md justify-center flex items-center"},qt={class:"text-black font-bold text-3.5 text-start w-2/9"},Jt={class:"flex items-center gap-2"},Ht={class:"text-gray-500 font-medium text-3.5 text-start w-2/9"},Wt={class:"text-gray-500 font-medium text-3.5 text-start w-3/9"},Kt={key:1},Xt={class:"flex justify-end items-center gap-3 pr-5 text-gray-500 font-medium text-3.5 w-2/9"},Qt={key:1,class:"max-w-[40rem] border px-3 py-6 flex flex-col items-center justify-center gap-6 text-center"},Yt={class:"text-2xl text-gray-800 font-bold"},Zt={class:"text-sm text-gray-700"},en={class:"hidden md:block","data-rec":"true"},tn={class:"flex items-center justify-center md:hidden","data-rec":"true"},nn={key:2,class:"flex items-center justify-center mt-5"},on={class:"flex flex-row items-center py-2.25 px-2.5 bg-gray-50 rounded-lg text-gray-700 mb-4"},an={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-1.75",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},sn=re({__name:"Token",setup(y){const{api:m,isLoading:k}=Pe(),{$e:x}=De(),{copy:r}=Ge(),{t:s}=Ce(),h=f([]),w=f([]),I=Oe({isShow:!1,id:""}),v=f(1),O=f(!1),L=f(10),j=s("labels.token"),E=f({description:j}),D=f(""),G=Oe({total:0,pageSize:10}),u=f(!0),_=f(!1),z=f(""),R=f(""),S=f(!1),K=()=>{E.value.description=Re([...w.value.map(e=>(e==null?void 0:e.description)||"")],j),S.value=!0},H=e=>{I.isShow&&I.id===e?(I.isShow=!1,I.id=""):(I.isShow=!0,I.id=e)},B=async(e=G.total)=>{try{const a=await m.orgTokens.list({query:{limit:e}});if(!a)return;w.value=a.list,K()}catch(a){F.error(await ne(a))}},W=(e,a)=>{switch(e){case"add":{w.value=[...w.value,a];break}case"delete":{w.value=[...w.value.filter(M=>M.token!==a.token)];break}}K()},A=async(e=v.value,a=L.value,M=!1)=>{v.value=e;try{const N=await m.orgTokens.list({query:{limit:a,offset:D.value.length===0?(e-1)*a:0}});if(!N){u.value=!1;return}G.total=N.pageInfo.totalRows??0,G.pageSize=10,h.value=N.list,M&&(O.value=!1,E.value={}),w.value.length||await B(G.total)}catch(N){F.error(await ne(N))}finally{u.value&&(u.value=!1)}};A();const T=async e=>{var a;try{const M=(a=w.value.find(N=>N.token===e))==null?void 0:a.id;await m.orgTokens.delete(M),await A(),W("delete",{token:e}),!h.value.length&&v.value!==1&&(v.value--,A(v.value))}catch(M){F.error(await ne(M))}x("a:account:token:delete"),_.value=!1,R.value="",z.value=""},Y=e=>e?e.length<255:!1,oe=async()=>{const e=Y(E.value.description);if(S.value=e,!!e)try{const a=await m.orgTokens.create(E.value);await A(v.value,L.value,!0),W("add",a)}catch(a){F.error(await ne(a))}finally{x("a:api-token:generate")}},de=async e=>{if(e)try{await r(e),F.info(s("msg.info.copiedToClipboard")),x("c:api-token:copy")}catch(a){F.error(a.message)}},pe=(e,a)=>{R.value=e,z.value=a,_.value=!0},ae=e=>E.value.description===j&&(e==null?void 0:e.select()),me=J(()=>{var a;const e=(a=E.value.description)==null?void 0:a.length;if(e){if(e>255)return s("msg.info.tokenNameMaxLength")}else return s("msg.info.tokenNameNotEmpty")}),o=()=>{O.value=!1,S.value=!1};return(e,a)=>{const M=ct,N=$e,V=Ie,_e=Ee,fe=ce,Z=xt,ve=lt,X=Te,ge=rt,he=ue,ye=it;return i(),g("div",wt,[c(N,null,{icon:l(()=>[c(M,{class:"flex-none h-5 w-5"})]),title:l(()=>[n("span",$t,d(e.$t("title.tokens")),1)]),_:1}),n("div",Tt,[n("div",Ct,[n("div",It,[n("h6",Et,d(e.$t("title.apiTokens")),1),c(V,{disabled:t(O),class:"!rounded-md","data-testid":"nc-token-create-top",size:"middle",type:"primary",tooltip:"bottom",onClick:a[0]||(a[0]=p=>O.value=!0)},{default:l(()=>[n("span",Mt,d(e.$t("title.addNewToken")),1),n("span",St,[(i(),C(Q(("iconMap"in e?e.iconMap:t(te)).plus)))])]),_:1},8,["disabled"])]),n("span",Nt,d(e.$t("msg.apiTokenCreate")),1),!t(u)&&(t(h).length||t(O))?(i(),g("div",Ot,[n("div",jt,[n("div",At,[n("span",Ut,d(e.$t("title.tokenName")),1),n("span",Lt,d(e.$t("title.creator")),1),n("span",Pt,d(e.$t("labels.token")),1),n("span",Dt,d(e.$t("labels.actions")),1)]),n("div",Gt,[t(O)?(i(),g("div",Rt,[n("div",{class:Ue(["flex gap-5 px-3 py-2.5 text-gray-500 font-medium text-3.5 w-full nc-token-generate border-b-1 border-l-1 border-r-1",{"rounded-b-md":!t(h).length}])},[n("div",zt,[c(_e,{ref:ae,value:t(E).description,"onUpdate:value":a[1]||(a[1]=p=>t(E).description=p),"default-value":t(j),type:"text",class:"!rounded-lg !py-1",placeholder:"Token Name","data-testid":"nc-token-input",disabled:t(k),onPressEnter:oe,onInput:a[2]||(a[2]=p=>S.value=Y(t(E).description))},null,8,["value","default-value","disabled"]),t(S)?P("",!0):(i(),g("span",Ft,d(t(me)),1))]),n("div",Bt,[t(k)?P("",!0):(i(),C(V,{key:0,type:"secondary",size:"small",onClick:o},{default:l(()=>[$(d(e.$t("general.cancel")),1)]),_:1})),c(V,{type:"primary",size:"sm",loading:t(k),"data-testid":"nc-token-save-btn",onClick:oe},{default:l(()=>[$(d(e.$t("general.save")),1)]),_:1},8,["loading"])])],2)])):P("",!0),!t(h).length&&!t(O)?(i(),g("div",Vt,[c(fe,{image:("Empty"in e?e.Empty:t(ce)).PRESENTED_IMAGE_SIMPLE,description:e.$t("labels.noToken")},null,8,["image","description"])])):P("",!0),(i(!0),g(ie,null,ke(t(h),p=>(i(),g("div",{key:p.id,"data-testid":"nc-token-list",class:"flex pl-5 py-3 justify-between token items-center border-l-1 border-r-1 border-b-1"},[n("span",qt,[n("div",Jt,[c(Z,{placement:"top",length:20},{default:l(()=>[$(d(p.description),1)]),_:2},1024),p.fk_sso_client_id?(i(),C(X,{key:0,placement:"top"},{title:l(()=>[$(d(e.$t("msg.ssoTokenTooltip")),1)]),default:l(()=>[c(ve,{color:"orange",class:"!text-xs !py-0.5 !px-1.5 mr-4"},{default:l(()=>a[7]||(a[7]=[$(" SSO ")])),_:1,__:[7]})]),_:1})):P("",!0)])]),n("span",Ht,[c(Z,{placement:"top",length:20},{default:l(()=>[$(d(p.created_by),1)]),_:2},1024)]),n("span",Wt,[p.token===t(I).id&&t(I).isShow?(i(),C(Z,{key:0,placement:"top",length:29},{default:l(()=>[$(d(p.token),1)]),_:2},1024)):(i(),g("span",Kt,"************************************"))]),n("div",Xt,[c(X,{placement:"top"},{title:l(()=>[$(d(e.$t("labels.showOrHide")),1)]),default:l(()=>[(i(),C(Q(("iconMap"in e?e.iconMap:t(te)).eye),{class:"nc-toggle-token-visibility hover::cursor-pointer w-h-4 mb-[1.8px]",onClick:ee=>H(p.token)},null,8,["onClick"]))]),_:2},1024),c(X,{placement:"top"},{title:l(()=>[$(d(e.$t("general.copy")),1)]),default:l(()=>[(i(),C(Q(("iconMap"in e?e.iconMap:t(te)).copy),{class:"hover::cursor-pointer w-4 h-4 text-gray-600",onClick:ee=>de(p.token)},null,8,["onClick"]))]),_:2},1024),c(X,{placement:"top"},{title:l(()=>[$(d(e.$t("general.delete")),1)]),default:l(()=>[(i(),C(Q(("iconMap"in e?e.iconMap:t(te)).delete),{"data-testid":"nc-token-row-action-icon",class:"nc-delete-icon hover::cursor-pointer w-4 h-4",onClick:ee=>pe(p.token,p.description)},null,8,["onClick"]))]),_:2},1024)])]))),128))])])])):!t(u)&&!t(h).length&&!t(O)?(i(),g("div",Qt,[a[8]||(a[8]=n("img",{src:kt,class:"!w-[22rem] flex-none"},null,-1)),n("div",Yt,d(e.$t("placeholder.noTokenCreated")),1),n("div",Zt,d(e.$t("placeholder.noTokenCreatedLabel")),1),c(V,{class:"!rounded-lg !py-3 !h-10","data-testid":"nc-token-create",type:"primary",onClick:a[3]||(a[3]=p=>O.value=!0)},{default:l(()=>[n("span",en,d(e.$t("title.createNewToken")),1),n("span",tn,[(i(),C(Q(("iconMap"in e?e.iconMap:t(te)).plus)))])]),_:1})])):P("",!0),t(G).total>10?(i(),g("div",nn,[c(ge,{current:t(v),"onUpdate:current":a[4]||(a[4]=p=>q(v)?v.value=p:null),total:t(G).total,"show-less-items":"",onChange:a[5]||(a[5]=p=>A(t(v),t(L)))},null,8,["current","total"])])):P("",!0)]),c(ye,{visible:t(_),"onUpdate:visible":a[6]||(a[6]=p=>q(_)?_.value=p:null),"entity-name":e.$t("labels.token"),"on-delete":()=>T(t(R))},{"entity-preview":l(()=>[n("span",null,[n("div",on,[c(he,{icon:"key",class:"nc-view-icon"}),n("div",an,d(t(z)),1)])])]),_:1},8,["visible","entity-name","on-delete"])])])}}}),ln=Object.assign(sn,{__name:"AccountToken"}),cn={class:"pt-2 h-[320px]"},rn={class:"tab-title"},un={key:0,class:"h-full overflow-auto nc-scrollbar-thin flex flex-col"},dn={class:"!sticky top-0 flex gap-2 bg-nc-bg-default px-2 py-2"},pn={key:0,class:"grid px-3 auto-rows-max pb-2 gap-3 grid-cols-10"},mn={key:1,class:"flex-1 grid place-items-center"},_n={key:1,class:"p-2 flex flex-col gap-2.5 h-full"},fn={key:0,class:"flex items-center gap-4"},vn={class:"h-12 w-12 p-2"},gn={class:"flex-1 w-[calc(100%_-_108px)]"},hn={class:"text-nc-content-gray-muted text-sm"},yn={class:"flex-1"},bn={class:"ant-upload-drag-icon !text-nc-content-gray-muted !mb-2 text-center"},xn={key:0,class:"h-6 grid place-items-center"},kn={key:2,class:"h-full"},wn=re({__name:"IconSelector",props:{icon:{},iconType:{},imageCropperData:{},tabOrder:{default:()=>[b.ICON,b.IMAGE,b.EMOJI]},defaultActiveTab:{default:b.ICON},onBeforeTabChange:{type:Function,default:()=>!0}},emits:["update:icon","update:iconType","update:imageCropperData","submit"],setup(y,{emit:m}){const k=y,x=m,r=be(k,"icon",x),s=be(k,"iconType",x),h=be(k,"imageCropperData",x),{t:w}=Ce(),{getPossibleAttachmentSrc:I}=ze(),v=f(!1),O=f(!1),L=f(),j=f(""),E=f(k.defaultActiveTab),D=J({get:()=>E.value,set:o=>{k.onBeforeTabChange(o)&&(j.value="",E.value=o,je(()=>{ae()}))}}),G=J(()=>Fe(j.value)),u=o=>{r.value=o,s.value=b.ICON,x("submit"),v.value=!1},_=(o=!0)=>{r.value="",s.value="",x("submit"),o&&(v.value=!1)},z=new pt(mt,{emojisToShowFilter:o=>!(Number(o.added_in)>=14)});function R(o){r.value=o.native,s.value=b.EMOJI,x("submit"),v.value=!1}const S=f([]),K=async o=>{r.value=o,s.value=b.IMAGE,x("submit"),v.value=!1},H=f(!1),B=f(!1),W=J(()=>r.value&&s.value===b.IMAGE?I(r.value):[]),A=f(!1);function T(o){o.map(e=>F.error(`${w("msg.error.fileUploadFailed")} ${e.name}`))}const Y=o=>{const e=o.file.status;if(e==="uploading"){A.value=!0;return}if(e==="done"&&o.file.originFileObj instanceof File){h.value.imageConfig.src&&URL.revokeObjectURL(h.value.imageConfig.src);const a=URL.createObjectURL(o.file.originFileObj);h.value.imageConfig={src:a,type:o.file.originFileObj.type,name:o.file.originFileObj.name},A.value=!1,B.value=!0;return}e==="error"&&(A.value=!1,F.error(`${w("msg.error.fileUploadFailed")} ${o.file.name}`))},oe=o=>{S.value.forEach(e=>{e.uid===o.file.uid&&(e.status="done",Y({file:e,fileList:S.value}))}),o.onSuccess()},de=o=>{const e=o.size/1024/1024>2;return e&&F.error(`File ${o.name} is too big. The accepted file size is less than 2MB.`),!e||vt.LIST_IGNORE},pe=o=>{!o&&H.value&&(v.value=!0)};function ae(){D.value===b.EMOJI?setTimeout(()=>{const o=document.querySelector(".emoji-mart-search input");o&&(o.focus(),o.select())}):D.value===b.ICON&&setTimeout(()=>{var o,e,a,M,N,V;Be(L.value)?((e=(o=L.value)==null?void 0:o[0])==null||e.focus(),(M=(a=L.value)==null?void 0:a[0])==null||M.select()):((N=L.value)==null||N.focus(),(V=L.value)==null||V.select())},250)}const me=J(()=>[{title:"Icon",value:b.ICON,icon:"ncPlaceholderIcon"},{title:"Upload",value:b.IMAGE,icon:"ncUpload"},{title:"Emoji",value:b.EMOJI,icon:"ncSmile"}].sort((o,e)=>k.tabOrder.indexOf(o.value)-k.tabOrder.indexOf(e.value)));return we(B,o=>{o?H.value=!0:setTimeout(()=>{H.value=!1},500)}),we(v,o=>{o&&je(()=>{ae()})}),(o,e)=>{const a=Ie,M=ue,N=Ee,V=ce,_e=We,fe=Te,Z=Ke,ve=ft,X=He,ge=Je,he=Ve,ye=dt;return i(),g("div",null,[c(he,qe(o.$attrs,{visible:t(v),"onUpdate:visible":e[4]||(e[4]=p=>q(v)?v.value=p:null),"overlay-class-name":"w-[432px]",class:"nc-icon-selector",onVisibleChange:pe}),{overlay:l(()=>[n("div",cn,[c(ge,{"active-key":t(D),"onUpdate:activeKey":e[3]||(e[3]=p=>q(D)?D.value=p:null),class:"nc-icon-selector-dropdown-tabs h-full"},{leftExtra:l(()=>e[6]||(e[6]=[n("div",{class:"w-0"},null,-1)])),rightExtra:l(()=>[n("div",null,[c(a,{size:"xs",type:"text",disabled:!t(r),onClick:Ae(_,["stop"])},{default:l(()=>e[7]||(e[7]=[$(" Remove ")])),_:1,__:[7]},8,["disabled"])])]),default:l(()=>[(i(!0),g(ie,null,ke(t(me),p=>(i(),C(X,{key:p.value,class:"w-full",disabled:t(O)},{tab:l(()=>[n("div",rn,[c(M,{icon:p.icon,class:"flex-none"},null,8,["icon"]),$(" "+d(p.title),1)])]),default:l(()=>{var ee,Se;return[p.value===t(b).ICON?(i(),g("div",un,[n("div",dn,[c(N,{ref_for:!0,ref_key:"inputRef",ref:L,value:t(j),"onUpdate:value":e[0]||(e[0]=U=>q(j)?j.value=U:null),placeholder:o.$t("placeholder.searchIcons"),class:"nc-dropdown-search-unified-input z-10"},null,8,["value","placeholder"])]),t(G).length?(i(),g("div",pn,[(i(!0),g(ie,null,ke(t(G),({icon:U,name:Ne},Le)=>(i(),C(Q(U),{key:Le,icon:U,title:Ne,class:"w-6 hover:bg-nc-bg-gray-light cursor-pointer rounded p-1 text-nc-content-gray-subtle h-6",onClick:Xn=>u(Ne)},null,8,["icon","title","onClick"]))),128))])):(i(),g("div",mn,[c(V,{image:("Empty"in o?o.Empty:t(ce)).PRESENTED_IMAGE_SIMPLE,description:o.$t("labels.noData"),class:"!my-0"},null,8,["image","description"])]))])):P("",!0),p.value===t(b).IMAGE?(i(),g("div",_n,[t(W).length?(i(),g("div",fn,[n("div",vn,[c(_e,{srcs:t(W),class:"flex-none !object-contain max-h-full max-w-full !m-0 rounded-lg","is-cell-preview":!1},null,8,["srcs"])]),n("div",gn,[c(fe,{class:"truncate flex-1 text-current","show-on-truncate-only":""},{title:l(()=>{var U;return[$(d(((U=t(r))==null?void 0:U.title)||"Workspace logo"),1)]}),default:l(()=>{var U;return[$(" "+d(((U=t(r))==null?void 0:U.title)||"Workspace logo"),1)]}),_:1}),n("div",hn,d((ee=t(r))!=null&&ee.size?`${(((Se=t(r))==null?void 0:Se.size)/1048576).toFixed(2)} MB`:"0 MB"),1)]),n("div",null,[c(a,{"icon-only":"",type:"text",size:"xs",class:"!px-1",onClick:e[1]||(e[1]=U=>_(!1))},{icon:l(()=>[c(M,{icon:"deleteListItem"})]),_:1})])])):P("",!0),n("div",yn,[c(ve,{"file-list":t(S),"onUpdate:fileList":e[2]||(e[2]=U=>q(S)?S.value=U:null),name:"file",accept:"image/*",disabled:t(A),multiple:!1,"show-upload-list":!1,class:"nc-icon-selector-image-uploader","custom-request":oe,"before-upload":de,onChange:Y,onReject:T},{default:l(()=>[n("div",bn,[t(A)?(i(),g("div",xn,[c(Z,{size:"regular"})])):(i(),C(M,{key:1,icon:"upload",class:"h-6 w-6"}))]),e[8]||(e[8]=n("div",{class:"ant-upload-text !text-nc-content-gray-muted !text-sm"},[$(" Drop your icon here or "),n("span",{class:"text-nc-content-brand hover:underline"},"browse file"),n("div",{class:"mt-1"},"Supported: image/*")],-1))]),_:1,__:[8]},8,["file-list","disabled"])])])):P("",!0),p.value===t(b).EMOJI?(i(),g("div",kn,[c(t(_t),{data:t(z),native:!0,"show-preview":!1,color:"#40444D","auto-focus":!0,"show-categories":!1,i18n:{search:"Search emoji"},class:"nc-icon-selector-emoji-picker",onSelect:R,onClick:Ae(()=>{},["stop"])},null,8,["data"])])):P("",!0)]}),_:2},1032,["disabled"]))),128))]),_:1},8,["active-key"])])]),default:l(()=>[le(o.$slots,"default",{isOpen:t(v),icon:t(r),iconType:t(s)},void 0,!0)]),_:3},16,["visible"]),c(ye,{"show-cropper":t(B),"onUpdate:showCropper":e[5]||(e[5]=p=>q(B)?B.value=p:null),"cropper-config":t(h).cropperConfig,"image-config":t(h).imageConfig,"upload-config":t(h).uploadConfig,onSubmit:K},null,8,["show-cropper","cropper-config","image-config","upload-config"])])}}}),$n=Object.assign(Me(wn,[["__scopeId","data-v-9faf33fc"]]),{__name:"GeneralIconSelector"}),Tn={class:"flex flex-col"},Cn={"data-rec":"true"},In={class:"h-[calc(100vh_-_100px)] flex flex-col gap-6 overflow-auto nc-scrollbar-thin"},En={class:"h-full nc-content-max-w p-6"},Mn={class:"flex flex-col w-150 mx-auto"},Sn={class:"nc-settings-item-card-wrapper mt-5"},Nn={class:"nc-settings-item-heading text-nc-content-gray-emphasis"},On={class:"nc-settings-item-card p-6"},jn={class:"flex gap-4"},An={class:"flex-1 flex flex-col gap-4"},Un={class:"text-gray-800 mb-2","data-rec":"true"},Ln={class:"text-gray-800 mb-2","data-rec":"true"},Pn={class:"flex flex-row w-full justify-end mt-8 gap-4"},Dn=re({__name:"Profile",setup(y){const{user:m}=Xe(),{t:k}=Ce(),x=f(!1),r=f(!1),s=f({title:"",email:"",icon:"",iconType:""}),h=J(()=>{var u;return!!(s.value.title&&s.value.title!==((u=m.value)==null?void 0:u.display_name))}),{updateUserProfile:w}=gt(),I=f(),v={title:[{required:!0,message:k("msg.error.nameRequired")},{min:2,message:k("msg.error.nameMinLength")},{max:60,message:k("msg.error.nameMaxLength")}]},O=async()=>{try{return await I.value.validate()}catch{return!1}},L=()=>{var u;return{...(u=m.value)!=null&&u.meta?xe(m.value.meta):{},icon:s.value.iconType===b.IMAGE&&nt(s.value.icon)?{...s.value.icon,data:""}:s.value.icon,iconType:s.value.iconType}},j=async(u=!1)=>{var _,z;if(!u){if(!((((_=m.value)==null?void 0:_.display_name)??"")!==s.value.title))return;if(await O())x.value=!1;else{x.value=!0;return}}r.value=!0;try{await w({attrs:{...u?{meta:L()}:{display_name:(z=s.value)==null?void 0:z.title}}})}catch(R){console.error(R),F.error(await ne(R))}finally{r.value=!1}},E=J(()=>{var u;return(u=m.value)==null?void 0:u.email}),D=f({cropperConfig:{stencilProps:{aspectRatio:1,fillDefault:!0,circlePreview:!0},minHeight:150,minWidth:150},imageConfig:{src:"",type:"image",name:"icon"},uploadConfig:{path:[Ye,"profile","icon"].join("/"),scope:Qe.PROFILEPICS,maxFileSize:2*1024*1024}});we(m,()=>{var u,_;m.value&&(x.value||(s.value.title=s.value.title||(m.value.display_name??"")),s.value.email=m.value.email,s.value.icon=((u=xe(m.value.meta))==null?void 0:u.icon)??"",s.value.iconType=((_=xe(m.value.meta))==null?void 0:_.iconType)??"")},{immediate:!0});const G=()=>{var u;s.value.title=((u=m.value)==null?void 0:u.display_name)??""};return(u,_)=>{const z=ue,R=$e,S=Ze,K=$n,H=Ee,B=et,W=Ie,A=tt;return i(),g("div",Tn,[c(R,null,{icon:l(()=>[c(z,{class:"flex-none !h-5 !w-5",icon:"user"})]),title:l(()=>[n("span",Cn,d(u.$t("labels.profile")),1)]),_:1}),n("div",In,[n("div",En,[n("div",Mn,[n("div",Sn,[n("div",Nn,d(u.$t("labels.accountDetails")),1),n("div",On,[c(A,{ref_key:"formValidator",ref:I,layout:"vertical","no-style":"",model:t(s),class:"w-full",onFinish:_[6]||(_[6]=()=>j())},{default:l(()=>[n("div",jn,[n("div",null,[c(K,{icon:t(s).icon,"onUpdate:icon":_[0]||(_[0]=T=>t(s).icon=T),"icon-type":t(s).iconType,"onUpdate:iconType":_[1]||(_[1]=T=>t(s).iconType=T),"image-cropper-data":t(D),"onUpdate:imageCropperData":_[2]||(_[2]=T=>q(D)?D.value=T:null),"default-active-tab":t(b).IMAGE,"tab-order":[t(b).IMAGE,t(b).ICON,t(b).EMOJI],onSubmit:_[3]||(_[3]=()=>j(!0))},{default:l(({isOpen:T})=>[n("div",{class:Ue(["border-1 w-26.25 h-26.25 flex-none rounded-full overflow-hidden transition-all duration-300 cursor-pointer",{"border-transparent":!T&&t(s).iconType===t(b).IMAGE,"border-nc-gray-medium":!T&&t(s).iconType!==t(b).IMAGE,"border-primary shadow-selected":T}])},[c(S,{size:"xlarge",user:t(m),class:"!w-full !h-full !min-w-full select-none cursor-pointer"},null,8,["user"])],2)]),_:1},8,["icon","icon-type","image-cropper-data","default-active-tab","tab-order"])]),n("div",An,[n("div",null,[n("div",Un,d(u.$t("general.name")),1),c(B,{name:"title",rules:v.title,class:"!my-0"},{default:l(()=>[c(H,{value:t(s).title,"onUpdate:value":_[4]||(_[4]=T=>t(s).title=T),class:"w-full !rounded-lg !px-4 h-10",placeholder:u.$t("general.name"),"data-testid":"nc-account-settings-rename-input"},null,8,["value","placeholder"])]),_:1},8,["rules"])]),n("div",null,[n("div",Ln,d(u.$t("labels.accountEmailID")),1),c(H,{value:t(E),"onUpdate:value":_[5]||(_[5]=T=>q(E)?E.value=T:null),class:"w-full !rounded-lg !px-4 h-10",placeholder:u.$t("labels.email"),disabled:"","data-testid":"nc-account-settings-email-input"},null,8,["value","placeholder"])])])]),n("div",Pn,[t(h)?(i(),C(W,{key:0,type:"secondary",size:"small","data-testid":"nc-account-settings-cancel",disabled:t(r),onClick:G},{default:l(()=>[$(d(u.$t("general.cancel")),1)]),_:1},8,["disabled"])):P("",!0),c(W,{type:"primary","html-type":"submit",size:"small",disabled:t(x)||!t(h)||t(r),loading:t(r),"data-testid":"nc-account-settings-save"},{loading:l(()=>[$(d(u.$t("general.saving")),1)]),default:l(()=>[$(" "+d(u.$t("general.save")),1)]),_:1},8,["disabled","loading"])])]),_:1},8,["model"])])])])])])])}}}),Gn=Object.assign(Dn,{__name:"AccountProfile"}),Rn=ot(()=>at(()=>import("./BWG5Rrqe.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url).then(y=>y.default||y)),zn={},Fn={class:"flex flex-col"},Bn={"data-rec":"true"},Vn={class:"nc-content-max-w p-6 h-[calc(100vh_-_100px)] flex flex-col gap-6 overflow-auto nc-scrollbar-thin"};function qn(y,m){const k=ue,x=$e,r=Rn;return i(),g("div",Fn,[c(x,null,{icon:l(()=>[c(k,{icon:"appStore",class:"flex-none text-[20px] h-5 w-5"})]),title:l(()=>[n("span",Bn,d(y.$t("title.appStore")),1)]),_:1}),n("div",Vn,[n("div",null,[c(r)])])])}const Jn=Object.assign(Me(zn,[["render",qn]]),{__name:"AccountAppStore"}),Hn={},Wn={key:4};function Kn(y,m){const k=ln,x=ut,r=Gn,s=Jn;return i(),g("div",null,[(y._.provides[se]||y.$route).params.page==="tokens"?(i(),C(k,{key:0})):(y._.provides[se]||y.$route).params.page==="setup"?(i(),C(x,{key:1})):(y._.provides[se]||y.$route).params.page==="profile"?(i(),C(r,{key:2})):(y._.provides[se]||y.$route).params.page==="apps"&&!("isEeUI"in y?y.isEeUI:t(st))?(i(),C(s,{key:3})):(i(),g("span",Wn))])}const fo=Me(Hn,[["render",Kn]]);export{fo as default};
