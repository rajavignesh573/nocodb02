import{bi as G,c as u,o as c,a,e as O,J as T,r as h,g as H,i as L,b as l,w as n,N as U,M as E,d as p,t as i,ap as J,L as t,ag as I,ad as g,af as x,I as P,b9 as Q,bo as W,oQ as Y,an as N,_ as q}from"./DRA9KN5F.js";import{u as K}from"./xPXNcuDa.js";import"./BYKJ-MHf.js";import"./gByPF8bR.js";import"./DkDj6Z7Z.js";import"./B94p8ToD.js";import"./gAYHr7Gr.js";import"./Cd4chHHL.js";import"./boyBAVNN.js";import"./BMufqs0w.js";import"./yMSt-9W5.js";import"./C83syoBY.js";import"./CbX26EBz.js";const X={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Z(z,f){return c(),u("svg",X,f[0]||(f[0]=[a("path",{fill:"currentColor",d:"M4 4h3l2-2h6l2 2h3a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2m8 3a5 5 0 0 0-5 5a5 5 0 0 0 5 5a5 5 0 0 0 5-5a5 5 0 0 0-5-5m0 2a3 3 0 0 1 3 3a3 3 0 0 1-3 3a3 3 0 0 1-3-3a3 3 0 0 1 3-3"},null,-1)]))}const ee=G({name:"mdi-camera",render:Z}),te={class:"w-full relative h-full"},ae={key:0,class:"w-full h-full flex bg-gray-50 items-center justify-center"},se={class:"p-5 bg-white rounded-md shadow-sm"},oe={class:"text-gray-800 font-semibold text-center text-xl"},le={class:"w-full gap-3 h-full flex-col flex items-center justify-between"},ne={class:"flex group flex-col"},ie={class:"relative text-[12px] font-semibold text-gray-800 flex"},re={class:"flex-auto truncate line-height-4"},ce={class:"flex-none hide-ui transition-all transition-ease-in-out !h-4 flex items-center bg-white"},de={class:"flex-none text-[10px] font-semibold text-gray-500"},me={class:"flex gap-2 pr-2 bottom-1 relative w-full items-center justify-end"},ue=O({__name:"Camera",emits:["update:visible","upload"],setup(z,{emit:f}){const b=f,{isLoading:_,startCamera:D,stopCamera:R,videoStream:y,permissionGranted:S}=K(),{isMobileMode:V}=T(),o=h(null),d=h(),w=h(),v=async()=>{try{if(await D(),!d.value||!y.value)return;d.value.srcObject=y.value}catch{}},C=()=>{R(),d.value&&(d.value.srcObject=null)},A=()=>{o.value=null,v()},F=()=>{const e=d.value,s=w.value;if(!e||!s)return;s.width=e.videoWidth,s.height=e.videoHeight;const m=s.getContext("2d");m&&(s.style.display="block",m.translate(s.width,0),m.scale(-1,1),m.drawImage(e,0,0,s.width,s.height),s.toBlob(r=>{r&&(o.value=new File([r],`${new Date().toDateString()}.png`,{type:"image/png"}))},"image/png"),C())},k=()=>{b("update:visible",!1)};return H(()=>{v()}),L(()=>{C()}),(e,s)=>{var $,j;const m=E,r=U,B=J,M=ee;return c(),u("div",te,[l(B,{class:"absolute top-3 right-2"},{title:n(()=>[p(i(e.$t("general.close")),1)]),default:n(()=>[l(r,{type:"text",class:"!border-0",size:"xsmall",onClick:k},{default:n(()=>[l(m,{icon:"close"})]),_:1})]),_:1}),t(S)?(c(),u("div",{key:1,class:I([{"py-8":!t(o),"pt-8 pb-2":t(o)},"w-full gap-3 h-full flex-col flex items-center justify-between"])},[g(a("div",le,[a("video",{ref_key:"videoRef",ref:d,class:"rounded-md",style:{width:"400px"},autoplay:""},null,512),l(r,{class:"!rounded-full !px-0",onClick:F},{default:n(()=>[l(M,{class:"text-xl"})]),_:1})],512),[[x,!t(o)]]),g(a("div",ne,[a("canvas",{ref_key:"canvasRef",ref:w,class:I(["rounded-md mb-2",t(V)?"w-[350px]":"w-[400px]"])},null,2),a("div",ie,[a("div",re,i(($=t(o))==null?void 0:$.name),1),a("div",ce,[l(B,{placement:"bottom"},{title:n(()=>[p(i(e.$t("title.removeFile")),1)]),default:n(()=>[(c(),P(Q(("iconMap"in e?e.iconMap:t(W)).delete),{class:"!text-red-500 cursor-pointer",onClick:A}))]),_:1})])]),a("div",de,i(("formatBytes"in e?e.formatBytes:t(Y))((j=t(o))==null?void 0:j.size,0)),1)],512),[[x,t(o)]]),g(a("div",me,[l(r,{disabled:t(_),type:"secondary",size:"small",onClick:k},{default:n(()=>[p(i(e.$t("labels.cancel")),1)]),_:1},8,["disabled"]),l(r,{loading:t(_),size:"small",onClick:s[0]||(s[0]=pe=>b("upload",[t(o)]))},{default:n(()=>[t(_)?(c(),u(N,{key:1},[p(i(e.$t("labels.uploading")),1)],64)):(c(),u(N,{key:0},[p(i(e.$t("labels.uploadImage")),1)],64))]),_:1},8,["loading"])],512),[[x,t(o)]])],2)):(c(),u("div",ae,[a("div",{class:"flex flex-col hover:bg-white p-2 cursor-pointer rounded-md !transition-all transition-ease-in-out duration-300 gap-2 items-center justify-center",onClick:v},[a("div",se,[l(M,{class:"text-4xl text-gray-800"})]),a("h1",oe,i(e.$t("labels.allowAccessToYourCamera")),1)])]))])}}}),$e=Object.assign(q(ue,[["__scopeId","data-v-6ca8b8d8"]]),{__name:"CellAttachmentUploadProvidersCamera"});export{$e as default};
