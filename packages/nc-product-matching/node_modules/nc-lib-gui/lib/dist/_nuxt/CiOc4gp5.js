const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DzI8hkox.js","./DRA9KN5F.js","./entry.CNP42Mi6.css","./gAYHr7Gr.js","./PlainCell.CJha1QXQ.css","./Xx6o57R-.js","./QeWwuUYP.js","./index._6B72PDH.css","./BUnSBgDC.js","./i1vswrRY.js","./VRecordCard.CsyjeVpL.css","./Bw607vNV.js","./CQa0sIfA.js","./DkDj6Z7Z.js","./B94p8ToD.js","./Cd4chHHL.js","./boyBAVNN.js","./yMSt-9W5.js","./BYKJ-MHf.js","./By5RWL3d.js","./D7poRkS0.js","./C2xdh4Xe.js","./CI3EriLB.js","./C2UaKEE0.js","./Item.GTPiKSkc.css","./C_VN1MCC.js","./index.CMurbi1o.css","./owbQkEXm.js","./DivDataCell.3R8zfazT.css","./DlXIlcns.js","./DP83Cqnl.js","./CVZBrAgI.js","./LhVKWcKT.js","./B89wxTuy.js","./DjPyxH1k.js","./Markdown.CUPXKfeQ.css","./DCa6wpIA.js","./B8gs0dG7.js","./mXY_vhPu.js","./Comments.DTONmK0N.css","./B1qoNiTF.js","./CbX26EBz.js","./TimeSelector.DAR2lbHN.css","./CYKJe2Bk.js","./DkpDpjnr.js","./Dv0nYk-Y.js","./Cell.BBaBjsLL.css","./CHRPOXXy.js","./gByPF8bR.js","./Modal.CB1oWLel.css","./BCBMEREK.js","./DGFEr0h-.js","./DfIS_byq.js","./YbUkeyWR.js","./lL-0_K96.js","./CIOK9Y4w.js","./CNwEZGnv.js","./BVqTF1QK.js","./Ce4xoeky.js","./C3FZdmXk.js","./index.C8L8AhJa.css","./DDmv9w84.js","./DWLi1ZcL.js","./LockView.BWC8JyQk.css","./BALLsGq5.js","./DCm6TF8M.js","./Bj4kMpzI.js","./CbSESqy_.js","./Bxzk9hCO.js","./Bm6QmuXP.js","./CkpISeXq.js","./index.N-A1gxk9.css","./zMMvJhqz.js","./FilterInput.7KjqjE1F.css","./ytmFgNfN.js","./Pagination.Cmvjwryu.css","./DxC2Oool.js","./VirtualCell.6f0pX0MN.css","./CC4cUItJ.js","./EcM5l_HA.js","./BLPDl4Qg.js","./CsX17Y_h.js","./C_gbauhL.js","./BmscXXs6.js","./ColumnMenu.tCfxYPwr.css","./CG-5KGUk.js","./CkvAmLZt.js","./D7OHpRdS.js","./DvtLu3FC.js","./D_txg4HT.js","./SelectOptions.BDAXdwVJ.css","./JqUqXTOd.js","./I4o4wRE2.js","./BMPzbwPk.js","./CwPFbl3n.js","./C5HnjaiI.js","./CBhmoxRW.js","./Bc3_tI4-.js","./CJAyvGKH.js","./D43249YX.js","./U3gU45AW.js","./BBg0y0zb.js","./-iDxnmJF.js","./EditOrAddProvider.C1S70ahv.css","./C1XMFoVa.js","./C-ZUx0lq.js","./YYodiGXA.js","./C316Za7m.js","./CKrOnbU4.js","./index.DA-8lYYb.css"])))=>i.map(i=>d[i]);
import{e as yt,f as ht,r as L,fq as Mt,G as Oe,bX as xt,as as zt,bd as bt,gg as kt,n as te,g as Rt,bQ as Dt,bz as Tt,o6 as It,o5 as Ct,el as Ve,aG as We,ac as Et,c as S,o as b,K as me,a as U,L as n,cf as qe,ag as Q,t as fe,an as Y,aq as Z,b as Le,I as we,w as ee,ad as St,N as Ot,aX as Me,aH as Vt,O as Ge,ba as Lt,a_ as xe,_ as jt}from"./DRA9KN5F.js";import{_ as Pt}from"./DC2mN-gQ.js";import{i as Je,e as ve}from"./gAYHr7Gr.js";import{a as At}from"./15xfm8CF.js";import{u as Bt}from"./CQa0sIfA.js";import{u as Ht}from"./D7poRkS0.js";import"./DkDj6Z7Z.js";import"./C2xdh4Xe.js";import"./boyBAVNN.js";const $t=Me(()=>xe(()=>import("./DzI8hkox.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url).then(j=>j.default||j)),Ft=Me(()=>xe(()=>import("./Xx6o57R-.js"),__vite__mapDeps([5,1,2,6,7,8]),import.meta.url).then(j=>j.default||j)),Nt=Me(()=>xe(()=>import("./i1vswrRY.js"),__vite__mapDeps([9,1,2,8,10]),import.meta.url).then(j=>j.default||j)),Ut=Me(()=>xe(()=>import("./Bw607vNV.js").then(j=>j.R),__vite__mapDeps([11,1,2,12,13,14,3,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,6,7,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109]),import.meta.url).then(j=>j.default||j)),Xt={class:"flex w-full items-center"},Yt={class:"flex sticky h-6 z-4 top-0 pl-16 bg-gray-50 w-full"},Wt={key:1,class:"sticky top-6 bg-white z-4 inset-x-0 w-full"},qt=["onDblclick","onClick"],Gt={class:"text-xs"},Jt={class:"bg-nc-bg-default px-4 gap-3 flex flex-col py-4 max-h-70 overflow-y-auto"},Kt={key:1,class:"text-gray-500"},Qt={class:"absolute pointer-events-none z-2 inset-0 overflow-hidden !mt-5.95","data-testid":"nc-calendar-week-record-container"},Zt=["data-testid","data-unique-id","onMousedown","onMouseover"],eo={class:"text-xs font-medium text-gray-400"},to=yt({__name:"DateTimeField",emits:["expandRecord","newRecord"],setup(j,{emit:Ke}){const ze=Ke,{selectedDateRange:X,formattedData:W,formattedSideBarData:je,calendarRange:oe,selectedDate:Qe,displayField:ne,viewMetaProperties:Ze,selectedTime:pe,updateRowProperty:be,sideBarFilterOption:et,showSideMenu:tt,updateFormat:ge,timezoneDayjs:s,isSyncedFromColumn:ot}=At(),{isSyncedTable:nt}=Bt(),{$e:Pe}=ht(),B=L(null),G=L(null),{width:_e}=Mt(B),at=Oe(xt,L(!1)),{isUIAllowed:q}=zt(),ae=Oe(bt,L()),rt=Oe(kt,L()),{fields:st}=Ht(),ke=te(()=>(st.value??[]).reduce((e,t)=>(e[t.fk_column_id]={bold:!!t.bold,italic:!!t.italic,underline:!!t.underline},e),{})),re=e=>{let t=e.day()-1;return t===-1&&(t=6),t},P=te(()=>{var e;return(e=Ze.value)!=null&&e.hide_weekend?5:7}),se=L(s.dayjsTz()),lt=te(()=>{if(!_e.value)return{top:0,left:0};const e=_e.value/P.value*re(se.value),t=se.value.hour()*60+se.value.minute(),a=52/60*t-12;return{width:`${_e.value/P.value}px`,top:`${a}px`,left:`${e}px`}});Rt(()=>{const e=Dt(()=>{se.value=s.dayjsTz()},1e4);Tt(()=>{clearInterval(e)})});const le=te(()=>{const e=s.timezonize(X.value.start);return Array.from({length:P.value},(t,a)=>Array.from({length:24},(d,u)=>e.add(a,"day").hour(u).minute(0).second(0)))}),it=(e,t,a)=>{const d=t.hour(),u=a.hour(),l=Math.max((le.value[e]??[]).findIndex(h=>h.hour()===d),0);let w=(le.value[e]??[]).findIndex(h=>h.hour()===u);return a.minute()>0&&u<23&&w++,w=Math.max(w,0),{startHourIndex:l,endHourIndex:w,startMinutes:t.minute(),endMinutes:a.minute()}},ie=It(({startDate:e,endDate:t,scheduleStart:a,scheduleEnd:d})=>(t!=null&&t.isValid()||(t=e.clone().add(15,"minutes")),t.diff(e,"minute")<=60&&(t=e.clone().add(59,"minutes")),e.isBefore(a,"minutes")&&(e=a.clone()),t.isAfter(d,"minutes")&&(t=d.clone()),{startDate:e,endDate:t})),Ae=(e,t=!1)=>{const a=e.hour()*60+e.minute();return t?Math.ceil(a):Math.floor(a)},Be=(e,t)=>({from:Ae(e),to:Ae(t,!0)-1,dayIndex:re(e)}),dt=(e,t)=>{var u,l,w;const{fromDate:a,toDate:d}=t;if(!a||!d)return!1;for(const h of e){const D=(u=h.rowMeta.range)==null?void 0:u.fk_from_col,i=(l=h.rowMeta.range)==null?void 0:l.fk_to_col;if(!D)return!1;const{startDate:m,endDate:g}=ie({startDate:s.timezonize(h.row[D.title]),endDate:i&&((w=Ve(h.row[i.title]))!=null&&w.isValid())?s.timezonize(h.row[i.title]):s.timezonize(h.row[D.title]).add(1,"hour").subtract(1,"minute"),scheduleStart:s.dayjsTz(X.value.start).startOf("day"),scheduleEnd:s.dayjsTz(X.value.end).endOf("day")});if(a.isBetween(m,g,null,"[]")||d.isBetween(m,g,null,"[]"))return!1}return!0},ut=({row:e,columnArray:t,graph:a})=>{const d=e.rowMeta.id,u=new Set,l=e.rowMeta.dayIndex,w=t[l].findIndex(m=>m.findIndex(g=>g.rowMeta.id===d)!==-1)+1,h=m=>{u.add(m);let g=1;const R=a.get(m);if(R)for(const T of R){if(g>=t[l].length)return g;u.has(T)||(g=Math.min(Math.max(g,h(T)+1),t[l].length))}return g};let D=1;a.has(d)&&h(d);const i=[];return t[l].flat().filter(m=>u.has(m.rowMeta.id)).forEach(m=>{i.push(m.rowMeta.overLapIteration)}),D=(i==null?void 0:i.length)>0?Math.max(...i):1,{maxOverlaps:D,dayIndex:l,overlapIndex:w}},Re=L(!1),De=L(),Te=L(),ye=L(),H=L(null),de=L(!1),k=L(null),F=te(()=>{if(!W.value||!oe.value||!B.value||!G.value)return{records:[],gridTimeMap:new Map,spanningRecords:[]};const e=_e.value/P.value,t=52,a=s.dayjsTz(X.value.start).startOf("day");let d=s.dayjsTz(X.value.end).endOf("day");P.value===5&&(d=d.subtract(2,"day"));const u=[[[]]],l=new Map,w=[],h=[];return oe.value.forEach(D=>{var T,r,I,v,_,c,A,V,z,C;const i=D.fk_from_col,m=D.fk_to_col,g=[...W.value].filter(o=>{if(i&&m){const f=s.timezonize(o.row[i.title]),y=s.timezonize(o.row[m.title]);if(f.isValid()&&y.isValid())return f.isSame(y,"day")?!0:(h.push(o),!1)}return i&&!!o.row[i.title]}).sort((o,f)=>s.timezonize(o.row[i.title]).isBefore(s.timezonize(f.row[i.title]))?1:-1);for(const o of g){const f=o.rowMeta.id??Ct();if(i&&m){const{startDate:y,endDate:x}=ie({startDate:s.timezonize(o.row[i.title]),endDate:s.timezonize(o.row[m.title]),scheduleStart:a,scheduleEnd:d}),M=re(y),{startHourIndex:O,startMinutes:p}=it(M,y,x);let $={};const E=(O+p/60)*t,N=x.diff(y,"minute")/60*t;$={...$,top:`${E}px`,height:`${N}px`},w.push({...o,rowMeta:{...o.rowMeta,id:f,style:$,range:D,position:"rounded",dayIndex:M}})}else if(i){const{startDate:y}=ie({startDate:s.timezonize(o.row[i.title]),endDate:s.timezonize(o.row[i.title]).add(1,"hour").subtract(1,"minute"),scheduleStart:a,scheduleEnd:d});let x={};const M=re(y),O=(y.minute()/60+y.hour())*t;x={...x,top:`${O+1}px`,height:`${t-2}px`},w.push({...o,rowMeta:{...o.rowMeta,id:f,position:"rounded",style:x,range:D,dayIndex:M}})}}w.sort((o,f)=>{var M,O;const y=(M=o.rowMeta.range)==null?void 0:M.fk_from_col,x=(O=f.rowMeta.range)==null?void 0:O.fk_from_col;return!y||!x?0:s.timezonize(o.row[y.title]).isBefore(s.timezonize(f.row[x.title]))?-1:1});for(const o of w){const f=(T=o.rowMeta.range)==null?void 0:T.fk_from_col,y=(r=o.rowMeta.range)==null?void 0:r.fk_to_col;if(!f)continue;const{startDate:x,endDate:M}=ie({startDate:s.timezonize(o.row[f.title]),endDate:y&&((I=Ve(o.row[y.title]))!=null&&I.isValid())?s.timezonize(o.row[y.title]):s.timezonize(o.row[f.title]).add(1,"hour").subtract(1,"minute"),scheduleStart:a,scheduleEnd:d}),O=Be(x,M),p=o.rowMeta.dayIndex??O.dayIndex;for(let E=O.from;E<=O.to;E++){l.has(p)||l.set(p,new Map),(v=l.get(p))!=null&&v.has(E)||l.set(p,(l.get(p)??new Map).set(E,{count:0,id:[],overflowRecords:[]}));const he=l.get(p).get(E).id;he.push(o.rowMeta.id);const N=l.get(p).get(E).count+1;l.set(p,(l.get(p)??new Map).set(E,{count:N,id:he,overflowRecords:l.get(p).get(E).overflowRecords}))}let $=!1;u[p]||(u[p]=[]);for(const E in u[p])if(dt(u[p][E],{fromDate:x,toDate:M})){u[p][E].push(o),$=!0;break}$||u[p].push([o])}const R=new Map;for(const o of l.keys()){R.has(o)||R.set(o,new Map);for(const[f,{id:y}]of l.get(o))for(const x of y){R.get(o).has(x)||R.get(o).set(x,new Set);for(const M of y)x!==M&&(R.get(o).get(x).has(M)||R.get(o).get(x).add(M))}}for(const o in u)for(const f in u[o])for(const y of u[o][f])y.rowMeta.overLapIteration=parseInt(f)+1;for(const o of w){const{maxOverlaps:f,overlapIndex:y,dayIndex:x}=ut({row:o,columnArray:u,graph:R.get(o.rowMeta.dayIndex)??new Map}),M=o.rowMeta.dayIndex??x;let O="block";P.value===5&&(M===5||M===6)&&(O="none"),o.rowMeta.numberOfOverlaps=f;let p=0,$=100;const E=M*e;if(o.rowMeta.id===((_=k.value)==null?void 0:_.rowMeta.id)||o.rowMeta.id===((c=H.value)==null?void 0:c.rowMeta.id))$=E+1.5,p=e-3;else if(o.rowMeta.overLapIteration>3){O="none";const N=(A=o.rowMeta.range)==null?void 0:A.fk_from_col,ue=(V=o.rowMeta.range)==null?void 0:V.fk_to_col;if(N){const{startDate:pt,endDate:gt}=ie({startDate:s.timezonize(o.row[N.title]),endDate:ue&&((z=Ve(o.row[ue.title]))!=null&&z.isValid())?s.timezonize(o.row[ue.title]):s.timezonize(o.row[N.title]).add(1,"hour").subtract(1,"minute"),scheduleStart:a,scheduleEnd:d}),Ye=Be(pt,gt);for(let ce=Ye.from;ce<=Ye.to;ce++)if(l.has(M)&&((C=l.get(M))!=null&&C.has(ce))){const Se=l.get(M).get(ce);Se.overflowRecords.some(_t=>_t.rowMeta.id===o.rowMeta.id)||(Se.overflowRecords.push(o),l.get(M).set(ce,Se))}}}else{const N=e-3;p=Math.max(N/Math.min(f,3),72);const ue=(N-p*Math.min(f,3))/Math.max(Math.min(f,3)-1,1);$=E+1.5+(y-1)*(p+ue),$+p>E+e&&(p=Math.max(E+e-$-1.5,72))}o.rowMeta.style={...o.rowMeta.style,left:`${$}px`,width:`${p}px`,minWidth:"72px",display:O}}}),{records:w,gridTimeMap:l,spanningRecords:h}}),ct=Lt((e,t,a)=>{be(e,t,a)},500),He=e=>{var C;if(!q("dataEdit")||!B.value||!H.value||!G.value||(C=H.value.rowMeta.range)!=null&&C.is_readonly)return;const{width:t,left:a,top:d,bottom:u}=B.value.getBoundingClientRect(),{scrollHeight:l,scrollTop:w}=B.value;e.clientY>u-20?B.value.scrollTop+=10:e.clientY<d+20&&(B.value.scrollTop-=10);const h=(e.clientX-a-window.scrollX)/t,D=(e.clientY-d+w)/l,{range:i}=H.value.rowMeta,m=i==null?void 0:i.fk_from_col,g=i==null?void 0:i.fk_to_col;if(!(m!=null&&m.title)||!(g!=null&&g.title))return;const R=s.timezonize(H.value.row[m.title]),T=s.timezonize(H.value.row[g.title]),r=Math.floor(h*P.value),I=Math.round(D*24*60/15)*15,v=s.timezonize(X.value.start).add(r,"day").add(I,"minute");let _,c,A=!0;if(ye.value==="right"){const o=R.add(1,"hour");_=v.isBefore(R)?R.add(Math.ceil(R.diff(v,"minute")/15)*15,"minute"):v,_.isBefore(o)&&(_=o),c=g.title}else if(ye.value==="left"){const o=T.subtract(1,"hour");_=v.isAfter(T)?T.subtract(Math.ceil(v.diff(T,"minute")/15)*15,"minute"):v,_.isAfter(o)&&(_=o),c=m.title}else A=!1,_=null;if(!A||!(_!=null&&_.isValid()))return;const V={...H.value,row:{...H.value.row,[c]:_.format(ge.value)}},z=ve(V.row,ae.value.columns);W.value=W.value.map(o=>ve(o.row,ae.value.columns)===z?V:o),ct(V,[c],!1)},$e=()=>{Re.value=!1,ye.value=null,H.value=null,document.removeEventListener("mousemove",He),document.removeEventListener("mouseup",$e)},mt=(e,t,a)=>{var d;q("dataEdit")&&((d=a.rowMeta.range)!=null&&d.is_readonly||(Re.value=!0,ye.value=e,H.value=a,document.addEventListener("mousemove",He),document.addEventListener("mouseup",$e)))},Ie=(e,t)=>{var A,V;if(!B.value)return{newRow:null,updatedProperty:[]};const{width:a,left:d,top:u}=B.value.getBoundingClientRect(),{scrollHeight:l,scrollTop:w}=B.value,h=(e.clientX-d-window.scrollX)/a,D=(e.clientY-u+w-36.8)/l,i=(A=k.value.rowMeta.range)==null?void 0:A.fk_from_col,m=(V=k.value.rowMeta.range)==null?void 0:V.fk_to_col;if(!i)return{newRow:null,updatedProperty:[]};const g=Math.max(0,Math.min(6,Math.floor(h*P.value))),R=Math.max(0,Math.min(23,Math.floor(D*24))),T=Math.round(D*24*60%60/15)*15,r=s.timezonize(X.value.start).add(g,"day").add(R,"hour").add(T,"minute");if(!r)return{newRow:null,updatedProperty:[]};let I;const v=[i.title],_={...k.value,row:{...k.value.row,[i.title]:s.dayjsTz(r).format(ge.value)}};if(m){const z=k.value.row[i.title]?s.timezonize(k.value.row[i.title]):null,C=k.value.row[m.title]?s.timezonize(k.value.row[m.title]):z==null?void 0:z.clone();if(z&&C){const o=Math.round(C.diff(z,"minute")/15)*15;I=r.add(o,"minute")}else z&&!C||!z&&C?I=s.dayjsTz(r).endOf("day"):I=r.clone();I.isBefore(r)&&(I=r.clone().add(15,"minutes")),_.row[m.title]=s.dayjsTz(I).format(ge.value),v.push(m.title)}if(!_)return{newRow:null,updatedProperty:[]};const c=ve(_.row,ae.value.columns);return t?(W.value=[...W.value,_],je.value=je.value.filter(z=>ve(z.row,ae.value.columns)!==c)):(W.value=W.value.map(z=>ve(z.row,ae.value.columns)===c?_:z),k.value={...k.value,row:_.row}),{newRow:_,updatedProperty:v}},Fe=e=>{if(!q("dataEdit")||!G.value||!k.value)return;const t=G.value.getBoundingClientRect(),a=20;e.clientY>t.bottom-a?G.value.scrollTop+=20:e.clientY<t.top+a&&(G.value.scrollTop-=20),Ie(e)},Ne=e=>{if(!q("dataEdit")||!de.value||!B.value||!k.value)return;e.preventDefault(),clearTimeout(De.value);const{newRow:t,updatedProperty:a}=Ie(e,!1);t&&be(t,a,!1),k.value=null,Pe("c:calendar:week:drag-record"),document.removeEventListener("mousemove",Fe),document.removeEventListener("mouseup",Ne)},ft=(e,t)=>{if(Re.value||ot.value)return;let a=e.target;de.value=!1,De.value=setTimeout(()=>{var u;if(q("dataEdit")&&!((u=t.rowMeta.range)!=null&&u.is_readonly)){for(de.value=!0;!a.classList.contains("draggable-record");)a=a.parentElement;de.value=!0,k.value=t,document.addEventListener("mousemove",Fe),document.addEventListener("mouseup",Ne)}},200);const d=()=>{clearTimeout(De.value),document.removeEventListener("mouseup",d),de.value||ze("expandRecord",t)};document.addEventListener("mouseup",d)},wt=e=>{var a,d;if(!q("dataEdit")||!B.value)return;e.preventDefault();const t=(a=e.dataTransfer)==null?void 0:a.getData("text/plain");if(t){const{record:u}=JSON.parse(t);if((d=u.rowMeta.range)!=null&&d.is_readonly)return;k.value=u;const{newRow:l,updatedProperty:w}=Ie(e,!0);l&&(be(l,w,!1),Pe("c:calendar:day:drag-record"))}},vt=e=>{et.value="selectedHours",pe.value=e,tt.value=!0},Ce=e=>{var D,i,m;if(!F.value||!F.value.gridTimeMap)return{isOverflow:!1,overflowCount:0,overflowRecords:[]};const{gridTimeMap:t}=F.value,a=re(e),d=e.hour()*60+e.minute(),u=e.hour()*60+e.minute()+59,l=t.get(a),w=[],h=new Set;for(let g=d;g<=u;g++){const R=((D=l==null?void 0:l.get(g))==null?void 0:D.overflowRecords)??[];for(const T of R)h.has((i=T.rowMeta)==null?void 0:i.id)||(w.push(T),h.add((m=T.rowMeta)==null?void 0:m.id))}return{isOverflow:w==null?void 0:w.length,overflowCount:w==null?void 0:w.length,overflowRecords:w}},Ue=e=>{if(!q("dataEdit")||!oe.value||nt.value)return;const t=oe.value[0].fk_from_col;if(!t)return;const a={row:{[t.title]:e.format(ge.value)}};ze("newRecord",a)};We(()=>F.value,()=>{var t,a;if(k.value)return;const e=document.querySelectorAll(".draggable-record");e.length?(t=e.item(0))==null||t.scrollIntoView({behavior:"smooth",block:"center"}):(a=document.querySelectorAll(".nc-calendar-day-hour").item(9))==null||a.scrollIntoView({behavior:"smooth",block:"center"})},{immediate:!0});const Xe=e=>{ze("expandRecord",e)},Ee=L(null),J=L(!1),K=te(()=>oe.value.some(e=>e.fk_to_col!==null&&e.fk_to_col!==void 0));return We(()=>{var e;return(e=Ee.value)==null?void 0:e.isSpanningRecordExpanded()},()=>{var e;J.value=(e=Ee.value)==null?void 0:e.isSpanningRecordExpanded()}),(e,t)=>{var m,g,R,T;const a=Pt,d=Ot,u=$t,l=Ft,w=Vt,h=Nt,D=Ut,i=Et("e");return b(),S("div",{ref_key:"scrollContainer",ref:G,class:"prevent-select h-[calc(100vh-5.4rem)] overflow-y-auto nc-scrollbar-md relative flex flex-col w-full","data-testid":"nc-calendar-week-view",onDrop:wt},[!n(at)&&n(s).dayjsTz().isBetween(n(X).start,n(X).end)?(b(),S("div",{key:0,class:Q(["absolute top-16 ml-16 pointer-events-none z-4",{"!mt-38.5":n(J)&&n(K),"mt-27":!n(J)&&n(K),"!mt-6":!((m=n(F).spanningRecords)!=null&&m.length)}]),style:qe(n(lt))},[U("div",Xt,[U("span",{class:"text-nc-content-inverted-primary bg-nc-content-brand rounded-md leading-3.5 font-bold text-xs pointer-events-auto p-0.5 cursor-pointer",onClick:t[0]||(t[0]=r=>Ue(n(s).dayjsTz()))},fe(n(se).format("hh:mm A")),1),t[3]||(t[3]=U("div",{class:"flex-1 relative ml-1 nc-calendar-border-line border-b-2 border-brand-500"},null,-1))])],6)):me("",!0),U("div",Yt,[(b(!0),S(Y,null,Z(n(le),r=>(b(),S("div",{key:r[0].toISOString(),class:Q([{"text-brand-500":r[0].isSame(n(s).dayjsTz(),"date"),"w-1/5":n(P)===5,"w-1/7":n(P)===7},"text-center text-[10px] font-semibold leading-4 flex items-center justify-center uppercase text-gray-500 w-full py-1 border-gray-200 last:border-r-0 border-b-1 border-l-1 border-r-0 bg-gray-50"])},fe(n(s).dayjsTz(r[0]).format("DD ddd")),3))),128))]),U("div",{class:Q([{"top-20.5":!n(J)&&n(K),"top-32":n(J)&&n(K),"!top-0":!((g=n(F).spanningRecords)!=null&&g.length)},"absolute bg-white w-16 z-1"])},[(b(!0),S(Y,null,Z(n(le)[0],(r,I)=>(b(),S("div",{key:I,class:"h-13 first:mt-0 pt-7.1 nc-calendar-day-hour text-right pr-2 font-semibold text-xs text-gray-500 py-1"},fe(r.format("hh a")),1))),128))],2),n(K)&&((R=n(F).spanningRecords)!=null&&R.length)?(b(),S("div",Wt,[Le(a,{ref_key:"spanningRecordsContainer",ref:Ee,records:n(F).spanningRecords,onExpandRecord:Xe},null,8,["records"])])):me("",!0),U("div",{ref_key:"container",ref:B,class:Q([{"mt-20.5 ":!n(J)&&n(K),"mt-32":n(J)&&n(K),"!mt-0":!((T=n(F).spanningRecords)!=null&&T.length)},"absolute ml-16 flex w-[calc(100%-64px)]"])},[(b(!0),S(Y,null,Z(n(le),(r,I)=>(b(),S("div",{key:I,class:Q([{"w-1/5":n(P)===5,"w-1/7":n(P)===7},"h-full mt-5.95"]),"data-testid":"nc-calendar-week-day"},[(b(!0),S(Y,null,Z(r,(v,_)=>(b(),S("div",{key:_,class:Q([{"border-1 !border-brand-500 !bg-gray-100":v.isSame(n(pe),"hour")&&(v.get("day")===6||v.get("day")===0),"selected-hour":v.isSame(n(pe),"hour"),"bg-gray-50 hover:bg-gray-100":v.get("day")===0||v.get("day")===6,"hover:bg-gray-50":v.get("day")!==0&&v.get("day")!==6},"text-center relative transition h-13 text-sm text-gray-500 w-full py-1 border-transparent border-1 border-x-gray-100 border-t-gray-100 border-l-gray-200"]),"data-testid":"nc-calendar-week-hour",onDblclick:c=>Ue(v),onClick:()=>{Qe.value=v,pe.value=v,k.value=null}},[Ce(v).isOverflow?(b(),we(w,{key:0,trigger:["click"]},{overlay:ee(()=>[U("div",Jt,[(b(!0),S(Y,null,Z(Ce(v).overflowRecords,c=>{var A,V,z,C;return b(),we(l,{key:(A=c==null?void 0:c.rowMeta)==null?void 0:A.id,draggable:!1,class:"w-64","from-date":n(s).timezonize(c.row[c.rowMeta.range.fk_from_col.title]).format("D MMM • h:mm A"),invalid:!1,row:c,"to-date":(C=(z=(V=c==null?void 0:c.rowMeta)==null?void 0:V.range)==null?void 0:z.fk_to_col)!=null&&C.title&&c.row[c.rowMeta.range.fk_to_col.title]?n(s).timezonize(c.row[c.rowMeta.range.fk_to_col.title]).format("DD MMM • HH:mm A"):null,"data-testid":"nc-sidebar-record-card",onClick:o=>Xe(c)},{default:ee(()=>[("isRowEmpty"in e?e.isRowEmpty:n(Je))(c,n(ne))?(b(),S("span",Kt," - ")):(b(),we(u,{key:0,modelValue:c.row[n(ne).title],"onUpdate:modelValue":o=>c.row[n(ne).title]=o,column:n(ne)},null,8,["modelValue","onUpdate:modelValue","column"]))]),_:2},1032,["from-date","row","to-date","onClick"])}),128))])]),default:ee(()=>[St((b(),we(d,{class:"!absolute bottom-1 text-center w-15 ml-auto inset-x-0 z-3 text-gray-500",size:"xxsmall",type:"secondary",onClick:c=>vt(v)},{default:ee(()=>[U("span",Gt," + "+fe(Ce(v).overflowCount)+" more ",1)]),_:2},1032,["onClick"])),[[i,"['c:calendar:week-view-more']"]])]),_:2},1024)):me("",!0)],42,qt))),128))],2))),128)),U("div",Qt,[(b(!0),S(Y,null,Z(n(F).records,r=>{var I,v,_;return b(),S(Y,{key:r.rowMeta.id},[((I=r.rowMeta.style)==null?void 0:I.display)!=="none"?(b(),S("div",{key:0,"data-testid":`nc-calendar-week-record-${r.row[n(ne).title]}`,"data-unique-id":r.rowMeta.id,style:qe({...r.rowMeta.style,lineHeight:"18px",opacity:(n(k)===null||r.rowMeta.id===((v=n(k))==null?void 0:v.rowMeta.id))&&(n(H)===null||r.rowMeta.id===((_=n(H))==null?void 0:_.rowMeta.id))?1:.3}),class:Q([{"w-1/5":n(P)===5,"w-1/7":n(P)===7},"absolute transition draggable-record group cursor-pointer pointer-events-auto"]),onMousedown:Ge(c=>ft(c,r),["stop"]),onMouseleave:t[1]||(t[1]=c=>Te.value=null),onMouseover:c=>Te.value=r.rowMeta.id,onDragover:t[2]||(t[2]=Ge(()=>{},["prevent"]))},[Le(D,{row:r},{default:ee(()=>{var c,A,V,z,C,o;return[Le(h,{hover:n(Te)===r.rowMeta.id,position:r.rowMeta.position,dragging:r.rowMeta.id===((A=(c=n(k))==null?void 0:c.rowMeta)==null?void 0:A.id)||((V=n(H))==null?void 0:V.rowMeta.id)===r.rowMeta.id,resize:!!((z=r.rowMeta.range)!=null&&z.fk_to_col)&&n(q)("dataEdit"),record:r,selected:r.rowMeta.id===((o=(C=n(k))==null?void 0:C.rowMeta)==null?void 0:o.id),onResizeStart:mt},{time:ee(()=>{var f;return[U("div",eo,fe(n(s).timezonize(r.row[(f=r.rowMeta.range)==null?void 0:f.fk_from_col.title]).format("h:mm a")),1)]}),default:ee(()=>[(b(!0),S(Y,null,Z(n(rt),(f,y)=>{var x,M,O;return b(),S(Y,{key:y},[("isRowEmpty"in e?e.isRowEmpty:n(Je))(r,f)?me("",!0):(b(),we(u,{key:0,modelValue:r.row[f.title],"onUpdate:modelValue":p=>r.row[f.title]=p,class:"text-xs",column:f,bold:!!((x=n(ke)[f.id])!=null&&x.bold),italic:!!((M=n(ke)[f.id])!=null&&M.italic),underline:!!((O=n(ke)[f.id])!=null&&O.underline)},null,8,["modelValue","onUpdate:modelValue","column","bold","italic","underline"]))],64)}),128))]),_:2},1032,["hover","position","dragging","resize","record","selected"])]}),_:2},1032,["row"])],46,Zt)):me("",!0)],64)}),128))])],2)],544)}}}),mo=Object.assign(jt(to,[["__scopeId","data-v-81cb0260"]]),{__name:"SmartsheetCalendarWeekViewDateTimeField"});export{mo as default};
