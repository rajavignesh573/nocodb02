import{e as C,a6 as M,a9 as N,J as q,r as V,Y as k,c as v,o as f,b as s,a as t,w as o,t as g,M as B,by as F,K as I,L as r,d as b,a0 as j,cU as E,N as G,I as S,b9 as T,bo as A,X as D,a4 as L,_ as O}from"./DRA9KN5F.js";import{_ as z}from"./C6valJX6.js";import{_ as H}from"./Bv0AHyYV.js";const J={class:"flex flex-col"},K={"data-rec":"true"},W={class:"nc-content-max-w p-6 h-[calc(100vh_-_100px)] flex flex-col gap-6 overflow-auto nc-scrollbar-thin"},X={class:"flex flex-col gap-6 w-150 mx-auto"},Y={class:"mt-5 flex flex-col border-1 rounded-2xl border-gray-200 p-6 gap-y-2"},Q={class:"relative flex flex-col justify-start gap-2 w-full"},Z={key:0,class:"mx-auto mb-4 bg-red-500 text-white rounded-lg w-3/4 p-1"},ee={"data-testid":"nc-user-settings-form__error",class:"flex items-center gap-2 justify-center","data-rec":"true"},se={class:"text-right mt-5"},ae={class:"flex justify-center items-center gap-2","data-rec":"true"},re=C({__name:"ResetPassword",setup(te){const{api:x,error:d}=M({useGlobalInstance:!0}),{t:n}=N(),{signOut:R}=q(),h=V(),a=k({currentPassword:"",password:"",passwordRepeat:""}),p={currentPassword:[{required:!0,message:n("msg.error.signUpRules.passwdRequired")}],password:[{required:!0,message:n("msg.error.signUpRules.passwdRequired")},{min:8,message:n("msg.error.signUpRules.passwdLength")}],passwordRepeat:[{required:!0,message:n("msg.error.signUpRules.passwdRequired")},{validator:(e,l)=>new Promise((i,_)=>{if(a.password===a.passwordRepeat)return i(!0);_(new Error(n("msg.error.signUpRules.passwdMismatch")))}),message:n("msg.error.signUpRules.passwdMismatch")}]},y=async()=>{try{if(!h.value.validate())return;d.value=null,await x.auth.passwordChange({currentPassword:a.currentPassword,newPassword:a.password}),L.success(n("msg.success.passwordChanged")),await R({redirectToSignin:!0})}catch{}},u=()=>{d.value&&(d.value=null)};return(e,l)=>{const i=B,_=z,P=H,m=E,w=j,U=G,$=D;return f(),v("div",J,[s(_,null,{icon:o(()=>[s(i,{icon:"passwordChange",class:"flex-none text-[20px] h-5 w-5"})]),title:o(()=>[t("span",K,g(e.$t("activity.changePwd")),1)]),_:1}),t("div",W,[t("div",X,[t("div",Y,[t("div",Q,[s($,{ref_key:"formValidator",ref:h,"data-testid":"nc-user-settings-form",layout:"vertical",class:"change-password","no-style":"",model:r(a),onFinish:y},{default:o(()=>[s(F,{name:"layout"},{default:o(()=>[r(d)?(f(),v("div",Z,[t("div",ee,[s(P),b(" "+g(r(d)),1)])])):I("",!0)]),_:1}),s(w,{label:e.$t("placeholder.password.current"),"data-rec":"true",name:"currentPassword",rules:p.currentPassword},{default:o(()=>[s(m,{value:r(a).currentPassword,"onUpdate:value":l[0]||(l[0]=c=>r(a).currentPassword=c),"data-testid":"nc-user-settings-form__current-password",class:"password",placeholder:e.$t("placeholder.password.current"),onFocus:u},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),s(w,{label:e.$t("placeholder.password.new"),"data-rec":"true",name:"password",rules:p.password},{default:o(()=>[s(m,{value:r(a).password,"onUpdate:value":l[1]||(l[1]=c=>r(a).password=c),"data-testid":"nc-user-settings-form__new-password",class:"password",placeholder:e.$t("placeholder.password.new"),onFocus:u},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),s(w,{label:e.$t("placeholder.password.confirm"),"data-rec":"true",name:"passwordRepeat",rules:p.passwordRepeat},{default:o(()=>[s(m,{value:r(a).passwordRepeat,"onUpdate:value":l[2]||(l[2]=c=>r(a).passwordRepeat=c),"data-testid":"nc-user-settings-form__new-password-repeat",class:"password",placeholder:e.$t("placeholder.password.confirm"),onFocus:u},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),t("div",se,[s(U,{size:"small","data-testid":"nc-user-settings-form__submit","html-type":"submit"},{default:o(()=>[t("div",ae,[(f(),S(T(("iconMap"in e?e.iconMap:r(A)).passwordChange))),b(" "+g(e.$t("activity.changePwd")),1)])]),_:1})])]),_:1},8,["model"])])])])])])}}}),de=Object.assign(O(re,[["__scopeId","data-v-0d8335a2"]]),{__name:"AccountResetPassword"});export{de as default};
