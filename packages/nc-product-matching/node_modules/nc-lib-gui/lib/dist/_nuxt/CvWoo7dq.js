import{e as N,r as _,n as f,b1 as S,g as V,I as j,o as B,w as b,a as U,b as d,bB as h,L as a,N as C,d as D}from"./DRA9KN5F.js";import{_ as E}from"./7l56urZf.js";import{b as P}from"./C2lfXqUV.js";import"./C_uh0dMc.js";import"./mXY_vhPu.js";import"./C_gbauhL.js";import"./U3gU45AW.js";import"./629XNRmr.js";import"./B8gs0dG7.js";import"./DlXIlcns.js";import"./DP83Cqnl.js";import"./qgFKasiG.js";import"./CQa0sIfA.js";import"./DkDj6Z7Z.js";import"./D7poRkS0.js";import"./Bw607vNV.js";import"./B94p8ToD.js";import"./gAYHr7Gr.js";import"./Cd4chHHL.js";import"./boyBAVNN.js";import"./yMSt-9W5.js";import"./BYKJ-MHf.js";import"./By5RWL3d.js";import"./C2xdh4Xe.js";import"./CI3EriLB.js";import"./C2UaKEE0.js";import"./C_VN1MCC.js";import"./owbQkEXm.js";import"./CVZBrAgI.js";import"./LhVKWcKT.js";import"./QeWwuUYP.js";import"./B89wxTuy.js";import"./DjPyxH1k.js";import"./DCa6wpIA.js";import"./B1qoNiTF.js";import"./CbX26EBz.js";import"./CYKJe2Bk.js";import"./DkpDpjnr.js";import"./Dv0nYk-Y.js";import"./CHRPOXXy.js";import"./gByPF8bR.js";import"./BCBMEREK.js";import"./DGFEr0h-.js";import"./DfIS_byq.js";import"./YbUkeyWR.js";import"./lL-0_K96.js";import"./CIOK9Y4w.js";import"./CNwEZGnv.js";import"./BVqTF1QK.js";import"./Ce4xoeky.js";import"./C3FZdmXk.js";import"./DDmv9w84.js";import"./DWLi1ZcL.js";import"./BALLsGq5.js";import"./DCm6TF8M.js";import"./Bj4kMpzI.js";import"./CbSESqy_.js";import"./Bxzk9hCO.js";import"./Bm6QmuXP.js";import"./CkpISeXq.js";import"./zMMvJhqz.js";import"./ytmFgNfN.js";import"./DxC2Oool.js";import"./CC4cUItJ.js";import"./EcM5l_HA.js";import"./BLPDl4Qg.js";import"./CsX17Y_h.js";import"./BmscXXs6.js";import"./CG-5KGUk.js";import"./CkvAmLZt.js";import"./D7OHpRdS.js";import"./DvtLu3FC.js";import"./D_txg4HT.js";import"./JqUqXTOd.js";import"./I4o4wRE2.js";import"./BMPzbwPk.js";import"./CwPFbl3n.js";import"./C5HnjaiI.js";import"./CBhmoxRW.js";import"./Bc3_tI4-.js";import"./CJAyvGKH.js";import"./D43249YX.js";import"./BBg0y0zb.js";import"./-iDxnmJF.js";import"./C1XMFoVa.js";import"./C-ZUx0lq.js";import"./YYodiGXA.js";import"./C316Za7m.js";import"./CKrOnbU4.js";import"./Cbo3SB6Q.js";import"./BUnSBgDC.js";import"./D6_NfMsA.js";import"./2d03FuDZ.js";import"./DJYXGfCo.js";import"./BYP-poBO.js";import"./DMyfaxtt.js";import"./PTtV_v_G.js";import"./D8vl_16c.js";import"./CBehK9r0.js";import"./15xfm8CF.js";import"./BMufqs0w.js";import"./BcrYf4lp.js";import"./CSKT8BGh.js";const R={class:"flex flex-col gap-2 p-3"},Eo=N({__name:"index",setup(T){const{extension:n,tables:c,getViewsForTable:w,getData:x}=P(),m=_([]),t=_({}),I=f(()=>c.value.map(o=>({label:o.title,value:o.id}))),y=f(()=>t.value.tableId?m.value.filter(o=>o.type===S.GRID).map(o=>({label:o.is_default?"Default":o.title,value:o.id}))||[]:[]),v=async()=>{t.value.tableId&&(m.value=await w(t.value.tableId))},g=async o=>{var e;t.value.tableId=o,await v(),t.value.viewId=(e=m.value.find(i=>i.is_default))==null?void 0:e.id,await n.value.kvStore.set("exportPayload",t.value)},k=async o=>{t.value.viewId=o,await n.value.kvStore.set("exportPayload",t.value)},L=async()=>{if(!t.value.tableId||!t.value.viewId)return;const o=[];x({tableId:t.value.tableId,viewId:t.value.viewId,eachPage:(e,i)=>{o.push(...e),i()},done:()=>{const e=JSON.stringify(o,null,2),i=new Blob([e],{type:"application/json"}),l=URL.createObjectURL(i),r=document.createElement("a"),p=c.value.find(u=>u.id===t.value.tableId),s=m.value.find(u=>u.id===t.value.viewId);p&&s?r.download=`${p.title} - ${s.is_default?"Default":s.title}.json`:r.download="data.json",r.href=l,r.click(),URL.revokeObjectURL(l)}})};return V(()=>{t.value=n.value.kvStore.get("exportPayload")||{},v()}),(o,e)=>{const i=h,l=C,r=E;return B(),j(r,null,{default:b(()=>[U("div",R,[d(i,{value:a(t).tableId,"onUpdate:value":e[0]||(e[0]=p=>a(t).tableId=p),options:a(I),placeholder:"-select table-",onChange:g},null,8,["value","options"]),d(i,{value:a(t).viewId,"onUpdate:value":e[1]||(e[1]=p=>a(t).viewId=p),options:a(y),placeholder:"-select view-",onChange:k},null,8,["value","options"]),d(l,{onClick:L},{default:b(()=>e[2]||(e[2]=[D("Export")])),_:1,__:[2]})])]),_:1})}}});export{Eo as default};
