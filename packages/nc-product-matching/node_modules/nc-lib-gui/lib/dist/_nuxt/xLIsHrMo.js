import{e as $,R as q,av as D,G as z,r as S,mE as J,S as K,n as O,aC as d,jg as I,aj as _,aD as W,fP as w,j as X,fW as Z,fX as ee,fV as te,jt as ae,jr as le,I as x,o as y,w as m,c as se,an as oe,aq as ne,L as b,eJ as ie,b as A,ap as re,a as E,K as ue,b9 as F,ag as de,d as V,t as N,bo as me,Q as ce,bB as pe}from"./DRA9KN5F.js";import{u as fe}from"./D7poRkS0.js";import"./DkDj6Z7Z.js";const ve={class:"flex items-center w-full justify-between gap-2"},_e={class:"flex gap-1.5 flex-1 items-center truncate h-full"},we=$({__name:"FieldListAutoCompleteDropdown",props:{modelValue:{},isSort:{type:Boolean},columns:{},allowEmpty:{type:Boolean},meta:{},disableSmartsheet:{type:Boolean}},emits:["update:modelValue"],setup(c,{emit:j}){var k,M;const B=q(c,["modelValue","isSort","allowEmpty","disableSmartsheet"]),R=j,P=D(B,"columns"),p=D(B,"meta"),G=z(J,S({})),{metas:Y}=K(),i=O({get:()=>c.modelValue,set:a=>R("update:modelValue",a)}),{showSystemFields:C,fieldsMap:n,isLocalMode:L}=c.disableSmartsheet?{showSystemFields:S(!1),fieldsMap:S({}),isLocalMode:S(!1)}:fe(),T=O(()=>{var a,s,l,o,r;return(r=(o=((a=P.value)==null?void 0:a.filter(e=>{var t;return!(L.value&&(e!=null&&e.id)&&n.value[e.id]&&(!((t=n.value[e.id])!=null&&t.initialShow)||!C.value&&d(e))||d(e)&&I(e,p.value))}))||((l=(s=p.value)==null?void 0:s.columns)==null?void 0:l.filter(e=>{var t;return L.value&&(e!=null&&e.id)&&n.value[e.id]&&(!((t=n.value[e.id])!=null&&t.initialShow)||!C.value&&d(e))?!1:e.uidt===_.Links?!0:d(e)?I(e,p.value)?!1:i.value===e.id||C.value:e.uidt===_.QrCode||e.uidt===_.Barcode||e.uidt===_.ID||e.uidt===_.Button?!1:c.isSort?!(W(e)&&e.colOptions.type!==w.BELONGS_TO):!(e.colOptions&&e.system)})))==null?void 0:o.sort((e,t)=>{var v,g;let u=0,f=0,h=0;return d(e)&&(u=1),d(t)&&(f=1),e!=null&&e.id&&(t!=null&&t.id)&&((v=n.value[e.id])==null?void 0:v.order)!==void 0&&((g=n.value[t.id])==null?void 0:g.order)!==void 0&&(h=n.value[e.id].order-n.value[t.id].order),u-f||h}))==null?void 0:r.map(e=>({value:e.id,label:G.value[e.id]||e.title,icon:X(te(e)?Z:ee,{columnMeta:e}),ncItemDisabled:e.ncItemDisabled,ncItemTooltip:e.ncItemTooltip,c:e}))}),H=(a,s)=>{var l;return(l=s.label.toLowerCase())==null?void 0:l.includes(a.toLowerCase())};!i.value&&c.allowEmpty!==!0&&(i.value=((M=(k=T.value)==null?void 0:k[0])==null?void 0:M.value)||"");const Q={[w.BELONGS_TO]:"text-blue-500",[w.ONE_TO_ONE]:"text-purple-500",[w.HAS_MANY]:"text-orange-500",[w.MANY_TO_MANY]:"text-pink-500"},U=O(()=>{var a,s;return((s=(a=p.value)==null?void 0:a.columns)==null?void 0:s.reduce((l,o)=>{var r,e,t,u;if(o&&ae(o)||le(o)){const f=(t=(e=(r=Y.value)==null?void 0:r[p.value.id])==null?void 0:e.columns)==null?void 0:t.find(h=>{var v;return h.id===((v=o.colOptions)==null?void 0:v.fk_relation_column_id)});f&&(l[o.id]=Q[(u=f.colOptions)==null?void 0:u.type])}return l},{}))||{}});return(a,s)=>{const l=re,o=ie,r=pe;return y(),x(r,{value:b(i),"onUpdate:value":s[0]||(s[0]=e=>ce(i)?i.value=e:null),"dropdown-match-select-width":!1,"show-search":"",placeholder:a.$t("placeholder.selectField"),"filter-option":H,"dropdown-class-name":"nc-dropdown-toolbar-field-list"},{default:m(()=>[(y(!0),se(oe,null,ne(b(T),e=>(y(),x(o,{key:e.value,label:e.label,value:e.value,disabled:e.ncItemDisabled},{default:m(()=>[A(l,{disabled:!e.ncItemDisabled,placement:"right",class:"w-full max-w-50"},{title:m(()=>[V(N(e.ncItemTooltip),1)]),default:m(()=>[E("div",ve,[E("div",_e,[(y(),x(F(e.icon),{class:de(["!w-3.5 !h-3.5 !mx-0",b(U)[e.value]||"!text-gray-500"])},null,8,["class"])),A(l,{style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"},class:"field-selection-tooltip-wrapper truncate select-none","show-on-truncate-only":""},{title:m(()=>[V(N(e.label),1)]),default:m(()=>[V(" "+N(e.label),1)]),_:2},1024)]),b(i)===e.value?(y(),x(F(("iconMap"in a?a.iconMap:b(me)).check),{key:0,id:"nc-selected-item-icon",class:"text-primary w-4 h-4"})):ue("",!0)])]),_:2},1032,["disabled"])]),_:2},1032,["label","value","disabled"]))),128))]),_:1},8,["value","placeholder"])}}}),Se=Object.assign(we,{__name:"SmartsheetToolbarFieldListAutoCompleteDropdown"});export{Se as default};
